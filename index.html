<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!-- This file was created with the aha Ansi HTML Adapter. http://ziz.delphigl.com/tool_aha.php -->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="application/xml+xhtml; charset=UTF-8" />
<title>stdin</title>
</head>
<body>
<pre>
<span style="color:olive;">a65d827</span> e1 type modified, working version
<span style="color:olive;">a359637</span> Add Let Rec to impAST.ml
<span style="color:olive;">66fef35</span> Add Let Rec to types.ml
<span style="color:olive;">2a43b64</span> Add Let Rec to semantics.ml
<span style="color:olive;">8d6427f</span> Add Let Rec to parser.mly
<span style="color:olive;">57c56a2</span> Add REC to lexer.mll
<span style="color:olive;">714e476</span> Add newline
<span style="color:olive;">d2f4543</span> Update .gitignore
<span style="color:olive;">6c22012</span> Add .gitignore file
<span style="color:olive;">ec389d7</span> Remove Garbage
<span style="color:olive;">e72794d</span> Working Let - Fix lexer.mll
<span style="color:olive;">d191e39</span> Fix Let in impAST.ml
<span style="color:olive;">61c1337</span> Add Let to types.ml-update_or_add x
<span style="color:olive;">889351f</span> Add test file for Let Rec
<span style="color:olive;">7192ae2</span> Add Let in impAST.ml
<span style="color:olive;">5b48c7b</span> Add let to semantics.ml
<span style="color:olive;">bb754ef</span> Add let to types.ml
<span style="color:olive;">50f7bd6</span> Add let to parser.mly
<span style="color:olive;">d776780</span> Add let to lexer.mll
<span style="color:olive;">9fd803f</span> Add Let in lexer.mll
<span style="color:olive;">6221947</span> Adauaga Evaluare Non-Stricta
<span style="color:olive;">ae5002f</span> Primul commit
</pre>
</body>
</html>
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!-- This file was created with the aha Ansi HTML Adapter. http://ziz.delphigl.com/tool_aha.php -->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="application/xml+xhtml; charset=UTF-8" />
<title>stdin</title>
</head>
<body>
<pre>
<span style="color:olive;">commit a65d827e3487f70aeb68912156224695ccaaad57</span>
Author: Dragos Calin &lt;calinho_gx1992@yahoo.com&gt;
Date:   Thu Jan 8 14:02:16 2015 +0200

    e1 type modified, working version

<span style="font-weight:bold;">diff --git a/semantics.ml b/semantics.ml</span>
<span style="font-weight:bold;">index 1698b9b..baea204 100644</span>
<span style="font-weight:bold;">--- a/semantics.ml</span>
<span style="font-weight:bold;">+++ b/semantics.ml</span>
<span style="color:teal;">@@ -78,7 +78,7 @@</span> let rec reduce = function
     -&gt; (match reduce (e1,s) with Some (e1',s') -&gt; Some (Let(x,tip,e1',e2,loc),s')
      | None -&gt; None)
  | (LetRec(x,tip,e1,e2,loc),s)
     -&gt; Some( subst x <span style="color:red;">(LetRec (x,tip,e1,e1,loc))</span><span style="color:green;">(LetRec(x,tip,e1,e1,loc))</span> e2, s)

(*  Normal Order
  | (App (Fun(x,_,e1,_),e2,_),s) -&gt; Some (subst x e2 e1, s)
<span style="font-weight:bold;">diff --git a/types.ml b/types.ml</span>
<span style="font-weight:bold;">index b7d4456..7fc2b83 100644</span>
<span style="font-weight:bold;">--- a/types.ml</span>
<span style="font-weight:bold;">+++ b/types.ml</span>
<span style="color:teal;">@@ -77,7 +77,7 @@</span> let rec infertype m = function
     | (t1, t2) when t1 = tip -&gt; t2
     | (t1, t2) -&gt; raise (TypeError (e1, tip, t1))) 
  | LetRec(x,tip,e1,e2,_)
    -&gt; (match (infertype <span style="color:red;">m</span><span style="color:green;">(update_or_add (x,Type tip) m)</span> e1, infertype (update_or_add (x,Type tip) m) e2) with
     | (t1, t2) when t1 = tip -&gt; t2
     | (t1, t2) -&gt; raise (TypeError (e1, tip, t1)))  


<span style="color:olive;">commit a359637570ae95b2ec3c9ce3d1757251e524c1c0</span>
Author: Dragos Calin &lt;calinho_gx1992@yahoo.com&gt;
Date:   Tue Dec 23 01:28:28 2014 +0200

    Add Let Rec to impAST.ml

<span style="font-weight:bold;">diff --git a/impAST.ml b/impAST.ml</span>
<span style="font-weight:bold;">index b4e0345..67bc6a8 100644</span>
<span style="font-weight:bold;">--- a/impAST.ml</span>
<span style="font-weight:bold;">+++ b/impAST.ml</span>
<span style="color:teal;">@@ -44,6 +44,7 @@</span> type expr =
  | For of expr * expr * expr * expr * locatie | Skip of locatie
  | Fun of string * tip * expr * locatie
  | Let of string * tip * expr * expr * locatie
  <span style="color:green;">| LetRec of string * tip * expr * expr * locatie</span>
  | DeBruijnFun of expr * locatie
  | App of expr * expr * locatie

<span style="color:teal;">@@ -53,7 +54,7 @@</span> let exps = function
   -&gt; []
 | Atrib(_,e,_) | Fun(_,_,e,_) | DeBruijnFun (e,_) 
   -&gt; [e]
 | Op(e1,_,e2,_) | Secv(e1,e2,_) | While(e1,e2,_) | App(e1,e2,_) | Let(_,_,e1,e2,_) <span style="color:green;">| LetRec(_,_,e1,e2,_)</span>
   -&gt; [e1;e2]
 | If(e1,e2,e3,_)
   -&gt; [e1;e2;e3]
<span style="color:teal;">@@ -64,6 +65,7 @@</span> let revExps = function
   | (e,[]) -&gt; e
   | (Atrib(l,_,loc),[e]) -&gt; Atrib(l,e,loc)
   | (Let(x,t,_,_,loc),[e1;e2]) -&gt; Let(x,t,e1,e2,loc)
   <span style="color:green;">| (LetRec(x,t,_,_,loc),[e1;e2]) -&gt; LetRec(x,t,e1,e2,loc)</span>
   | (Fun(x,t,_,loc),[e]) -&gt; Fun(x,t,e,loc) 
   | (DeBruijnFun(_,loc),[e]) -&gt; DeBruijnFun(e,loc) 
   | (Op(_,op,_,loc),[e1;e2]) -&gt; Op(e1,op,e2,loc) 
<span style="color:teal;">@@ -187,6 +189,8 @@</span> let string_of_expr e =
  | (Skip _, _) -&gt; &quot;()&quot;
  | (Let (x,t,_,_,_),[s1;s2]) -&gt;
    &quot;(let &quot; ^ x ^ &quot; : &quot; ^ string_of_tip t ^ &quot; = &quot; ^ s1 ^ &quot; in\n&quot; ^ s2 ^ &quot;\n)&quot;
  <span style="color:green;">| (LetRec(x,t,_,_,_),[s1;s2]) -&gt;</span>
<span style="color:green;">    &quot;(let rec &quot; ^ x ^ &quot;:&quot; ^ string_of_tip t ^ &quot; = &quot; ^ s1 ^ &quot; in\n&quot; ^ s2 ^ &quot;\n)&quot;</span>
  | (Fun (x,t,_,_),[s]) -&gt; 
    &quot;(fun (&quot; ^ x ^ &quot;:&quot; ^ string_of_tip t ^ &quot;) -&gt; &quot; ^ s ^ &quot;)&quot;
  | (DeBruijnFun (_,_),[s]) -&gt; 
<span style="color:teal;">@@ -214,6 +218,7 @@</span> let location = function
  | Secv (_,_,l)
  | Skip l 
  | Let (_,_,_,_,l)
  <span style="color:green;">| LetRec (_,_,_,_,l)</span>
  | App (_,_,l)
  | Fun (_,_,_,l)
  | DeBruijnFun (_,l)

<span style="color:olive;">commit 66fef35f8580394e788d5fd89e14dc6b0c287f47</span>
Author: Dragos Calin &lt;calinho_gx1992@yahoo.com&gt;
Date:   Tue Dec 23 01:03:13 2014 +0200

    Add Let Rec to types.ml

<span style="font-weight:bold;">diff --git a/types.ml b/types.ml</span>
<span style="font-weight:bold;">index 7b3c3cc..b7d4456 100644</span>
<span style="font-weight:bold;">--- a/types.ml</span>
<span style="font-weight:bold;">+++ b/types.ml</span>
<span style="color:teal;">@@ -76,6 +76,10 @@</span> let rec infertype m = function
    -&gt; (match (infertype m e1, infertype (update_or_add (x,Type tip) m) e2) with
     | (t1, t2) when t1 = tip -&gt; t2
     | (t1, t2) -&gt; raise (TypeError (e1, tip, t1))) 
  <span style="color:green;">| LetRec(x,tip,e1,e2,_)</span>
<span style="color:green;">    -&gt; (match (infertype m e1, infertype (update_or_add (x,Type tip) m) e2) with</span>
<span style="color:green;">     | (t1, t2) when t1 = tip -&gt; t2</span>
<span style="color:green;">     | (t1, t2) -&gt; raise (TypeError (e1, tip, t1)))</span>  


let type_check m e = try

<span style="color:olive;">commit 2a43b6494fb8e88b9fff81fd232ffb5b0fee27f0</span>
Author: Dragos Calin &lt;calinho_gx1992@yahoo.com&gt;
Date:   Tue Dec 23 00:50:35 2014 +0200

    Add Let Rec to semantics.ml

<span style="font-weight:bold;">diff --git a/semantics.ml b/semantics.ml</span>
<span style="font-weight:bold;">index a7e59e2..1698b9b 100644</span>
<span style="font-weight:bold;">--- a/semantics.ml</span>
<span style="font-weight:bold;">+++ b/semantics.ml</span>
<span style="color:teal;">@@ -77,6 +77,8 @@</span> let rec reduce = function
  | (Let(x,tip,e1,e2,loc), s)
     -&gt; (match reduce (e1,s) with Some (e1',s') -&gt; Some (Let(x,tip,e1',e2,loc),s')
      | None -&gt; None)
  <span style="color:green;">| (LetRec(x,tip,e1,e2,loc),s)</span>
<span style="color:green;">     -&gt; Some( subst x (LetRec (x,tip,e1,e1,loc)) e2, s)</span>

(*  Normal Order
  | (App (Fun(x,_,e1,_),e2,_),s) -&gt; Some (subst x e2 e1, s)

<span style="color:olive;">commit 8d6427fb2e0751e40e502b24cde1103fca903f70</span>
Author: Dragos Calin &lt;calinho_gx1992@yahoo.com&gt;
Date:   Mon Dec 22 17:46:36 2014 +0200

    Add Let Rec to parser.mly

<span style="font-weight:bold;">diff --git a/parser.mly b/parser.mly</span>
<span style="font-weight:bold;">index aae5aff..84f68cd 100644</span>
<span style="font-weight:bold;">--- a/parser.mly</span>
<span style="font-weight:bold;">+++ b/parser.mly</span>
<span style="color:teal;">@@ -30,7 +30,7 @@</span> let parseError loc = raise (Lexer.ParseError loc)
%token LPAREN RPAREN
%token FUN COLON
%token EQUAL
%token LET <span style="color:green;">REC</span> IN
%token TINT TBOOL TUNIT TFLOAT
%token ARROW FUNX
%token EOF
<span style="color:teal;">@@ -78,8 +78,10 @@</span> expr:
                               { For ($3, $5, $7, $9, location()) }
  | FUN LPAREN VAR COLON tip RPAREN ARROW expr %prec FUNX
                               { Fun ($3, $5, $8, location()) }
  <span style="color:green;">| LET REC VAR COLON tip EQUAL expr IN expr %prec LETX</span>
<span style="color:green;">                               { LetRec ($3, $5, $7, $9, location()) }</span>
  | LET VAR COLON tip EQUAL expr IN expr %prec LETX
                               { Let ($2, $4, $6, $8, location()) }                                                      
  | expr funexpr               { App ($1, $2, location()) }
  | funexpr                    { $1 }
  | error                      { parseError (location ()) }

<span style="color:olive;">commit 57c56a23e3b100bc6e08a8a4a361a30ce5f89849</span>
Author: Dragos Calin &lt;calinho_gx1992@yahoo.com&gt;
Date:   Mon Dec 22 15:38:54 2014 +0200

    Add REC to lexer.mll

<span style="font-weight:bold;">diff --git a/lexer.mll b/lexer.mll</span>
<span style="font-weight:bold;">index 49b34e3..ea055b4 100644</span>
<span style="font-weight:bold;">--- a/lexer.mll</span>
<span style="font-weight:bold;">+++ b/lexer.mll</span>
<span style="color:teal;">@@ -31,6 +31,7 @@</span> let keyword_table = Hashtbl.create 20
  [
   ( &quot;fun&quot;          , FUN );
   ( &quot;let&quot;          , LET );
   <span style="color:green;">( &quot;rec&quot;          , REC );</span>
   ( &quot;in&quot;           , IN );
   ( &quot;int&quot;          , TINT );
   ( &quot;bool&quot;         , TBOOL );

<span style="color:olive;">commit 714e476b492376202c19a8efdd6ea96b8f478d4b</span>
Author: Dragos Calin &lt;calinho_gx1992@yahoo.com&gt;
Date:   Fri Dec 19 21:56:30 2014 +0200

    Add newline

<span style="font-weight:bold;">diff --git a/.gitignore b/.gitignore</span>
<span style="font-weight:bold;">index 9c7723f..ef676ba 100644</span>
<span style="font-weight:bold;">--- a/.gitignore</span>
<span style="font-weight:bold;">+++ b/.gitignore</span>
<span style="color:teal;">@@ -2,4 +2,4 @@</span>
*.cmi
parser.ml
lexer.ml
parser.mli

<span style="color:olive;">commit d2f454350a44758702e2dc256ba97bc7437eae10</span>
Author: Dragos Calin &lt;calinho_gx1992@yahoo.com&gt;
Date:   Fri Dec 19 12:51:25 2014 +0200

    Update .gitignore

<span style="font-weight:bold;">diff --git a/.gitignore b/.gitignore</span>
<span style="font-weight:bold;">index d16e011..9c7723f 100644</span>
<span style="font-weight:bold;">--- a/.gitignore</span>
<span style="font-weight:bold;">+++ b/.gitignore</span>
<span style="color:teal;">@@ -1 +1,5 @@</span>
*.cmo
<span style="color:green;">*.cmi</span>
<span style="color:green;">parser.ml</span>
<span style="color:green;">lexer.ml</span>
<span style="color:green;">parser.mli</span>

<span style="color:olive;">commit 6c22012ba3a6c6744bf8deee835b85ba8393658d</span>
Author: Dragos Calin &lt;calinho_gx1992@yahoo.com&gt;
Date:   Fri Dec 19 12:38:15 2014 +0200

    Add .gitignore file

<span style="font-weight:bold;">diff --git a/.gitignore b/.gitignore</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..d16e011</span>
<span style="font-weight:bold;">--- /dev/null</span>
<span style="font-weight:bold;">+++ b/.gitignore</span>
<span style="color:teal;">@@ -0,0 +1 @@</span>
<span style="color:green;">*.cmo</span>

<span style="color:olive;">commit ec389d7f695a607ed55831226709e248b3e5318b</span>
Author: Dragos Calin &lt;calinho_gx1992@yahoo.com&gt;
Date:   Fri Dec 19 12:37:42 2014 +0200

    Remove Garbage

<span style="font-weight:bold;">diff --git a/imp.cmi b/imp.cmi</span>
<span style="font-weight:bold;">deleted file mode 100644</span>
<span style="font-weight:bold;">index a354758..0000000</span>
Binary files a/imp.cmi and /dev/null differ
<span style="font-weight:bold;">diff --git a/imp.cmo b/imp.cmo</span>
<span style="font-weight:bold;">deleted file mode 100644</span>
<span style="font-weight:bold;">index 7337632..0000000</span>
Binary files a/imp.cmo and /dev/null differ
<span style="font-weight:bold;">diff --git a/impAST.cmi b/impAST.cmi</span>
<span style="font-weight:bold;">deleted file mode 100644</span>
<span style="font-weight:bold;">index ad35c4f..0000000</span>
Binary files a/impAST.cmi and /dev/null differ
<span style="font-weight:bold;">diff --git a/impAST.cmo b/impAST.cmo</span>
<span style="font-weight:bold;">deleted file mode 100644</span>
<span style="font-weight:bold;">index 66e8533..0000000</span>
Binary files a/impAST.cmo and /dev/null differ
<span style="font-weight:bold;">diff --git a/lexer.cmi b/lexer.cmi</span>
<span style="font-weight:bold;">deleted file mode 100644</span>
<span style="font-weight:bold;">index dcb0b11..0000000</span>
Binary files a/lexer.cmi and /dev/null differ
<span style="font-weight:bold;">diff --git a/lexer.cmo b/lexer.cmo</span>
<span style="font-weight:bold;">deleted file mode 100644</span>
<span style="font-weight:bold;">index fe0d86f..0000000</span>
Binary files a/lexer.cmo and /dev/null differ
<span style="font-weight:bold;">diff --git a/lexer.ml b/lexer.ml</span>
<span style="font-weight:bold;">deleted file mode 100644</span>
<span style="font-weight:bold;">index 288d352..0000000</span>
<span style="font-weight:bold;">--- a/lexer.ml</span>
<span style="font-weight:bold;">+++ /dev/null</span>
<span style="color:teal;">@@ -1,331 +0,0 @@</span>
<span style="color:red;"># 2 &quot;lexer.mll&quot;</span>
<span style="color:red;"> </span>
<span style="color:red;">open Parser        (* The type token is defined in parser.mli *)</span>

<span style="color:red;">exception LexerError of string</span>
<span style="color:red;">exception ParseError of string</span>

<span style="color:red;">(*  Code for maintaining line numbers while tokenizing *)</span>

<span style="color:red;">let incr_linenum lexbuf =</span>
<span style="color:red;">      let pos = lexbuf.Lexing.lex_curr_p in</span>
<span style="color:red;">      lexbuf.Lexing.lex_curr_p &lt;- { pos with</span>
<span style="color:red;">        (* incrementing line number *)</span>
<span style="color:red;">        Lexing.pos_lnum = pos.Lexing.pos_lnum + 1;</span>
<span style="color:red;">        (* setting offset for beggining of line *)</span>
<span style="color:red;">        Lexing.pos_bol = pos.Lexing.pos_cnum;</span>
<span style="color:red;">      }</span>

<span style="color:red;">let lex_error lexbuf =</span>
<span style="color:red;">         begin</span>
<span style="color:red;">           let curr = lexbuf.Lexing.lex_curr_p in</span>
<span style="color:red;">           let file = curr.Lexing.pos_fname</span>
<span style="color:red;">           and line = curr.Lexing.pos_lnum</span>
<span style="color:red;">           and cnum = curr.Lexing.pos_cnum - curr.Lexing.pos_bol in</span>
<span style="color:red;">              raise (LexerError (Printf.sprintf &quot;%s:%d.%d&quot; file line cnum))</span>
<span style="color:red;">         end</span>

<span style="color:red;">let keyword_table = Hashtbl.create 20</span>
<span style="color:red;">  let _ =</span>
<span style="color:red;">    List.iter (fun (kwd, tok) -&gt; Hashtbl.add keyword_table kwd tok)</span>
<span style="color:red;">  [</span>
<span style="color:red;">   ( &quot;fun&quot;          , FUN );</span>
<span style="color:red;">   ( &quot;int&quot;          , TINT );</span>
<span style="color:red;">   ( &quot;bool&quot;         , TBOOL );</span>
<span style="color:red;">   ( &quot;float&quot;        , TFLOAT );</span>
<span style="color:red;">   ( &quot;unit&quot;         , TUNIT );</span>
<span style="color:red;">   ( &quot;int_of_float&quot; , INT_CAST );</span>
<span style="color:red;">   ( &quot;float_of_int&quot; , FLOAT_CAST );</span>
<span style="color:red;">   ( &quot;if&quot;           , IF );</span>
<span style="color:red;">   ( &quot;then&quot;         , THEN );</span>
<span style="color:red;">   ( &quot;else&quot;         , ELSE );</span>
<span style="color:red;">   ( &quot;while&quot;        , WHILE );</span>
<span style="color:red;">   ( &quot;do&quot;           , DO );</span>
<span style="color:red;">   ( &quot;done&quot;         , DONE );</span>
<span style="color:red;">   ( &quot;for&quot;          , FOR );</span>
<span style="color:red;">   ( &quot;true&quot;         , TRUE );</span>
<span style="color:red;">   ( &quot;false&quot;        , FALSE );</span>
<span style="color:red;">   ( &quot;Z&quot;            , Z);</span>
<span style="color:red;">]</span>


<span style="color:red;"># 53 &quot;lexer.ml&quot;</span>
<span style="color:red;">let __ocaml_lex_tables = {</span>
<span style="color:red;">  Lexing.lex_base = </span>
<span style="color:red;">   &quot;\000\000\234\255\235\255\075\000\237\255\238\255\000\000\241\255\</span>
<span style="color:red;">    \003\000\001\000\247\255\249\255\152\000\162\000\253\255\016\000\</span>
<span style="color:red;">    \255\255\001\000\254\255\250\255\177\000\244\255\243\255\240\255\</span>
<span style="color:red;">    &quot;;</span>
<span style="color:red;">  Lexing.lex_backtrk = </span>
<span style="color:red;">   &quot;\255\255\255\255\255\255\019\000\255\255\255\255\016\000\255\255\</span>
<span style="color:red;">    \013\000\010\000\255\255\255\255\004\000\007\000\255\255\009\000\</span>
<span style="color:red;">    \255\255\255\255\255\255\255\255\003\000\255\255\255\255\255\255\</span>
<span style="color:red;">    &quot;;</span>
<span style="color:red;">  Lexing.lex_default = </span>
<span style="color:red;">   &quot;\001\000\000\000\000\000\255\255\000\000\000\000\255\255\000\000\</span>
<span style="color:red;">    \255\255\255\255\000\000\000\000\255\255\255\255\000\000\255\255\</span>
<span style="color:red;">    \000\000\017\000\000\000\000\000\255\255\000\000\000\000\000\000\</span>
<span style="color:red;">    &quot;;</span>
<span style="color:red;">  Lexing.lex_trans = </span>
<span style="color:red;">   &quot;\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">    \000\000\014\000\016\000\018\000\000\000\014\000\000\000\000\000\</span>
<span style="color:red;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">    \014\000\004\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">    \008\000\007\000\010\000\011\000\022\000\013\000\000\000\015\000\</span>
<span style="color:red;">    \012\000\012\000\012\000\012\000\012\000\012\000\012\000\012\000\</span>
<span style="color:red;">    \012\000\012\000\006\000\005\000\009\000\023\000\021\000\017\000\</span>
<span style="color:red;">    \000\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\</span>
<span style="color:red;">    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\</span>
<span style="color:red;">    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\</span>
<span style="color:red;">    \003\000\003\000\003\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">    \000\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\</span>
<span style="color:red;">    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\</span>
<span style="color:red;">    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\</span>
<span style="color:red;">    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\</span>
<span style="color:red;">    \003\000\003\000\003\000\003\000\003\000\000\000\000\000\000\000\</span>
<span style="color:red;">    \000\000\000\000\000\000\000\000\003\000\003\000\003\000\003\000\</span>
<span style="color:red;">    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\</span>
<span style="color:red;">    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\</span>
<span style="color:red;">    \003\000\003\000\003\000\003\000\003\000\003\000\000\000\000\000\</span>
<span style="color:red;">    \000\000\000\000\003\000\000\000\003\000\003\000\003\000\003\000\</span>
<span style="color:red;">    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\</span>
<span style="color:red;">    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\</span>
<span style="color:red;">    \003\000\003\000\003\000\003\000\003\000\003\000\020\000\000\000\</span>
<span style="color:red;">    \012\000\012\000\012\000\012\000\012\000\012\000\012\000\012\000\</span>
<span style="color:red;">    \012\000\012\000\012\000\012\000\012\000\012\000\012\000\012\000\</span>
<span style="color:red;">    \012\000\012\000\012\000\012\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">    \019\000\020\000\020\000\020\000\020\000\020\000\020\000\020\000\</span>
<span style="color:red;">    \020\000\020\000\020\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">    \002\000\018\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">    \000\000\000\000&quot;;</span>
<span style="color:red;">  Lexing.lex_check = </span>
<span style="color:red;">   &quot;\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:red;">    \255\255\000\000\000\000\017\000\255\255\000\000\255\255\255\255\</span>
<span style="color:red;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:red;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:red;">    \000\000\000\000\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:red;">    \000\000\000\000\000\000\000\000\008\000\000\000\255\255\000\000\</span>
<span style="color:red;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">    \000\000\000\000\000\000\000\000\000\000\006\000\009\000\015\000\</span>
<span style="color:red;">    \255\255\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">    \000\000\000\000\000\000\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:red;">    \255\255\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">    \000\000\000\000\000\000\003\000\003\000\003\000\003\000\003\000\</span>
<span style="color:red;">    \003\000\003\000\003\000\003\000\003\000\255\255\255\255\255\255\</span>
<span style="color:red;">    \255\255\255\255\255\255\255\255\003\000\003\000\003\000\003\000\</span>
<span style="color:red;">    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\</span>
<span style="color:red;">    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\</span>
<span style="color:red;">    \003\000\003\000\003\000\003\000\003\000\003\000\255\255\255\255\</span>
<span style="color:red;">    \255\255\255\255\003\000\255\255\003\000\003\000\003\000\003\000\</span>
<span style="color:red;">    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\</span>
<span style="color:red;">    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\</span>
<span style="color:red;">    \003\000\003\000\003\000\003\000\003\000\003\000\012\000\255\255\</span>
<span style="color:red;">    \012\000\012\000\012\000\012\000\012\000\012\000\012\000\012\000\</span>
<span style="color:red;">    \012\000\012\000\013\000\013\000\013\000\013\000\013\000\013\000\</span>
<span style="color:red;">    \013\000\013\000\013\000\013\000\255\255\255\255\255\255\255\255\</span>
<span style="color:red;">    \013\000\020\000\020\000\020\000\020\000\020\000\020\000\020\000\</span>
<span style="color:red;">    \020\000\020\000\020\000\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:red;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:red;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:red;">    \000\000\017\000\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:red;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:red;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:red;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:red;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:red;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:red;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:red;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:red;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:red;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:red;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:red;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:red;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:red;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:red;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:red;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:red;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:red;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:red;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:red;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:red;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:red;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:red;">    \255\255\255\255&quot;;</span>
<span style="color:red;">  Lexing.lex_base_code = </span>
<span style="color:red;">   &quot;&quot;;</span>
<span style="color:red;">  Lexing.lex_backtrk_code = </span>
<span style="color:red;">   &quot;&quot;;</span>
<span style="color:red;">  Lexing.lex_default_code = </span>
<span style="color:red;">   &quot;&quot;;</span>
<span style="color:red;">  Lexing.lex_trans_code = </span>
<span style="color:red;">   &quot;&quot;;</span>
<span style="color:red;">  Lexing.lex_check_code = </span>
<span style="color:red;">   &quot;&quot;;</span>
<span style="color:red;">  Lexing.lex_code = </span>
<span style="color:red;">   &quot;&quot;;</span>
<span style="color:red;">}</span>

<span style="color:red;">let rec token lexbuf =</span>
<span style="color:red;">    __ocaml_lex_token_rec lexbuf 0</span>
<span style="color:red;">and __ocaml_lex_token_rec lexbuf __ocaml_lex_state =</span>
<span style="color:red;">  match Lexing.engine __ocaml_lex_tables __ocaml_lex_state lexbuf with</span>
<span style="color:red;">      | 0 -&gt;</span>
<span style="color:red;"># 54 &quot;lexer.mll&quot;</span>
<span style="color:red;">             ( incr_linenum lexbuf ; token lexbuf )</span>
<span style="color:red;"># 203 &quot;lexer.ml&quot;</span>

<span style="color:red;">  | 1 -&gt;</span>
<span style="color:red;"># 55 &quot;lexer.mll&quot;</span>
<span style="color:red;">                                   ( incr_linenum lexbuf ; token lexbuf )</span>
<span style="color:red;"># 208 &quot;lexer.ml&quot;</span>

<span style="color:red;">  | 2 -&gt;</span>
<span style="color:red;"># 57 &quot;lexer.mll&quot;</span>
<span style="color:red;">                         ( token lexbuf )</span>
<span style="color:red;"># 213 &quot;lexer.ml&quot;</span>

<span style="color:red;">  | 3 -&gt;</span>
<span style="color:red;">let</span>
<span style="color:red;"># 58 &quot;lexer.mll&quot;</span>
<span style="color:red;">                                       lxm</span>
<span style="color:red;"># 219 &quot;lexer.ml&quot;</span>
<span style="color:red;">= Lexing.sub_lexeme lexbuf lexbuf.Lexing.lex_start_pos lexbuf.Lexing.lex_curr_pos in</span>
<span style="color:red;"># 58 &quot;lexer.mll&quot;</span>
<span style="color:red;">                                           ( FLOAT(float_of_string lxm) )</span>
<span style="color:red;"># 223 &quot;lexer.ml&quot;</span>

<span style="color:red;">  | 4 -&gt;</span>
<span style="color:red;">let</span>
<span style="color:red;"># 59 &quot;lexer.mll&quot;</span>
<span style="color:red;">                        lxm</span>
<span style="color:red;"># 229 &quot;lexer.ml&quot;</span>
<span style="color:red;">= Lexing.sub_lexeme lexbuf lexbuf.Lexing.lex_start_pos lexbuf.Lexing.lex_curr_pos in</span>
<span style="color:red;"># 59 &quot;lexer.mll&quot;</span>
<span style="color:red;">                            ( INT(int_of_string lxm) )</span>
<span style="color:red;"># 233 &quot;lexer.ml&quot;</span>

<span style="color:red;">  | 5 -&gt;</span>
<span style="color:red;"># 60 &quot;lexer.mll&quot;</span>
<span style="color:red;">                   ( ARROW )</span>
<span style="color:red;"># 238 &quot;lexer.ml&quot;</span>

<span style="color:red;">  | 6 -&gt;</span>
<span style="color:red;"># 61 &quot;lexer.mll&quot;</span>
<span style="color:red;">                   ( PLUS )</span>
<span style="color:red;"># 243 &quot;lexer.ml&quot;</span>

<span style="color:red;">  | 7 -&gt;</span>
<span style="color:red;"># 62 &quot;lexer.mll&quot;</span>
<span style="color:red;">                   ( MINUS )</span>
<span style="color:red;"># 248 &quot;lexer.ml&quot;</span>

<span style="color:red;">  | 8 -&gt;</span>
<span style="color:red;"># 63 &quot;lexer.mll&quot;</span>
<span style="color:red;">                   ( MUL )</span>
<span style="color:red;"># 253 &quot;lexer.ml&quot;</span>

<span style="color:red;">  | 9 -&gt;</span>
<span style="color:red;"># 64 &quot;lexer.mll&quot;</span>
<span style="color:red;">                   ( DIV )</span>
<span style="color:red;"># 258 &quot;lexer.ml&quot;</span>

<span style="color:red;">  | 10 -&gt;</span>
<span style="color:red;"># 65 &quot;lexer.mll&quot;</span>
<span style="color:red;">                   ( LT )</span>
<span style="color:red;"># 263 &quot;lexer.ml&quot;</span>

<span style="color:red;">  | 11 -&gt;</span>
<span style="color:red;"># 66 &quot;lexer.mll&quot;</span>
<span style="color:red;">                   ( LTE )</span>
<span style="color:red;"># 268 &quot;lexer.ml&quot;</span>

<span style="color:red;">  | 12 -&gt;</span>
<span style="color:red;"># 67 &quot;lexer.mll&quot;</span>
<span style="color:red;">                   ( SKIP )</span>
<span style="color:red;"># 273 &quot;lexer.ml&quot;</span>

<span style="color:red;">  | 13 -&gt;</span>
<span style="color:red;"># 68 &quot;lexer.mll&quot;</span>
<span style="color:red;">                   ( LPAREN )</span>
<span style="color:red;"># 278 &quot;lexer.ml&quot;</span>

<span style="color:red;">  | 14 -&gt;</span>
<span style="color:red;"># 69 &quot;lexer.mll&quot;</span>
<span style="color:red;">                   ( RPAREN )</span>
<span style="color:red;"># 283 &quot;lexer.ml&quot;</span>

<span style="color:red;">  | 15 -&gt;</span>
<span style="color:red;"># 70 &quot;lexer.mll&quot;</span>
<span style="color:red;">                   ( ASGNOP )</span>
<span style="color:red;"># 288 &quot;lexer.ml&quot;</span>

<span style="color:red;">  | 16 -&gt;</span>
<span style="color:red;"># 71 &quot;lexer.mll&quot;</span>
<span style="color:red;">                   ( COLON )</span>
<span style="color:red;"># 293 &quot;lexer.ml&quot;</span>

<span style="color:red;">  | 17 -&gt;</span>
<span style="color:red;"># 72 &quot;lexer.mll&quot;</span>
<span style="color:red;">                   ( SEQ )</span>
<span style="color:red;"># 298 &quot;lexer.ml&quot;</span>

<span style="color:red;">  | 18 -&gt;</span>
<span style="color:red;"># 73 &quot;lexer.mll&quot;</span>
<span style="color:red;">                  ( DEREF )</span>
<span style="color:red;"># 303 &quot;lexer.ml&quot;</span>

<span style="color:red;">  | 19 -&gt;</span>
<span style="color:red;">let</span>
<span style="color:red;"># 74 &quot;lexer.mll&quot;</span>
<span style="color:red;">                                                         id</span>
<span style="color:red;"># 309 &quot;lexer.ml&quot;</span>
<span style="color:red;">= Lexing.sub_lexeme lexbuf lexbuf.Lexing.lex_start_pos lexbuf.Lexing.lex_curr_pos in</span>
<span style="color:red;"># 75 &quot;lexer.mll&quot;</span>
<span style="color:red;">                   ( try Hashtbl.find keyword_table id </span>
<span style="color:red;">                     with Not_found -&gt; </span>
<span style="color:red;">                       if String.get id 0 = 'l' </span>
<span style="color:red;">                       then LOC(id) </span>
<span style="color:red;">                       else VAR(id) )</span>
<span style="color:red;"># 317 &quot;lexer.ml&quot;</span>

<span style="color:red;">  | 20 -&gt;</span>
<span style="color:red;"># 80 &quot;lexer.mll&quot;</span>
<span style="color:red;">                   ( EOF )</span>
<span style="color:red;"># 322 &quot;lexer.ml&quot;</span>

<span style="color:red;">  | 21 -&gt;</span>
<span style="color:red;"># 81 &quot;lexer.mll&quot;</span>
<span style="color:red;">                   ( lex_error lexbuf )</span>
<span style="color:red;"># 327 &quot;lexer.ml&quot;</span>

<span style="color:red;">  | __ocaml_lex_state -&gt; lexbuf.Lexing.refill_buff lexbuf; __ocaml_lex_token_rec lexbuf __ocaml_lex_state</span>

<span style="color:red;">;;</span>

<span style="font-weight:bold;">diff --git a/mem.cmi b/mem.cmi</span>
<span style="font-weight:bold;">deleted file mode 100644</span>
<span style="font-weight:bold;">index 57de7ae..0000000</span>
Binary files a/mem.cmi and /dev/null differ
<span style="font-weight:bold;">diff --git a/mem.cmo b/mem.cmo</span>
<span style="font-weight:bold;">deleted file mode 100644</span>
<span style="font-weight:bold;">index da71a72..0000000</span>
Binary files a/mem.cmo and /dev/null differ
<span style="font-weight:bold;">diff --git a/parser.cmi b/parser.cmi</span>
<span style="font-weight:bold;">deleted file mode 100644</span>
<span style="font-weight:bold;">index bd1ce53..0000000</span>
Binary files a/parser.cmi and /dev/null differ
<span style="font-weight:bold;">diff --git a/parser.cmo b/parser.cmo</span>
<span style="font-weight:bold;">deleted file mode 100644</span>
<span style="font-weight:bold;">index 2309a2e..0000000</span>
Binary files a/parser.cmo and /dev/null differ
<span style="font-weight:bold;">diff --git a/parser.ml b/parser.ml</span>
<span style="font-weight:bold;">deleted file mode 100644</span>
<span style="font-weight:bold;">index d2bc143..0000000</span>
<span style="font-weight:bold;">--- a/parser.ml</span>
<span style="font-weight:bold;">+++ /dev/null</span>
<span style="color:teal;">@@ -1,637 +0,0 @@</span>
<span style="color:red;">type token =</span>
<span style="color:red;">  | Z</span>
<span style="color:red;">  | INT_CAST</span>
<span style="color:red;">  | FLOAT_CAST</span>
<span style="color:red;">  | INT of (int)</span>
<span style="color:red;">  | FLOAT of (float)</span>
<span style="color:red;">  | LOC of (string)</span>
<span style="color:red;">  | VAR of (string)</span>
<span style="color:red;">  | TRUE</span>
<span style="color:red;">  | FALSE</span>
<span style="color:red;">  | SEQ</span>
<span style="color:red;">  | SKIP</span>
<span style="color:red;">  | IF</span>
<span style="color:red;">  | THEN</span>
<span style="color:red;">  | ELSE</span>
<span style="color:red;">  | WHILE</span>
<span style="color:red;">  | DO</span>
<span style="color:red;">  | DONE</span>
<span style="color:red;">  | FOR</span>
<span style="color:red;">  | LT</span>
<span style="color:red;">  | LTE</span>
<span style="color:red;">  | EQ</span>
<span style="color:red;">  | ASGNOP</span>
<span style="color:red;">  | DEREF</span>
<span style="color:red;">  | PLUS</span>
<span style="color:red;">  | MINUS</span>
<span style="color:red;">  | MUL</span>
<span style="color:red;">  | DIV</span>
<span style="color:red;">  | LPAREN</span>
<span style="color:red;">  | RPAREN</span>
<span style="color:red;">  | FUN</span>
<span style="color:red;">  | COLON</span>
<span style="color:red;">  | TINT</span>
<span style="color:red;">  | TBOOL</span>
<span style="color:red;">  | TUNIT</span>
<span style="color:red;">  | TFLOAT</span>
<span style="color:red;">  | ARROW</span>
<span style="color:red;">  | FUNX</span>
<span style="color:red;">  | EOF</span>

<span style="color:red;">open Parsing;;</span>
<span style="color:red;">let _ = parse_error;;</span>
<span style="color:red;"># 3 &quot;parser.mly&quot;</span>
<span style="color:red;">open ImpAST</span>
<span style="color:red;">open Lexing</span>

<span style="color:red;">let location () =  let start_pos = Parsing.symbol_start_pos () in</span>
<span style="color:red;">    let end_pos = Parsing.symbol_end_pos () in</span>
<span style="color:red;">    Printf.sprintf &quot;%s:%d.%d-%d.%d&quot;</span>
<span style="color:red;">      start_pos.pos_fname</span>
<span style="color:red;">      start_pos.pos_lnum (start_pos.pos_cnum - start_pos.pos_bol)</span>
<span style="color:red;">      end_pos.pos_lnum (end_pos.pos_cnum - end_pos.pos_bol)</span>

<span style="color:red;">let parseError loc = raise (Lexer.ParseError loc)</span>

<span style="color:red;"># 57 &quot;parser.ml&quot;</span>
<span style="color:red;">let yytransl_const = [|</span>
<span style="color:red;">  257 (* Z *);</span>
<span style="color:red;">  258 (* INT_CAST *);</span>
<span style="color:red;">  259 (* FLOAT_CAST *);</span>
<span style="color:red;">  264 (* TRUE *);</span>
<span style="color:red;">  265 (* FALSE *);</span>
<span style="color:red;">  266 (* SEQ *);</span>
<span style="color:red;">  267 (* SKIP *);</span>
<span style="color:red;">  268 (* IF *);</span>
<span style="color:red;">  269 (* THEN *);</span>
<span style="color:red;">  270 (* ELSE *);</span>
<span style="color:red;">  271 (* WHILE *);</span>
<span style="color:red;">  272 (* DO *);</span>
<span style="color:red;">  273 (* DONE *);</span>
<span style="color:red;">  274 (* FOR *);</span>
<span style="color:red;">  275 (* LT *);</span>
<span style="color:red;">  276 (* LTE *);</span>
<span style="color:red;">  277 (* EQ *);</span>
<span style="color:red;">  278 (* ASGNOP *);</span>
<span style="color:red;">  279 (* DEREF *);</span>
<span style="color:red;">  280 (* PLUS *);</span>
<span style="color:red;">  281 (* MINUS *);</span>
<span style="color:red;">  282 (* MUL *);</span>
<span style="color:red;">  283 (* DIV *);</span>
<span style="color:red;">  284 (* LPAREN *);</span>
<span style="color:red;">  285 (* RPAREN *);</span>
<span style="color:red;">  286 (* FUN *);</span>
<span style="color:red;">  287 (* COLON *);</span>
<span style="color:red;">  288 (* TINT *);</span>
<span style="color:red;">  289 (* TBOOL *);</span>
<span style="color:red;">  290 (* TUNIT *);</span>
<span style="color:red;">  291 (* TFLOAT *);</span>
<span style="color:red;">  292 (* ARROW *);</span>
<span style="color:red;">  293 (* FUNX *);</span>
<span style="color:red;">    0 (* EOF *);</span>
<span style="color:red;">    0|]</span>

<span style="color:red;">let yytransl_block = [|</span>
<span style="color:red;">  260 (* INT *);</span>
<span style="color:red;">  261 (* FLOAT *);</span>
<span style="color:red;">  262 (* LOC *);</span>
<span style="color:red;">  263 (* VAR *);</span>
<span style="color:red;">    0|]</span>

<span style="color:red;">let yylhs = &quot;\255\255\</span>
<span style="color:red;">\001\000\003\000\003\000\003\000\003\000\003\000\003\000\002\000\</span>
<span style="color:red;">\002\000\002\000\002\000\002\000\002\000\002\000\002\000\002\000\</span>
<span style="color:red;">\002\000\002\000\002\000\002\000\002\000\002\000\004\000\004\000\</span>
<span style="color:red;">\004\000\004\000\004\000\004\000\004\000\004\000\004\000\004\000\</span>
<span style="color:red;">\004\000\000\000&quot;</span>

<span style="color:red;">let yylen = &quot;\002\000\</span>
<span style="color:red;">\002\000\001\000\001\000\001\000\001\000\003\000\003\000\003\000\</span>
<span style="color:red;">\003\000\003\000\003\000\003\000\003\000\003\000\003\000\006\000\</span>
<span style="color:red;">\005\000\009\000\008\000\002\000\001\000\001\000\001\000\001\000\</span>
<span style="color:red;">\001\000\001\000\001\000\001\000\001\000\001\000\001\000\003\000\</span>
<span style="color:red;">\002\000\002\000&quot;</span>

<span style="color:red;">let yydefred = &quot;\000\000\</span>
<span style="color:red;">\000\000\000\000\022\000\031\000\029\000\030\000\023\000\024\000\</span>
<span style="color:red;">\000\000\028\000\025\000\026\000\027\000\000\000\000\000\000\000\</span>
<span style="color:red;">\000\000\000\000\000\000\034\000\000\000\021\000\000\000\000\000\</span>
<span style="color:red;">\000\000\000\000\033\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">\000\000\000\000\000\000\000\000\001\000\020\000\000\000\000\000\</span>
<span style="color:red;">\000\000\000\000\032\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">\017\000\000\000\000\000\002\000\003\000\004\000\005\000\000\000\</span>
<span style="color:red;">\000\000\000\000\000\000\000\000\000\000\000\000\007\000\000\000\</span>
<span style="color:red;">\000\000\000\000\000\000\000\000&quot;</span>

<span style="color:red;">let yydgoto = &quot;\002\000\</span>
<span style="color:red;">\020\000\021\000\064\000\022\000&quot;</span>

<span style="color:red;">let yysindex = &quot;\002\000\</span>
<span style="color:red;">\152\255\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">\240\254\000\000\000\000\000\000\000\000\152\255\152\255\239\254\</span>
<span style="color:red;">\006\255\152\255\243\254\000\000\141\000\000\000\152\255\169\000\</span>
<span style="color:red;">\197\000\152\255\000\000\182\255\010\255\152\255\152\255\152\255\</span>
<span style="color:red;">\152\255\152\255\152\255\152\255\000\000\000\000\137\001\152\255\</span>
<span style="color:red;">\152\255\025\001\000\000\252\254\053\001\137\001\137\001\252\255\</span>
<span style="color:red;">\252\255\241\255\241\255\225\000\253\000\152\255\000\255\152\255\</span>
<span style="color:red;">\000\000\081\001\000\255\000\000\000\000\000\000\000\000\229\254\</span>
<span style="color:red;">\109\001\152\255\234\254\238\254\000\255\211\255\000\000\152\255\</span>
<span style="color:red;">\249\254\152\255\053\001\109\001&quot;</span>

<span style="color:red;">let yyrindex = &quot;\000\000\</span>
<span style="color:red;">\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">\000\000\000\000\000\000\000\000\000\000\000\000\071\000\000\000\</span>
<span style="color:red;">\000\000\000\000\000\000\000\000\107\000\079\000\088\000\037\000\</span>
<span style="color:red;">\054\000\001\000\019\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">\093\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">\007\255\000\000\112\000\102\000&quot;</span>

<span style="color:red;">let yygindex = &quot;\000\000\</span>
<span style="color:red;">\000\000\246\255\197\255\075\000&quot;</span>

<span style="color:red;">let yytablesize = 677</span>
<span style="color:red;">let yytable = &quot;\067\000\</span>
<span style="color:red;">\010\000\068\000\001\000\024\000\025\000\023\000\071\000\028\000\</span>
<span style="color:red;">\069\000\073\000\026\000\027\000\039\000\069\000\029\000\042\000\</span>
<span style="color:red;">\044\000\072\000\011\000\045\000\046\000\047\000\048\000\049\000\</span>
<span style="color:red;">\050\000\051\000\055\000\059\000\069\000\052\000\053\000\060\000\</span>
<span style="color:red;">\061\000\062\000\063\000\006\000\008\000\000\000\000\000\000\000\</span>
<span style="color:red;">\000\000\000\000\000\000\058\000\000\000\065\000\000\000\000\000\</span>
<span style="color:red;">\000\000\000\000\000\000\000\000\000\000\009\000\000\000\070\000\</span>
<span style="color:red;">\000\000\000\000\000\000\000\000\000\000\075\000\000\000\076\000\</span>
<span style="color:red;">\000\000\000\000\000\000\000\000\000\000\000\000\012\000\000\000\</span>
<span style="color:red;">\000\000\000\000\000\000\000\000\000\000\000\000\014\000\000\000\</span>
<span style="color:red;">\000\000\000\000\000\000\000\000\000\000\000\000\000\000\013\000\</span>
<span style="color:red;">\000\000\000\000\000\000\000\000\016\000\000\000\000\000\038\000\</span>
<span style="color:red;">\000\000\000\000\038\000\038\000\000\000\018\000\038\000\000\000\</span>
<span style="color:red;">\000\000\000\000\015\000\000\000\000\000\000\000\000\000\019\000\</span>
<span style="color:red;">\000\000\038\000\000\000\000\000\038\000\000\000\000\000\038\000\</span>
<span style="color:red;">\038\000\038\000\038\000\038\000\038\000\038\000\038\000\038\000\</span>
<span style="color:red;">\000\000\000\000\000\000\000\000\038\000\000\000\000\000\000\000\</span>
<span style="color:red;">\000\000\000\000\000\000\038\000\037\000\000\000\000\000\000\000\</span>
<span style="color:red;">\038\000\000\000\000\000\000\000\000\000\038\000\038\000\003\000\</span>
<span style="color:red;">\004\000\005\000\006\000\007\000\008\000\009\000\010\000\011\000\</span>
<span style="color:red;">\012\000\000\000\013\000\014\000\000\000\000\000\015\000\000\000\</span>
<span style="color:red;">\000\000\016\000\000\000\000\000\000\000\000\000\017\000\000\000\</span>
<span style="color:red;">\000\000\000\000\000\000\018\000\000\000\019\000\004\000\005\000\</span>
<span style="color:red;">\006\000\007\000\008\000\000\000\010\000\011\000\012\000\030\000\</span>
<span style="color:red;">\013\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">\031\000\032\000\000\000\000\000\017\000\033\000\034\000\035\000\</span>
<span style="color:red;">\036\000\018\000\043\000\004\000\005\000\006\000\007\000\008\000\</span>
<span style="color:red;">\000\000\010\000\011\000\012\000\030\000\013\000\000\000\000\000\</span>
<span style="color:red;">\000\000\000\000\000\000\000\000\000\000\031\000\032\000\000\000\</span>
<span style="color:red;">\000\000\017\000\033\000\034\000\035\000\036\000\018\000\074\000\</span>
<span style="color:red;">\000\000\004\000\005\000\006\000\007\000\008\000\000\000\010\000\</span>
<span style="color:red;">\011\000\012\000\000\000\013\000\004\000\005\000\006\000\007\000\</span>
<span style="color:red;">\008\000\000\000\010\000\011\000\012\000\000\000\013\000\017\000\</span>
<span style="color:red;">\000\000\000\000\010\000\000\000\018\000\010\000\010\000\000\000\</span>
<span style="color:red;">\010\000\010\000\017\000\010\000\010\000\035\000\036\000\018\000\</span>
<span style="color:red;">\010\000\010\000\010\000\010\000\011\000\010\000\000\000\011\000\</span>
<span style="color:red;">\011\000\000\000\011\000\011\000\000\000\011\000\011\000\000\000\</span>
<span style="color:red;">\000\000\000\000\011\000\011\000\011\000\011\000\008\000\011\000\</span>
<span style="color:red;">\000\000\008\000\008\000\000\000\008\000\008\000\000\000\008\000\</span>
<span style="color:red;">\008\000\000\000\000\000\000\000\008\000\008\000\000\000\009\000\</span>
<span style="color:red;">\000\000\008\000\009\000\009\000\000\000\009\000\009\000\000\000\</span>
<span style="color:red;">\009\000\009\000\000\000\000\000\000\000\009\000\009\000\000\000\</span>
<span style="color:red;">\012\000\000\000\009\000\012\000\012\000\000\000\012\000\012\000\</span>
<span style="color:red;">\014\000\012\000\012\000\014\000\014\000\000\000\014\000\014\000\</span>
<span style="color:red;">\000\000\013\000\000\000\012\000\013\000\013\000\016\000\013\000\</span>
<span style="color:red;">\013\000\016\000\016\000\014\000\016\000\016\000\000\000\018\000\</span>
<span style="color:red;">\000\000\000\000\018\000\018\000\013\000\018\000\018\000\015\000\</span>
<span style="color:red;">\015\000\016\000\015\000\015\000\019\000\019\000\000\000\019\000\</span>
<span style="color:red;">\019\000\000\000\018\000\000\000\000\000\000\000\000\000\015\000\</span>
<span style="color:red;">\000\000\000\000\000\000\000\000\019\000\004\000\005\000\006\000\</span>
<span style="color:red;">\007\000\008\000\000\000\010\000\011\000\012\000\030\000\013\000\</span>
<span style="color:red;">\000\000\000\000\000\000\000\000\000\000\000\000\000\000\031\000\</span>
<span style="color:red;">\032\000\000\000\000\000\017\000\033\000\034\000\035\000\036\000\</span>
<span style="color:red;">\018\000\004\000\005\000\006\000\007\000\008\000\000\000\010\000\</span>
<span style="color:red;">\011\000\012\000\030\000\013\000\000\000\040\000\000\000\000\000\</span>
<span style="color:red;">\000\000\000\000\000\000\031\000\032\000\000\000\000\000\017\000\</span>
<span style="color:red;">\033\000\034\000\035\000\036\000\018\000\004\000\005\000\006\000\</span>
<span style="color:red;">\007\000\008\000\000\000\010\000\011\000\012\000\030\000\013\000\</span>
<span style="color:red;">\000\000\000\000\000\000\000\000\041\000\000\000\000\000\031\000\</span>
<span style="color:red;">\032\000\000\000\000\000\017\000\033\000\034\000\035\000\036\000\</span>
<span style="color:red;">\018\000\004\000\005\000\006\000\007\000\008\000\000\000\010\000\</span>
<span style="color:red;">\011\000\012\000\030\000\013\000\000\000\000\000\056\000\000\000\</span>
<span style="color:red;">\000\000\000\000\000\000\031\000\032\000\000\000\000\000\017\000\</span>
<span style="color:red;">\033\000\034\000\035\000\036\000\018\000\004\000\005\000\006\000\</span>
<span style="color:red;">\007\000\008\000\000\000\010\000\011\000\012\000\030\000\013\000\</span>
<span style="color:red;">\000\000\000\000\000\000\000\000\000\000\057\000\000\000\031\000\</span>
<span style="color:red;">\032\000\000\000\000\000\017\000\033\000\034\000\035\000\036\000\</span>
<span style="color:red;">\018\000\004\000\005\000\006\000\007\000\008\000\000\000\010\000\</span>
<span style="color:red;">\011\000\012\000\054\000\013\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">\000\000\000\000\000\000\031\000\032\000\000\000\000\000\017\000\</span>
<span style="color:red;">\033\000\034\000\035\000\036\000\018\000\004\000\005\000\006\000\</span>
<span style="color:red;">\007\000\008\000\000\000\010\000\011\000\012\000\030\000\013\000\</span>
<span style="color:red;">\000\000\000\000\000\000\000\000\000\000\000\000\000\000\031\000\</span>
<span style="color:red;">\032\000\000\000\000\000\017\000\033\000\034\000\035\000\036\000\</span>
<span style="color:red;">\018\000\004\000\005\000\006\000\007\000\008\000\000\000\010\000\</span>
<span style="color:red;">\011\000\012\000\066\000\013\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">\000\000\000\000\000\000\031\000\032\000\000\000\000\000\017\000\</span>
<span style="color:red;">\033\000\034\000\035\000\036\000\018\000\004\000\005\000\006\000\</span>
<span style="color:red;">\007\000\008\000\000\000\010\000\011\000\012\000\000\000\013\000\</span>
<span style="color:red;">\000\000\000\000\000\000\000\000\000\000\000\000\000\000\031\000\</span>
<span style="color:red;">\032\000\000\000\000\000\017\000\033\000\034\000\035\000\036\000\</span>
<span style="color:red;">\018\000\004\000\005\000\006\000\007\000\008\000\000\000\010\000\</span>
<span style="color:red;">\011\000\012\000\000\000\013\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">\000\000\000\000\000\000\000\000\000\000\000\000\000\000\017\000\</span>
<span style="color:red;">\033\000\034\000\035\000\036\000\018\000&quot;</span>

<span style="color:red;">let yycheck = &quot;\059\000\</span>
<span style="color:red;">\000\000\029\001\001\000\014\000\015\000\022\001\029\001\018\000\</span>
<span style="color:red;">\036\001\069\000\028\001\006\001\023\000\036\001\028\001\026\000\</span>
<span style="color:red;">\007\001\036\001\000\000\030\000\031\000\032\000\033\000\034\000\</span>
<span style="color:red;">\035\000\036\000\031\001\028\001\036\001\040\000\041\000\032\001\</span>
<span style="color:red;">\033\001\034\001\035\001\029\001\000\000\255\255\255\255\255\255\</span>
<span style="color:red;">\255\255\255\255\255\255\054\000\255\255\056\000\255\255\255\255\</span>
<span style="color:red;">\255\255\255\255\255\255\255\255\255\255\000\000\255\255\066\000\</span>
<span style="color:red;">\255\255\255\255\255\255\255\255\255\255\072\000\255\255\074\000\</span>
<span style="color:red;">\255\255\255\255\255\255\255\255\255\255\255\255\000\000\255\255\</span>
<span style="color:red;">\255\255\255\255\255\255\255\255\255\255\255\255\000\000\255\255\</span>
<span style="color:red;">\255\255\255\255\255\255\255\255\255\255\255\255\255\255\000\000\</span>
<span style="color:red;">\255\255\255\255\255\255\255\255\000\000\255\255\255\255\021\000\</span>
<span style="color:red;">\255\255\255\255\024\000\025\000\255\255\000\000\028\000\255\255\</span>
<span style="color:red;">\255\255\255\255\000\000\255\255\255\255\255\255\255\255\000\000\</span>
<span style="color:red;">\255\255\039\000\255\255\255\255\042\000\255\255\255\255\045\000\</span>
<span style="color:red;">\046\000\047\000\048\000\049\000\050\000\051\000\052\000\053\000\</span>
<span style="color:red;">\255\255\255\255\255\255\255\255\058\000\255\255\255\255\255\255\</span>
<span style="color:red;">\255\255\255\255\255\255\065\000\000\000\255\255\255\255\255\255\</span>
<span style="color:red;">\070\000\255\255\255\255\255\255\255\255\075\000\076\000\000\001\</span>
<span style="color:red;">\001\001\002\001\003\001\004\001\005\001\006\001\007\001\008\001\</span>
<span style="color:red;">\009\001\255\255\011\001\012\001\255\255\255\255\015\001\255\255\</span>
<span style="color:red;">\255\255\018\001\255\255\255\255\255\255\255\255\023\001\255\255\</span>
<span style="color:red;">\255\255\255\255\255\255\028\001\255\255\030\001\001\001\002\001\</span>
<span style="color:red;">\003\001\004\001\005\001\255\255\007\001\008\001\009\001\010\001\</span>
<span style="color:red;">\011\001\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:red;">\019\001\020\001\255\255\255\255\023\001\024\001\025\001\026\001\</span>
<span style="color:red;">\027\001\028\001\029\001\001\001\002\001\003\001\004\001\005\001\</span>
<span style="color:red;">\255\255\007\001\008\001\009\001\010\001\011\001\255\255\255\255\</span>
<span style="color:red;">\255\255\255\255\255\255\255\255\255\255\019\001\020\001\255\255\</span>
<span style="color:red;">\255\255\023\001\024\001\025\001\026\001\027\001\028\001\029\001\</span>
<span style="color:red;">\255\255\001\001\002\001\003\001\004\001\005\001\255\255\007\001\</span>
<span style="color:red;">\008\001\009\001\255\255\011\001\001\001\002\001\003\001\004\001\</span>
<span style="color:red;">\005\001\255\255\007\001\008\001\009\001\255\255\011\001\023\001\</span>
<span style="color:red;">\255\255\255\255\010\001\255\255\028\001\013\001\014\001\255\255\</span>
<span style="color:red;">\016\001\017\001\023\001\019\001\020\001\026\001\027\001\028\001\</span>
<span style="color:red;">\024\001\025\001\026\001\027\001\010\001\029\001\255\255\013\001\</span>
<span style="color:red;">\014\001\255\255\016\001\017\001\255\255\019\001\020\001\255\255\</span>
<span style="color:red;">\255\255\255\255\024\001\025\001\026\001\027\001\010\001\029\001\</span>
<span style="color:red;">\255\255\013\001\014\001\255\255\016\001\017\001\255\255\019\001\</span>
<span style="color:red;">\020\001\255\255\255\255\255\255\024\001\025\001\255\255\010\001\</span>
<span style="color:red;">\255\255\029\001\013\001\014\001\255\255\016\001\017\001\255\255\</span>
<span style="color:red;">\019\001\020\001\255\255\255\255\255\255\024\001\025\001\255\255\</span>
<span style="color:red;">\010\001\255\255\029\001\013\001\014\001\255\255\016\001\017\001\</span>
<span style="color:red;">\010\001\019\001\020\001\013\001\014\001\255\255\016\001\017\001\</span>
<span style="color:red;">\255\255\010\001\255\255\029\001\013\001\014\001\010\001\016\001\</span>
<span style="color:red;">\017\001\013\001\014\001\029\001\016\001\017\001\255\255\010\001\</span>
<span style="color:red;">\255\255\255\255\013\001\014\001\029\001\016\001\017\001\013\001\</span>
<span style="color:red;">\014\001\029\001\016\001\017\001\013\001\014\001\255\255\016\001\</span>
<span style="color:red;">\017\001\255\255\029\001\255\255\255\255\255\255\255\255\029\001\</span>
<span style="color:red;">\255\255\255\255\255\255\255\255\029\001\001\001\002\001\003\001\</span>
<span style="color:red;">\004\001\005\001\255\255\007\001\008\001\009\001\010\001\011\001\</span>
<span style="color:red;">\255\255\255\255\255\255\255\255\255\255\255\255\255\255\019\001\</span>
<span style="color:red;">\020\001\255\255\255\255\023\001\024\001\025\001\026\001\027\001\</span>
<span style="color:red;">\028\001\001\001\002\001\003\001\004\001\005\001\255\255\007\001\</span>
<span style="color:red;">\008\001\009\001\010\001\011\001\255\255\013\001\255\255\255\255\</span>
<span style="color:red;">\255\255\255\255\255\255\019\001\020\001\255\255\255\255\023\001\</span>
<span style="color:red;">\024\001\025\001\026\001\027\001\028\001\001\001\002\001\003\001\</span>
<span style="color:red;">\004\001\005\001\255\255\007\001\008\001\009\001\010\001\011\001\</span>
<span style="color:red;">\255\255\255\255\255\255\255\255\016\001\255\255\255\255\019\001\</span>
<span style="color:red;">\020\001\255\255\255\255\023\001\024\001\025\001\026\001\027\001\</span>
<span style="color:red;">\028\001\001\001\002\001\003\001\004\001\005\001\255\255\007\001\</span>
<span style="color:red;">\008\001\009\001\010\001\011\001\255\255\255\255\014\001\255\255\</span>
<span style="color:red;">\255\255\255\255\255\255\019\001\020\001\255\255\255\255\023\001\</span>
<span style="color:red;">\024\001\025\001\026\001\027\001\028\001\001\001\002\001\003\001\</span>
<span style="color:red;">\004\001\005\001\255\255\007\001\008\001\009\001\010\001\011\001\</span>
<span style="color:red;">\255\255\255\255\255\255\255\255\255\255\017\001\255\255\019\001\</span>
<span style="color:red;">\020\001\255\255\255\255\023\001\024\001\025\001\026\001\027\001\</span>
<span style="color:red;">\028\001\001\001\002\001\003\001\004\001\005\001\255\255\007\001\</span>
<span style="color:red;">\008\001\009\001\010\001\011\001\255\255\255\255\255\255\255\255\</span>
<span style="color:red;">\255\255\255\255\255\255\019\001\020\001\255\255\255\255\023\001\</span>
<span style="color:red;">\024\001\025\001\026\001\027\001\028\001\001\001\002\001\003\001\</span>
<span style="color:red;">\004\001\005\001\255\255\007\001\008\001\009\001\010\001\011\001\</span>
<span style="color:red;">\255\255\255\255\255\255\255\255\255\255\255\255\255\255\019\001\</span>
<span style="color:red;">\020\001\255\255\255\255\023\001\024\001\025\001\026\001\027\001\</span>
<span style="color:red;">\028\001\001\001\002\001\003\001\004\001\005\001\255\255\007\001\</span>
<span style="color:red;">\008\001\009\001\010\001\011\001\255\255\255\255\255\255\255\255\</span>
<span style="color:red;">\255\255\255\255\255\255\019\001\020\001\255\255\255\255\023\001\</span>
<span style="color:red;">\024\001\025\001\026\001\027\001\028\001\001\001\002\001\003\001\</span>
<span style="color:red;">\004\001\005\001\255\255\007\001\008\001\009\001\255\255\011\001\</span>
<span style="color:red;">\255\255\255\255\255\255\255\255\255\255\255\255\255\255\019\001\</span>
<span style="color:red;">\020\001\255\255\255\255\023\001\024\001\025\001\026\001\027\001\</span>
<span style="color:red;">\028\001\001\001\002\001\003\001\004\001\005\001\255\255\007\001\</span>
<span style="color:red;">\008\001\009\001\255\255\011\001\255\255\255\255\255\255\255\255\</span>
<span style="color:red;">\255\255\255\255\255\255\255\255\255\255\255\255\255\255\023\001\</span>
<span style="color:red;">\024\001\025\001\026\001\027\001\028\001&quot;</span>

<span style="color:red;">let yynames_const = &quot;\</span>
<span style="color:red;">  Z\000\</span>
<span style="color:red;">  INT_CAST\000\</span>
<span style="color:red;">  FLOAT_CAST\000\</span>
<span style="color:red;">  TRUE\000\</span>
<span style="color:red;">  FALSE\000\</span>
<span style="color:red;">  SEQ\000\</span>
<span style="color:red;">  SKIP\000\</span>
<span style="color:red;">  IF\000\</span>
<span style="color:red;">  THEN\000\</span>
<span style="color:red;">  ELSE\000\</span>
<span style="color:red;">  WHILE\000\</span>
<span style="color:red;">  DO\000\</span>
<span style="color:red;">  DONE\000\</span>
<span style="color:red;">  FOR\000\</span>
<span style="color:red;">  LT\000\</span>
<span style="color:red;">  LTE\000\</span>
<span style="color:red;">  EQ\000\</span>
<span style="color:red;">  ASGNOP\000\</span>
<span style="color:red;">  DEREF\000\</span>
<span style="color:red;">  PLUS\000\</span>
<span style="color:red;">  MINUS\000\</span>
<span style="color:red;">  MUL\000\</span>
<span style="color:red;">  DIV\000\</span>
<span style="color:red;">  LPAREN\000\</span>
<span style="color:red;">  RPAREN\000\</span>
<span style="color:red;">  FUN\000\</span>
<span style="color:red;">  COLON\000\</span>
<span style="color:red;">  TINT\000\</span>
<span style="color:red;">  TBOOL\000\</span>
<span style="color:red;">  TUNIT\000\</span>
<span style="color:red;">  TFLOAT\000\</span>
<span style="color:red;">  ARROW\000\</span>
<span style="color:red;">  FUNX\000\</span>
<span style="color:red;">  EOF\000\</span>
<span style="color:red;">  &quot;</span>

<span style="color:red;">let yynames_block = &quot;\</span>
<span style="color:red;">  INT\000\</span>
<span style="color:red;">  FLOAT\000\</span>
<span style="color:red;">  LOC\000\</span>
<span style="color:red;">  VAR\000\</span>
<span style="color:red;">  &quot;</span>

<span style="color:red;">let yyact = [|</span>
<span style="color:red;">  (fun _ -&gt; failwith &quot;parser&quot;)</span>
<span style="color:red;">; (fun __caml_parser_env -&gt;</span>
<span style="color:red;">    let _1 = (Parsing.peek_val __caml_parser_env 1 : 'expr) in</span>
<span style="color:red;">    Obj.repr(</span>
<span style="color:red;"># 51 &quot;parser.mly&quot;</span>
<span style="color:red;">                            ( _1 )</span>
<span style="color:red;"># 384 &quot;parser.ml&quot;</span>
<span style="color:red;">               : ImpAST.expr))</span>
<span style="color:red;">; (fun __caml_parser_env -&gt;</span>
<span style="color:red;">    Obj.repr(</span>
<span style="color:red;"># 55 &quot;parser.mly&quot;</span>
<span style="color:red;">                               (TInt)</span>
<span style="color:red;"># 390 &quot;parser.ml&quot;</span>
<span style="color:red;">               : 'tip))</span>
<span style="color:red;">; (fun __caml_parser_env -&gt;</span>
<span style="color:red;">    Obj.repr(</span>
<span style="color:red;"># 56 &quot;parser.mly&quot;</span>
<span style="color:red;">                               (TBool)</span>
<span style="color:red;"># 396 &quot;parser.ml&quot;</span>
<span style="color:red;">               : 'tip))</span>
<span style="color:red;">; (fun __caml_parser_env -&gt;</span>
<span style="color:red;">    Obj.repr(</span>
<span style="color:red;"># 57 &quot;parser.mly&quot;</span>
<span style="color:red;">                               (TUnit)</span>
<span style="color:red;"># 402 &quot;parser.ml&quot;</span>
<span style="color:red;">               : 'tip))</span>
<span style="color:red;">; (fun __caml_parser_env -&gt;</span>
<span style="color:red;">    Obj.repr(</span>
<span style="color:red;"># 58 &quot;parser.mly&quot;</span>
<span style="color:red;">                               (TFloat)</span>
<span style="color:red;"># 408 &quot;parser.ml&quot;</span>
<span style="color:red;">               : 'tip))</span>
<span style="color:red;">; (fun __caml_parser_env -&gt;</span>
<span style="color:red;">    let _1 = (Parsing.peek_val __caml_parser_env 2 : 'tip) in</span>
<span style="color:red;">    let _3 = (Parsing.peek_val __caml_parser_env 0 : 'tip) in</span>
<span style="color:red;">    Obj.repr(</span>
<span style="color:red;"># 59 &quot;parser.mly&quot;</span>
<span style="color:red;">                               ( TArrow (_1, _3) )</span>
<span style="color:red;"># 416 &quot;parser.ml&quot;</span>
<span style="color:red;">               : 'tip))</span>
<span style="color:red;">; (fun __caml_parser_env -&gt;</span>
<span style="color:red;">    let _2 = (Parsing.peek_val __caml_parser_env 1 : 'tip) in</span>
<span style="color:red;">    Obj.repr(</span>
<span style="color:red;"># 60 &quot;parser.mly&quot;</span>
<span style="color:red;">                               ( _2 )</span>
<span style="color:red;"># 423 &quot;parser.ml&quot;</span>
<span style="color:red;">               : 'tip))</span>
<span style="color:red;">; (fun __caml_parser_env -&gt;</span>
<span style="color:red;">    let _1 = (Parsing.peek_val __caml_parser_env 2 : 'expr) in</span>
<span style="color:red;">    let _3 = (Parsing.peek_val __caml_parser_env 0 : 'expr) in</span>
<span style="color:red;">    Obj.repr(</span>
<span style="color:red;"># 63 &quot;parser.mly&quot;</span>
<span style="color:red;">                               ( Op (_1,Plus,_3, location()) )</span>
<span style="color:red;"># 431 &quot;parser.ml&quot;</span>
<span style="color:red;">               : 'expr))</span>
<span style="color:red;">; (fun __caml_parser_env -&gt;</span>
<span style="color:red;">    let _1 = (Parsing.peek_val __caml_parser_env 2 : 'expr) in</span>
<span style="color:red;">    let _3 = (Parsing.peek_val __caml_parser_env 0 : 'expr) in</span>
<span style="color:red;">    Obj.repr(</span>
<span style="color:red;"># 64 &quot;parser.mly&quot;</span>
<span style="color:red;">                                ( Op (_1,Minus,_3, location()) )</span>
<span style="color:red;"># 439 &quot;parser.ml&quot;</span>
<span style="color:red;">               : 'expr))</span>
<span style="color:red;">; (fun __caml_parser_env -&gt;</span>
<span style="color:red;">    let _1 = (Parsing.peek_val __caml_parser_env 2 : 'expr) in</span>
<span style="color:red;">    let _3 = (Parsing.peek_val __caml_parser_env 0 : 'expr) in</span>
<span style="color:red;">    Obj.repr(</span>
<span style="color:red;"># 65 &quot;parser.mly&quot;</span>
<span style="color:red;">                              ( Op (_1,Mul,_3, location()) )</span>
<span style="color:red;"># 447 &quot;parser.ml&quot;</span>
<span style="color:red;">               : 'expr))</span>
<span style="color:red;">; (fun __caml_parser_env -&gt;</span>
<span style="color:red;">    let _1 = (Parsing.peek_val __caml_parser_env 2 : 'expr) in</span>
<span style="color:red;">    let _3 = (Parsing.peek_val __caml_parser_env 0 : 'expr) in</span>
<span style="color:red;">    Obj.repr(</span>
<span style="color:red;"># 66 &quot;parser.mly&quot;</span>
<span style="color:red;">                              ( Op (_1,Div,_3, location()) )</span>
<span style="color:red;"># 455 &quot;parser.ml&quot;</span>
<span style="color:red;">               : 'expr))</span>
<span style="color:red;">; (fun __caml_parser_env -&gt;</span>
<span style="color:red;">    let _1 = (Parsing.peek_val __caml_parser_env 2 : string) in</span>
<span style="color:red;">    let _3 = (Parsing.peek_val __caml_parser_env 0 : 'expr) in</span>
<span style="color:red;">    Obj.repr(</span>
<span style="color:red;"># 67 &quot;parser.mly&quot;</span>
<span style="color:red;">                               ( Atrib (_1,_3, location()) )</span>
<span style="color:red;"># 463 &quot;parser.ml&quot;</span>
<span style="color:red;">               : 'expr))</span>
<span style="color:red;">; (fun __caml_parser_env -&gt;</span>
<span style="color:red;">    let _1 = (Parsing.peek_val __caml_parser_env 2 : 'expr) in</span>
<span style="color:red;">    let _3 = (Parsing.peek_val __caml_parser_env 0 : 'expr) in</span>
<span style="color:red;">    Obj.repr(</span>
<span style="color:red;"># 68 &quot;parser.mly&quot;</span>
<span style="color:red;">                               ( Op (_1, Mic, _3, location()) )</span>
<span style="color:red;"># 471 &quot;parser.ml&quot;</span>
<span style="color:red;">               : 'expr))</span>
<span style="color:red;">; (fun __caml_parser_env -&gt;</span>
<span style="color:red;">    let _1 = (Parsing.peek_val __caml_parser_env 2 : 'expr) in</span>
<span style="color:red;">    let _3 = (Parsing.peek_val __caml_parser_env 0 : 'expr) in</span>
<span style="color:red;">    Obj.repr(</span>
<span style="color:red;"># 69 &quot;parser.mly&quot;</span>
<span style="color:red;">                              ( Op (_1, MicS, _3, location()) )</span>
<span style="color:red;"># 479 &quot;parser.ml&quot;</span>
<span style="color:red;">               : 'expr))</span>
<span style="color:red;">; (fun __caml_parser_env -&gt;</span>
<span style="color:red;">    let _1 = (Parsing.peek_val __caml_parser_env 2 : 'expr) in</span>
<span style="color:red;">    let _3 = (Parsing.peek_val __caml_parser_env 0 : 'expr) in</span>
<span style="color:red;">    Obj.repr(</span>
<span style="color:red;"># 70 &quot;parser.mly&quot;</span>
<span style="color:red;">                               ( Secv (_1,_3, location()) )</span>
<span style="color:red;"># 487 &quot;parser.ml&quot;</span>
<span style="color:red;">               : 'expr))</span>
<span style="color:red;">; (fun __caml_parser_env -&gt;</span>
<span style="color:red;">    let _2 = (Parsing.peek_val __caml_parser_env 4 : 'expr) in</span>
<span style="color:red;">    let _4 = (Parsing.peek_val __caml_parser_env 2 : 'expr) in</span>
<span style="color:red;">    let _6 = (Parsing.peek_val __caml_parser_env 0 : 'expr) in</span>
<span style="color:red;">    Obj.repr(</span>
<span style="color:red;"># 72 &quot;parser.mly&quot;</span>
<span style="color:red;">                               ( If (_2, _4, _6, location()) )</span>
<span style="color:red;"># 496 &quot;parser.ml&quot;</span>
<span style="color:red;">               : 'expr))</span>
<span style="color:red;">; (fun __caml_parser_env -&gt;</span>
<span style="color:red;">    let _2 = (Parsing.peek_val __caml_parser_env 3 : 'expr) in</span>
<span style="color:red;">    let _4 = (Parsing.peek_val __caml_parser_env 1 : 'expr) in</span>
<span style="color:red;">    Obj.repr(</span>
<span style="color:red;"># 73 &quot;parser.mly&quot;</span>
<span style="color:red;">                               ( While (_2, _4, location()) )</span>
<span style="color:red;"># 504 &quot;parser.ml&quot;</span>
<span style="color:red;">               : 'expr))</span>
<span style="color:red;">; (fun __caml_parser_env -&gt;</span>
<span style="color:red;">    let _3 = (Parsing.peek_val __caml_parser_env 6 : 'expr) in</span>
<span style="color:red;">    let _5 = (Parsing.peek_val __caml_parser_env 4 : 'expr) in</span>
<span style="color:red;">    let _7 = (Parsing.peek_val __caml_parser_env 2 : 'expr) in</span>
<span style="color:red;">    let _9 = (Parsing.peek_val __caml_parser_env 0 : 'expr) in</span>
<span style="color:red;">    Obj.repr(</span>
<span style="color:red;"># 75 &quot;parser.mly&quot;</span>
<span style="color:red;">                               ( For (_3, _5, _7, _9, location()) )</span>
<span style="color:red;"># 514 &quot;parser.ml&quot;</span>
<span style="color:red;">               : 'expr))</span>
<span style="color:red;">; (fun __caml_parser_env -&gt;</span>
<span style="color:red;">    let _3 = (Parsing.peek_val __caml_parser_env 5 : string) in</span>
<span style="color:red;">    let _5 = (Parsing.peek_val __caml_parser_env 3 : 'tip) in</span>
<span style="color:red;">    let _8 = (Parsing.peek_val __caml_parser_env 0 : 'expr) in</span>
<span style="color:red;">    Obj.repr(</span>
<span style="color:red;"># 77 &quot;parser.mly&quot;</span>
<span style="color:red;">                               ( Fun (_3, _5, _8, location()) )</span>
<span style="color:red;"># 523 &quot;parser.ml&quot;</span>
<span style="color:red;">               : 'expr))</span>
<span style="color:red;">; (fun __caml_parser_env -&gt;</span>
<span style="color:red;">    let _1 = (Parsing.peek_val __caml_parser_env 1 : 'expr) in</span>
<span style="color:red;">    let _2 = (Parsing.peek_val __caml_parser_env 0 : 'funexpr) in</span>
<span style="color:red;">    Obj.repr(</span>
<span style="color:red;"># 78 &quot;parser.mly&quot;</span>
<span style="color:red;">                               ( App (_1, _2, location()) )</span>
<span style="color:red;"># 531 &quot;parser.ml&quot;</span>
<span style="color:red;">               : 'expr))</span>
<span style="color:red;">; (fun __caml_parser_env -&gt;</span>
<span style="color:red;">    let _1 = (Parsing.peek_val __caml_parser_env 0 : 'funexpr) in</span>
<span style="color:red;">    Obj.repr(</span>
<span style="color:red;"># 79 &quot;parser.mly&quot;</span>
<span style="color:red;">                               ( _1 )</span>
<span style="color:red;"># 538 &quot;parser.ml&quot;</span>
<span style="color:red;">               : 'expr))</span>
<span style="color:red;">; (fun __caml_parser_env -&gt;</span>
<span style="color:red;">    Obj.repr(</span>
<span style="color:red;"># 80 &quot;parser.mly&quot;</span>
<span style="color:red;">                               ( parseError (location ()) )</span>
<span style="color:red;"># 544 &quot;parser.ml&quot;</span>
<span style="color:red;">               : 'expr))</span>
<span style="color:red;">; (fun __caml_parser_env -&gt;</span>
<span style="color:red;">    let _1 = (Parsing.peek_val __caml_parser_env 0 : int) in</span>
<span style="color:red;">    Obj.repr(</span>
<span style="color:red;"># 84 &quot;parser.mly&quot;</span>
<span style="color:red;">                               ( Int (_1,location()) )</span>
<span style="color:red;"># 551 &quot;parser.ml&quot;</span>
<span style="color:red;">               : 'funexpr))</span>
<span style="color:red;">; (fun __caml_parser_env -&gt;</span>
<span style="color:red;">    let _1 = (Parsing.peek_val __caml_parser_env 0 : float) in</span>
<span style="color:red;">    Obj.repr(</span>
<span style="color:red;"># 85 &quot;parser.mly&quot;</span>
<span style="color:red;">                               ( Float (_1,location()) )</span>
<span style="color:red;"># 558 &quot;parser.ml&quot;</span>
<span style="color:red;">               : 'funexpr))</span>
<span style="color:red;">; (fun __caml_parser_env -&gt;</span>
<span style="color:red;">    Obj.repr(</span>
<span style="color:red;"># 86 &quot;parser.mly&quot;</span>
<span style="color:red;">                               ( Bool (true, location()) )</span>
<span style="color:red;"># 564 &quot;parser.ml&quot;</span>
<span style="color:red;">               : 'funexpr))</span>
<span style="color:red;">; (fun __caml_parser_env -&gt;</span>
<span style="color:red;">    Obj.repr(</span>
<span style="color:red;"># 87 &quot;parser.mly&quot;</span>
<span style="color:red;">                               ( Bool (false, location()) )</span>
<span style="color:red;"># 570 &quot;parser.ml&quot;</span>
<span style="color:red;">               : 'funexpr))</span>
<span style="color:red;">; (fun __caml_parser_env -&gt;</span>
<span style="color:red;">    Obj.repr(</span>
<span style="color:red;"># 88 &quot;parser.mly&quot;</span>
<span style="color:red;">                               ( Skip (location()) )</span>
<span style="color:red;"># 576 &quot;parser.ml&quot;</span>
<span style="color:red;">               : 'funexpr))</span>
<span style="color:red;">; (fun __caml_parser_env -&gt;</span>
<span style="color:red;">    let _1 = (Parsing.peek_val __caml_parser_env 0 : string) in</span>
<span style="color:red;">    Obj.repr(</span>
<span style="color:red;"># 89 &quot;parser.mly&quot;</span>
<span style="color:red;">                               ( Var (_1,location()) )</span>
<span style="color:red;"># 583 &quot;parser.ml&quot;</span>
<span style="color:red;">               : 'funexpr))</span>
<span style="color:red;">; (fun __caml_parser_env -&gt;</span>
<span style="color:red;">    Obj.repr(</span>
<span style="color:red;"># 90 &quot;parser.mly&quot;</span>
<span style="color:red;">                               ( IntOfFloat (location()) )</span>
<span style="color:red;"># 589 &quot;parser.ml&quot;</span>
<span style="color:red;">               : 'funexpr))</span>
<span style="color:red;">; (fun __caml_parser_env -&gt;</span>
<span style="color:red;">    Obj.repr(</span>
<span style="color:red;"># 91 &quot;parser.mly&quot;</span>
<span style="color:red;">                               ( FloatOfInt (location()) )</span>
<span style="color:red;"># 595 &quot;parser.ml&quot;</span>
<span style="color:red;">               : 'funexpr))</span>
<span style="color:red;">; (fun __caml_parser_env -&gt;</span>
<span style="color:red;">    Obj.repr(</span>
<span style="color:red;"># 92 &quot;parser.mly&quot;</span>
<span style="color:red;">                               ( Z (location()) )</span>
<span style="color:red;"># 601 &quot;parser.ml&quot;</span>
<span style="color:red;">               : 'funexpr))</span>
<span style="color:red;">; (fun __caml_parser_env -&gt;</span>
<span style="color:red;">    let _2 = (Parsing.peek_val __caml_parser_env 1 : 'expr) in</span>
<span style="color:red;">    Obj.repr(</span>
<span style="color:red;"># 93 &quot;parser.mly&quot;</span>
<span style="color:red;">                               ( _2 )</span>
<span style="color:red;"># 608 &quot;parser.ml&quot;</span>
<span style="color:red;">               : 'funexpr))</span>
<span style="color:red;">; (fun __caml_parser_env -&gt;</span>
<span style="color:red;">    let _2 = (Parsing.peek_val __caml_parser_env 0 : string) in</span>
<span style="color:red;">    Obj.repr(</span>
<span style="color:red;"># 94 &quot;parser.mly&quot;</span>
<span style="color:red;">                               ( Loc (_2, location()) )</span>
<span style="color:red;"># 615 &quot;parser.ml&quot;</span>
<span style="color:red;">               : 'funexpr))</span>
<span style="color:red;">(* Entry main *)</span>
<span style="color:red;">; (fun __caml_parser_env -&gt; raise (Parsing.YYexit (Parsing.peek_val __caml_parser_env 0)))</span>
<span style="color:red;">|]</span>
<span style="color:red;">let yytables =</span>
<span style="color:red;">  { Parsing.actions=yyact;</span>
<span style="color:red;">    Parsing.transl_const=yytransl_const;</span>
<span style="color:red;">    Parsing.transl_block=yytransl_block;</span>
<span style="color:red;">    Parsing.lhs=yylhs;</span>
<span style="color:red;">    Parsing.len=yylen;</span>
<span style="color:red;">    Parsing.defred=yydefred;</span>
<span style="color:red;">    Parsing.dgoto=yydgoto;</span>
<span style="color:red;">    Parsing.sindex=yysindex;</span>
<span style="color:red;">    Parsing.rindex=yyrindex;</span>
<span style="color:red;">    Parsing.gindex=yygindex;</span>
<span style="color:red;">    Parsing.tablesize=yytablesize;</span>
<span style="color:red;">    Parsing.table=yytable;</span>
<span style="color:red;">    Parsing.check=yycheck;</span>
<span style="color:red;">    Parsing.error_function=parse_error;</span>
<span style="color:red;">    Parsing.names_const=yynames_const;</span>
<span style="color:red;">    Parsing.names_block=yynames_block }</span>
<span style="color:red;">let main (lexfun : Lexing.lexbuf -&gt; token) (lexbuf : Lexing.lexbuf) =</span>
<span style="color:red;">   (Parsing.yyparse yytables 1 lexfun lexbuf : ImpAST.expr)</span>
<span style="font-weight:bold;">diff --git a/parser.mli b/parser.mli</span>
<span style="font-weight:bold;">deleted file mode 100644</span>
<span style="font-weight:bold;">index dc1ce7e..0000000</span>
<span style="font-weight:bold;">--- a/parser.mli</span>
<span style="font-weight:bold;">+++ /dev/null</span>
<span style="color:teal;">@@ -1,42 +0,0 @@</span>
<span style="color:red;">type token =</span>
<span style="color:red;">  | Z</span>
<span style="color:red;">  | INT_CAST</span>
<span style="color:red;">  | FLOAT_CAST</span>
<span style="color:red;">  | INT of (int)</span>
<span style="color:red;">  | FLOAT of (float)</span>
<span style="color:red;">  | LOC of (string)</span>
<span style="color:red;">  | VAR of (string)</span>
<span style="color:red;">  | TRUE</span>
<span style="color:red;">  | FALSE</span>
<span style="color:red;">  | SEQ</span>
<span style="color:red;">  | SKIP</span>
<span style="color:red;">  | IF</span>
<span style="color:red;">  | THEN</span>
<span style="color:red;">  | ELSE</span>
<span style="color:red;">  | WHILE</span>
<span style="color:red;">  | DO</span>
<span style="color:red;">  | DONE</span>
<span style="color:red;">  | FOR</span>
<span style="color:red;">  | LT</span>
<span style="color:red;">  | LTE</span>
<span style="color:red;">  | EQ</span>
<span style="color:red;">  | ASGNOP</span>
<span style="color:red;">  | DEREF</span>
<span style="color:red;">  | PLUS</span>
<span style="color:red;">  | MINUS</span>
<span style="color:red;">  | MUL</span>
<span style="color:red;">  | DIV</span>
<span style="color:red;">  | LPAREN</span>
<span style="color:red;">  | RPAREN</span>
<span style="color:red;">  | FUN</span>
<span style="color:red;">  | COLON</span>
<span style="color:red;">  | TINT</span>
<span style="color:red;">  | TBOOL</span>
<span style="color:red;">  | TUNIT</span>
<span style="color:red;">  | TFLOAT</span>
<span style="color:red;">  | ARROW</span>
<span style="color:red;">  | FUNX</span>
<span style="color:red;">  | EOF</span>

<span style="color:red;">val main :</span>
<span style="color:red;">  (Lexing.lexbuf  -&gt; token) -&gt; Lexing.lexbuf -&gt; ImpAST.expr</span>
<span style="font-weight:bold;">diff --git a/semantics.cmi b/semantics.cmi</span>
<span style="font-weight:bold;">deleted file mode 100644</span>
<span style="font-weight:bold;">index f077666..0000000</span>
Binary files a/semantics.cmi and /dev/null differ
<span style="font-weight:bold;">diff --git a/semantics.cmo b/semantics.cmo</span>
<span style="font-weight:bold;">deleted file mode 100644</span>
<span style="font-weight:bold;">index 670d5ee..0000000</span>
Binary files a/semantics.cmo and /dev/null differ
<span style="font-weight:bold;">diff --git a/types.cmi b/types.cmi</span>
<span style="font-weight:bold;">deleted file mode 100644</span>
<span style="font-weight:bold;">index 5315ac4..0000000</span>
Binary files a/types.cmi and /dev/null differ
<span style="font-weight:bold;">diff --git a/types.cmo b/types.cmo</span>
<span style="font-weight:bold;">deleted file mode 100644</span>
<span style="font-weight:bold;">index bae5118..0000000</span>
Binary files a/types.cmo and /dev/null differ

<span style="color:olive;">commit e72794d4873aa3246528c7cf3185707a3ed7ac81</span>
Author: Dragos Calin &lt;calinho_gx1992@yahoo.com&gt;
Date:   Thu Dec 18 18:48:29 2014 +0200

    Working Let - Fix lexer.mll

<span style="font-weight:bold;">diff --git a/lexer.mll b/lexer.mll</span>
<span style="font-weight:bold;">index 8414cf3..49b34e3 100644</span>
<span style="font-weight:bold;">--- a/lexer.mll</span>
<span style="font-weight:bold;">+++ b/lexer.mll</span>
<span style="color:teal;">@@ -30,8 +30,8 @@</span> let keyword_table = Hashtbl.create 20
    List.iter (fun (kwd, tok) -&gt; Hashtbl.add keyword_table kwd tok)
  [
   ( &quot;fun&quot;          , FUN );
   ( <span style="color:red;">&quot;let&quot;)</span><span style="color:green;">&quot;let&quot;</span>          , LET );
   ( &quot;in&quot;<span style="color:red;">)</span>           , IN );
   ( &quot;int&quot;          , TINT );
   ( &quot;bool&quot;         , TBOOL );
   ( &quot;float&quot;        , TFLOAT );

<span style="color:olive;">commit d191e39c87291d9e9bc03dc5194d2638dd5d034e</span>
Author: Dragos Calin &lt;calinho_gx1992@yahoo.com&gt;
Date:   Thu Dec 18 18:27:53 2014 +0200

    Fix Let in impAST.ml

<span style="font-weight:bold;">diff --git a/impAST.ml b/impAST.ml</span>
<span style="font-weight:bold;">index 7cc8b19..b4e0345 100644</span>
<span style="font-weight:bold;">--- a/impAST.ml</span>
<span style="font-weight:bold;">+++ b/impAST.ml</span>
<span style="color:teal;">@@ -51,9 +51,9 @@</span> let exps = function
 | IntOfFloat _ | FloatOfInt _ | Bool _ | Int _ | Float _ 
 | Loc _ | Var _ |DeBruijnVar _ | Skip _ | Z _
   -&gt; []
 | Atrib(_,e,_) | Fun(_,_,e,_) | DeBruijnFun (e,_)<span style="color:red;">| Let(_,_,_,e,_)</span> 
   -&gt; [e]
 | Op(e1,_,e2,_) | Secv(e1,e2,_) | While(e1,e2,_) | App(e1,e2,_) <span style="color:green;">| Let(_,_,e1,e2,_)</span>
   -&gt; [e1;e2]
 | If(e1,e2,e3,_)
   -&gt; [e1;e2;e3]
<span style="color:teal;">@@ -63,7 +63,7 @@</span> let exps = function
let revExps = function
   | (e,[]) -&gt; e
   | (Atrib(l,_,loc),[e]) -&gt; Atrib(l,e,loc)
   | <span style="color:red;">(Let(x,t,_,_,loc),[e1,e2])</span><span style="color:green;">(Let(x,t,_,_,loc),[e1;e2])</span> -&gt; Let(x,t,e1,e2,loc)
   | (Fun(x,t,_,loc),[e]) -&gt; Fun(x,t,e,loc) 
   | (DeBruijnFun(_,loc),[e]) -&gt; DeBruijnFun(e,loc) 
   | (Op(_,op,_,loc),[e1;e2]) -&gt; Op(e1,op,e2,loc) 

<span style="color:olive;">commit 61c13377d55bd09bf5228f09df430cf4d38384ad</span>
Author: Dragos Calin &lt;calinho_gx1992@yahoo.com&gt;
Date:   Thu Dec 18 18:18:28 2014 +0200

    Add Let to types.ml-update_or_add x

<span style="font-weight:bold;">diff --git a/types.ml b/types.ml</span>
<span style="font-weight:bold;">index ea17540..7b3c3cc 100644</span>
<span style="font-weight:bold;">--- a/types.ml</span>
<span style="font-weight:bold;">+++ b/types.ml</span>
<span style="color:teal;">@@ -73,7 +73,7 @@</span> let rec infertype m = function
  | Z _ -&gt; TArrow(TArrow(TArrow(TInt,TInt),TArrow(TInt,TInt)),TArrow(TInt,TInt))
  | Fun (x,t,e,_) -&gt; TArrow(t, infertype (update_or_add (x,Type t) m) e)
  | Let (x,tip,e1,e2,_) 
    -&gt; (match (infertype m e1, infertype <span style="color:red;">m</span><span style="color:green;">(update_or_add (x,Type tip) m)</span> e2) with
     | (t1, t2) when t1 = tip -&gt; t2
     | (t1, t2) -&gt; raise (TypeError (e1, tip, t1))) 


<span style="color:olive;">commit 889351f263c40aad29530c78221521a63941bb78</span>
Author: Dragos Calin &lt;calinho_gx1992@yahoo.com&gt;
Date:   Thu Dec 18 18:14:02 2014 +0200

    Add test file for Let Rec

<span style="font-weight:bold;">diff --git a/programs/test1LetRecTODO.imp b/programs/test1LetRecTODO.imp</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..a0ea710</span>
<span style="font-weight:bold;">--- /dev/null</span>
<span style="font-weight:bold;">+++ b/programs/test1LetRecTODO.imp</span>
<span style="color:teal;">@@ -0,0 +1,2 @@</span>
<span style="color:green;">let rec fib : int -&gt; int = fun (x:int) -&gt; if x &lt;=1 then x else fib (x - 1) + fib (x - 2)</span>
<span style="color:green;">in fib 10</span>

<span style="color:olive;">commit 7192ae2317da4faf7663c575ac0c7907234d28c2</span>
Author: Dragos Calin &lt;calinho_gx1992@yahoo.com&gt;
Date:   Thu Dec 18 13:41:36 2014 +0200

    Add Let in impAST.ml

<span style="font-weight:bold;">diff --git a/impAST.ml b/impAST.ml</span>
<span style="font-weight:bold;">index 807ede4..7cc8b19 100644</span>
<span style="font-weight:bold;">--- a/impAST.ml</span>
<span style="font-weight:bold;">+++ b/impAST.ml</span>
<span style="color:teal;">@@ -43,6 +43,7 @@</span> type expr =
  | While of expr * expr * locatie
  | For of expr * expr * expr * expr * locatie | Skip of locatie
  | Fun of string * tip * expr * locatie
  <span style="color:green;">| Let of string * tip * expr * expr * locatie</span>
  | DeBruijnFun of expr * locatie
  | App of expr * expr * locatie

<span style="color:teal;">@@ -50,7 +51,7 @@</span> let exps = function
 | IntOfFloat _ | FloatOfInt _ | Bool _ | Int _ | Float _ 
 | Loc _ | Var _ |DeBruijnVar _ | Skip _ | Z _
   -&gt; []
 | Atrib(_,e,_) | Fun(_,_,e,_) | DeBruijnFun (e,_) <span style="color:green;">| Let(_,_,_,e,_)</span>
   -&gt; [e]
 | Op(e1,_,e2,_) | Secv(e1,e2,_) | While(e1,e2,_) | App(e1,e2,_)
   -&gt; [e1;e2]
<span style="color:teal;">@@ -62,6 +63,7 @@</span> let exps = function
let revExps = function
   | (e,[]) -&gt; e
   | (Atrib(l,_,loc),[e]) -&gt; Atrib(l,e,loc)
   <span style="color:green;">| (Let(x,t,_,_,loc),[e1,e2]) -&gt; Let(x,t,e1,e2,loc)</span>
   | (Fun(x,t,_,loc),[e]) -&gt; Fun(x,t,e,loc) 
   | (DeBruijnFun(_,loc),[e]) -&gt; DeBruijnFun(e,loc) 
   | (Op(_,op,_,loc),[e1;e2]) -&gt; Op(e1,op,e2,loc) 
<span style="color:teal;">@@ -183,6 +185,8 @@</span> let string_of_expr e =
  | (Secv _,[s1;s2]) -&gt;
    &quot;(&quot; ^ s1 ^ &quot;;\n&quot; ^ s2 ^ &quot;)&quot;
  | (Skip _, _) -&gt; &quot;()&quot;
  <span style="color:green;">| (Let (x,t,_,_,_),[s1;s2]) -&gt;</span>
<span style="color:green;">    &quot;(let &quot; ^ x ^ &quot; : &quot; ^ string_of_tip t ^ &quot; = &quot; ^ s1 ^ &quot; in\n&quot; ^ s2 ^ &quot;\n)&quot;</span>
  | (Fun (x,t,_,_),[s]) -&gt; 
    &quot;(fun (&quot; ^ x ^ &quot;:&quot; ^ string_of_tip t ^ &quot;) -&gt; &quot; ^ s ^ &quot;)&quot;
  | (DeBruijnFun (_,_),[s]) -&gt; 
<span style="color:teal;">@@ -209,6 +213,7 @@</span> let location = function
  | For (_, _, _, _,l)
  | Secv (_,_,l)
  | Skip l 
  <span style="color:green;">| Let (_,_,_,_,l)</span>
  | App (_,_,l)
  | Fun (_,_,_,l)
  | DeBruijnFun (_,l)

<span style="color:olive;">commit 5b48c7b7c547efe1e9e1914f277cb318b1885c49</span>
Author: Dragos Calin &lt;calinho_gx1992@yahoo.com&gt;
Date:   Thu Dec 18 13:26:02 2014 +0200

    Add let to semantics.ml

<span style="font-weight:bold;">diff --git a/semantics.ml b/semantics.ml</span>
<span style="font-weight:bold;">index 8fc0489..a7e59e2 100644</span>
<span style="font-weight:bold;">--- a/semantics.ml</span>
<span style="font-weight:bold;">+++ b/semantics.ml</span>
<span style="color:teal;">@@ -73,6 +73,10 @@</span> let rec reduce = function
  | (App (e1, e2, loc), s) 
     -&gt; (match reduce (e1,s) with Some (e1',s') -&gt; Some (App(e1',e2,loc),s')
      | None -&gt; None)
  <span style="color:green;">| (Let(x,tip,e1,e2,_),s) when is_val e1 -&gt; Some (subst x e1 e2, s)   </span>
<span style="color:green;">  | (Let(x,tip,e1,e2,loc), s)</span>
<span style="color:green;">     -&gt; (match reduce (e1,s) with Some (e1',s') -&gt; Some (Let(x,tip,e1',e2,loc),s')</span>
<span style="color:green;">      | None -&gt; None)</span>

(*  Normal Order
  | (App (Fun(x,_,e1,_),e2,_),s) -&gt; Some (subst x e2 e1, s)

<span style="color:olive;">commit bb754ef26ffd291f835adaf5fb620def426691bb</span>
Author: Dragos Calin &lt;calinho_gx1992@yahoo.com&gt;
Date:   Thu Dec 18 13:25:09 2014 +0200

    Add let to types.ml

<span style="font-weight:bold;">diff --git a/types.ml b/types.ml</span>
<span style="font-weight:bold;">index e4a72c0..ea17540 100644</span>
<span style="font-weight:bold;">--- a/types.ml</span>
<span style="font-weight:bold;">+++ b/types.ml</span>
<span style="color:teal;">@@ -72,6 +72,10 @@</span> let rec infertype m = function
  | FloatOfInt _ -&gt; TArrow(TInt, TFloat)
  | Z _ -&gt; TArrow(TArrow(TArrow(TInt,TInt),TArrow(TInt,TInt)),TArrow(TInt,TInt))
  | Fun (x,t,e,_) -&gt; TArrow(t, infertype (update_or_add (x,Type t) m) e)
  <span style="color:green;">| Let (x,tip,e1,e2,_) </span>
<span style="color:green;">    -&gt; (match (infertype m e1, infertype m e2) with</span>
<span style="color:green;">     | (t1, t2) when t1 = tip -&gt; t2</span>
<span style="color:green;">     | (t1, t2) -&gt; raise (TypeError (e1, tip, t1)))</span> 


let type_check m e = try

<span style="color:olive;">commit 50f7bd6e9c29856b651890e7bcf28f88680a2958</span>
Author: Dragos Calin &lt;calinho_gx1992@yahoo.com&gt;
Date:   Thu Dec 18 12:42:57 2014 +0200

    Add let to parser.mly

<span style="font-weight:bold;">diff --git a/parser.mly b/parser.mly</span>
<span style="font-weight:bold;">index 84fabe2..aae5aff 100644</span>
<span style="font-weight:bold;">--- a/parser.mly</span>
<span style="font-weight:bold;">+++ b/parser.mly</span>
<span style="color:teal;">@@ -29,9 +29,12 @@</span> let parseError loc = raise (Lexer.ParseError loc)
%token PLUS MINUS MUL DIV
%token LPAREN RPAREN
%token FUN COLON
<span style="color:green;">%token EQUAL</span>
<span style="color:green;">%token LET IN</span>
%token TINT TBOOL TUNIT TFLOAT
%token ARROW FUNX
%token EOF
<span style="color:green;">%nonassoc LETX</span> 
%nonassoc FUNX /* lowest precedence */
%right ARROW
%right SEQ
<span style="color:teal;">@@ -75,6 +78,8 @@</span> expr:
                               { For ($3, $5, $7, $9, location()) }
  | FUN LPAREN VAR COLON tip RPAREN ARROW expr %prec FUNX
                               { Fun ($3, $5, $8, location()) }
  <span style="color:green;">| LET VAR COLON tip EQUAL expr IN expr %prec LETX</span>
<span style="color:green;">                               { Let ($2, $4, $6, $8, location()) }</span>                            
  | expr funexpr               { App ($1, $2, location()) }
  | funexpr                    { $1 }
  | error                      { parseError (location ()) }

<span style="color:olive;">commit d776780f6c0602c4c2c0a56a5c95748e00a0c282</span>
Author: Dragos Calin &lt;calinho_gx1992@yahoo.com&gt;
Date:   Thu Dec 18 12:42:33 2014 +0200

    Add let to lexer.mll

<span style="font-weight:bold;">diff --git a/lexer.mll b/lexer.mll</span>
<span style="font-weight:bold;">index d932278..8414cf3 100644</span>
<span style="font-weight:bold;">--- a/lexer.mll</span>
<span style="font-weight:bold;">+++ b/lexer.mll</span>
<span style="color:teal;">@@ -31,6 +31,7 @@</span> let keyword_table = Hashtbl.create 20
  [
   ( &quot;fun&quot;          , FUN );
   ( &quot;let&quot;)         , LET );
   <span style="color:green;">( &quot;in&quot; )         , IN );</span>
   ( &quot;int&quot;          , TINT );
   ( &quot;bool&quot;         , TBOOL );
   ( &quot;float&quot;        , TFLOAT );
<span style="color:teal;">@@ -69,6 +70,7 @@</span> rule token = parse
  | '('            { LPAREN }
  | ')'            { RPAREN }
  | &quot;:=&quot;           { ASGNOP }
  <span style="color:green;">| &quot;=&quot;            { EQUAL }</span>
  | &quot;:&quot;            { COLON }
  | ';'            { SEQ }
 | '!'            { DEREF }

<span style="color:olive;">commit 9fd803fc38186805b6063b3a045f16f2b379aff7</span>
Author: Dragos Calin &lt;calinho_gx1992@yahoo.com&gt;
Date:   Thu Dec 18 11:50:46 2014 +0200

    Add Let in lexer.mll

<span style="font-weight:bold;">diff --git a/lexer.mll b/lexer.mll</span>
<span style="font-weight:bold;">index 22e69a0..d932278 100644</span>
<span style="font-weight:bold;">--- a/lexer.mll</span>
<span style="font-weight:bold;">+++ b/lexer.mll</span>
<span style="color:teal;">@@ -30,6 +30,7 @@</span> let keyword_table = Hashtbl.create 20
    List.iter (fun (kwd, tok) -&gt; Hashtbl.add keyword_table kwd tok)
  [
   ( &quot;fun&quot;          , FUN );
   <span style="color:green;">( &quot;let&quot;)         , LET );</span>
   ( &quot;int&quot;          , TINT );
   ( &quot;bool&quot;         , TBOOL );
   ( &quot;float&quot;        , TFLOAT );

<span style="color:olive;">commit 622194797a1d9be70531d058968ab7f95c9362cc</span>
Author: Dragos Calin &lt;calinho_gx1992@yahoo.com&gt;
Date:   Thu Dec 18 11:26:11 2014 +0200

    Adauaga Evaluare Non-Stricta

<span style="font-weight:bold;">diff --git a/imp.cmi b/imp.cmi</span>
<span style="font-weight:bold;">index c18cbc2..a354758 100644</span>
Binary files a/imp.cmi and b/imp.cmi differ
<span style="font-weight:bold;">diff --git a/imp.cmo b/imp.cmo</span>
<span style="font-weight:bold;">index 3269f3c..7337632 100644</span>
Binary files a/imp.cmo and b/imp.cmo differ
<span style="font-weight:bold;">diff --git a/semantics.cmi b/semantics.cmi</span>
<span style="font-weight:bold;">index 5b2a743..f077666 100644</span>
Binary files a/semantics.cmi and b/semantics.cmi differ
<span style="font-weight:bold;">diff --git a/semantics.cmo b/semantics.cmo</span>
<span style="font-weight:bold;">index 561cb84..670d5ee 100644</span>
Binary files a/semantics.cmo and b/semantics.cmo differ
<span style="font-weight:bold;">diff --git a/semantics.ml b/semantics.ml</span>
<span style="font-weight:bold;">index 4d501bf..8fc0489 100644</span>
<span style="font-weight:bold;">--- a/semantics.ml</span>
<span style="font-weight:bold;">+++ b/semantics.ml</span>
<span style="color:teal;">@@ -62,12 +62,16 @@</span> let rec reduce = function
    -&gt; Some (Float (float_of_int n, loc), s)
  | (App (App(Z loc, g, loc1), v, loc2), s)
    -&gt; Some (App (App (g, App(Z loc, g, loc),loc1), v, loc2), s)
  <span style="color:green;">(*</span> | (App (Fun(x,_,e1,_),e2,_),s) when is_val e2 -&gt; Some (subst x e2 e1, s)
  | (App (e1, e2, loc), s) when is_fun e1
     -&gt; (match reduce (e2,s) with Some (e2',s') -&gt; Some (App(e1,e2',loc),s')
      | None -&gt; None)
  | (App (e1, e2, loc), s) 
     -&gt; (match reduce (e1,s) with Some (e1',s') -&gt; Some (App(e1',e2,loc),s')
      <span style="color:green;">| None -&gt; None) *)</span>
<span style="color:green;">  | (App (Fun(x,_,e1,_),e2,_),s) -&gt; Some (subst x e2 e1, s)</span>
<span style="color:green;">  | (App (e1, e2, loc), s) </span>
<span style="color:green;">     -&gt; (match reduce (e1,s) with Some (e1',s') -&gt; Some (App(e1',e2,loc),s')</span>
      | None -&gt; None)

(*  Normal Order

<span style="color:olive;">commit ae5002ffbc9da19f76f367d7fa938ea0cbbd225a</span>
Author: Dragos Calin &lt;calinho_gx1992@yahoo.com&gt;
Date:   Thu Dec 18 08:56:44 2014 +0200

    Primul commit

<span style="font-weight:bold;">diff --git a/Makefile b/Makefile</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..bf60a91</span>
<span style="font-weight:bold;">--- /dev/null</span>
<span style="font-weight:bold;">+++ b/Makefile</span>
<span style="color:teal;">@@ -0,0 +1,53 @@</span>


<span style="color:green;">all: imp</span>

<span style="color:green;">opt:</span>
<span style="color:green;">	ocamlopt -c impAST.ml</span>
<span style="color:green;">	ocamlyacc parser.mly</span>
<span style="color:green;">	ocamlopt -c parser.mli</span>
<span style="color:green;">	ocamllex lexer.mll</span>
<span style="color:green;">	ocamlopt -c lexer.ml</span>
<span style="color:green;">	ocamlopt -c parser.ml</span>
<span style="color:green;">	ocamlopt -c mem.ml</span>
<span style="color:green;">	ocamlopt -c semantics.ml</span>
<span style="color:green;">	ocamlopt -c types.ml</span>
<span style="color:green;">	ocamlopt -c imp.ml</span>
<span style="color:green;">	ocamlopt -o imp-opt impAST.cmx lexer.cmx parser.cmx mem.cmx semantics.cmx types.cmx imp.cmx</span>

<span style="color:green;">impAST.cmo : impAST.ml</span>
<span style="color:green;">	ocamlc -c impAST.ml</span>

<span style="color:green;">mem.cmo: mem.ml impAST.cmo</span>
<span style="color:green;">	ocamlc -c mem.ml</span>

<span style="color:green;">lexer.ml: lexer.mll parser.cmi</span>
<span style="color:green;">	ocamllex lexer.mll</span>

<span style="color:green;">lexer.cmo: lexer.ml</span>
<span style="color:green;">	ocamlc -c lexer.ml</span>

<span style="color:green;">parser.ml: parser.mly impAST.cmo</span>
<span style="color:green;">	ocamlyacc parser.mly</span>

<span style="color:green;">parser.cmi: parser.ml</span>
<span style="color:green;">	ocamlc -c parser.mli</span>

<span style="color:green;">parser.cmo: parser.ml impAST.cmo</span>
<span style="color:green;">	ocamlc -c parser.ml</span>

<span style="color:green;">types.cmo: types.ml mem.cmo impAST.cmo</span>
<span style="color:green;">	ocamlc -c types.ml</span>

<span style="color:green;">semantics.cmo: semantics.ml mem.cmo impAST.cmo</span>
<span style="color:green;">	ocamlc -c semantics.ml</span>

<span style="color:green;">imp.cmo: imp.ml semantics.cmo types.cmo lexer.cmo</span>
<span style="color:green;">	ocamlc -c imp.ml</span>

<span style="color:green;">imp: impAST.cmo lexer.cmo parser.cmo imp.cmo mem.cmo semantics.cmo types.cmo</span>
<span style="color:green;">	ocamlc -o imp impAST.cmo lexer.cmo parser.cmo mem.cmo semantics.cmo types.cmo imp.cmo</span>

<span style="color:green;">clean:</span>
<span style="color:green;">	rm -f lexer.ml parser.ml parser.mli *.cmo *.cmi imp</span>
<span style="color:green;">	rm -f *.cmx *.o</span>
<span style="font-weight:bold;">diff --git a/compile.bat b/compile.bat</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..5a8b2ef</span>
<span style="font-weight:bold;">--- /dev/null</span>
<span style="font-weight:bold;">+++ b/compile.bat</span>
<span style="color:teal;">@@ -0,0 +1,11 @@</span>
<span style="color:green;">ocamlc -c impAST.ml</span>
<span style="color:green;">ocamlyacc parser.mly</span>
<span style="color:green;">ocamlc -c parser.mli</span>
<span style="color:green;">ocamllex lexer.mll</span>
<span style="color:green;">ocamlc -c lexer.ml</span>
<span style="color:green;">ocamlc -c parser.ml</span>
<span style="color:green;">ocamlc -c mem.ml</span>
<span style="color:green;">ocamlc -c semantics.ml</span>
<span style="color:green;">ocamlc -c types.ml</span>
<span style="color:green;">ocamlc -c imp.ml</span>
<span style="color:green;">ocamlc -o imp.exe impAST.cmo lexer.cmo parser.cmo mem.cmo semantics.cmo types.cmo imp.cmo</span>
<span style="font-weight:bold;">diff --git a/compile.sh b/compile.sh</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..7b01d7e</span>
<span style="font-weight:bold;">--- /dev/null</span>
<span style="font-weight:bold;">+++ b/compile.sh</span>
<span style="color:teal;">@@ -0,0 +1,11 @@</span>
<span style="color:green;">ocamlc -c impAST.ml</span>
<span style="color:green;">ocamlyacc parser.mly</span>
<span style="color:green;">ocamlc -c parser.mli</span>
<span style="color:green;">ocamllex lexer.mll</span>
<span style="color:green;">ocamlc -c lexer.ml</span>
<span style="color:green;">ocamlc -c parser.ml</span>
<span style="color:green;">ocamlc -c mem.ml</span>
<span style="color:green;">ocamlc -c semantics.ml</span>
<span style="color:green;">ocamlc -c types.ml</span>
<span style="color:green;">ocamlc -c imp.ml</span>
<span style="color:green;">ocamlc -o imp impAST.cmo lexer.cmo parser.cmo mem.cmo semantics.cmo types.cmo imp.cmo</span>
<span style="font-weight:bold;">diff --git a/imp.cmi b/imp.cmi</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..c18cbc2</span>
Binary files /dev/null and b/imp.cmi differ
<span style="font-weight:bold;">diff --git a/imp.cmo b/imp.cmo</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..3269f3c</span>
Binary files /dev/null and b/imp.cmo differ
<span style="font-weight:bold;">diff --git a/imp.ml b/imp.ml</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..86220fa</span>
<span style="font-weight:bold;">--- /dev/null</span>
<span style="font-weight:bold;">+++ b/imp.ml</span>
<span style="color:teal;">@@ -0,0 +1,45 @@</span>
<span style="color:green;">open Lexing</span>
<span style="color:green;">open Types</span>
<span style="color:green;">open ImpAST</span>

<span style="color:green;">let is_float_name s = String.length s &gt; 1 &amp;&amp; String.get s 1 = 'f'</span>

<span style="color:green;">let init_type s = if is_float_name s then TFloatRef else TIntRef</span>
<span style="color:green;">let init_val s = if is_float_name s then Float (0., &quot;mem&quot;) else Int (0,&quot;mem&quot;)</span>

<span style="color:green;">let rec init_mtype = function</span>
<span style="color:green;">  | [] -&gt; []</span>
<span style="color:green;">  | h::t -&gt; (h,init_type h)::(init_mtype t)</span>

<span style="color:green;">let rec init_mem = function</span>
<span style="color:green;">  | [] -&gt; []</span>
<span style="color:green;">  | h::t -&gt; (h,init_val h)::(init_mem t)</span>

<span style="color:green;">let type_and_run debug pgm =</span>
<span style="color:green;">  let locs = ImpAST.locations pgm in</span>
<span style="color:green;">      if (type_check  (init_mtype locs) pgm) then begin</span>
<span style="color:green;">          Printf.printf &quot;The program typechecks. Executing...&quot; ;</span>
<span style="color:green;">          if debug then print_newline () else () ;</span>
<span style="color:green;">          flush stdout ;</span>
<span style="color:green;">          let final = (Semantics.evaluate debug (pgm,init_mem locs)) in</span>
<span style="color:green;">            Printf.printf &quot; done.\n Final configuration:\n\n  %s\n\n&quot;</span>
<span style="color:green;">                  (Semantics.string_of_config final)</span>
<span style="color:green;">      end else ()</span>


<span style="color:green;">let cin () =</span>
<span style="color:green;">      if Array.length Sys.argv &gt; 1</span>
<span style="color:green;">      then open_in Sys.argv.(1)</span>
<span style="color:green;">      else failwith &quot;please specify program file&quot;</span>

<span style="color:green;">let _ =</span>
<span style="color:green;">  let lexbuf = Lexing.from_channel (cin ()) in</span>
<span style="color:green;">    lexbuf.lex_curr_p &lt;- { lexbuf.lex_curr_p with pos_fname = Sys.argv.(1) };</span>
<span style="color:green;">    try</span>
<span style="color:green;">      let pgm = Parser.main Lexer.token lexbuf in</span>
<span style="color:green;">       type_and_run (Array.length Sys.argv &gt; 2) pgm</span>
<span style="color:green;">    with</span>
<span style="color:green;">      Lexer.LexerError loc -&gt;</span>
<span style="color:green;">        Printf.eprintf &quot;Lexer Error: Unexpected token '%s' at %s\n&quot; (Lexing.lexeme lexbuf) loc</span>
<span style="color:green;">    | Lexer.ParseError loc -&gt;</span>
<span style="color:green;">        Printf.eprintf &quot;Parse Error: Unexpected token '%s' at %s\n&quot; (Lexing.lexeme lexbuf) loc</span>
<span style="font-weight:bold;">diff --git a/impAST.cmi b/impAST.cmi</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..ad35c4f</span>
Binary files /dev/null and b/impAST.cmi differ
<span style="font-weight:bold;">diff --git a/impAST.cmo b/impAST.cmo</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..66e8533</span>
Binary files /dev/null and b/impAST.cmo differ
<span style="font-weight:bold;">diff --git a/impAST.ml b/impAST.ml</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..807ede4</span>
<span style="font-weight:bold;">--- /dev/null</span>
<span style="font-weight:bold;">+++ b/impAST.ml</span>
<span style="color:teal;">@@ -0,0 +1,223 @@</span>
<span style="color:green;">type locatie = string</span>

<span style="color:green;">type op =</span>
<span style="color:green;">  | Plus</span>
<span style="color:green;">  | Mic</span>
<span style="color:green;">  | Minus</span>
<span style="color:green;">  | Mul</span>
<span style="color:green;">  | Div</span>
<span style="color:green;">  | MicS</span>

<span style="color:green;">let string_of_op = function</span>
<span style="color:green;">  | Plus -&gt; &quot;+&quot;</span>
<span style="color:green;">  | Minus -&gt; &quot;-&quot;</span>
<span style="color:green;">  | Mul -&gt; &quot;*&quot;</span>
<span style="color:green;">  | Div -&gt; &quot;/&quot;</span>
<span style="color:green;">  | MicS -&gt; &quot;&lt;&quot;</span>
<span style="color:green;">  | Mic -&gt; &quot;&lt;=&quot;</span>

<span style="color:green;">let string_of_l s = s</span>

<span style="color:green;">(* types of expressions *)</span>
<span style="color:green;">type tip = TInt | TFloat | TBool | TUnit | TArrow of tip * tip</span>
<span style="color:green;">let rec string_of_tip = function</span>
<span style="color:green;">  | TInt -&gt; &quot;int&quot;</span>
<span style="color:green;">  | TFloat -&gt; &quot;float&quot;</span>
<span style="color:green;">  | TBool -&gt; &quot;bool&quot;</span>
<span style="color:green;">  | TUnit -&gt; &quot;unit&quot;</span>
<span style="color:green;">  | TArrow (t1,t2) -&gt; &quot;(&quot; ^ string_of_tip t1 ^ &quot; -&gt; &quot; ^ string_of_tip t2 ^ &quot;)&quot;</span>


<span style="color:green;">type expr =</span>
<span style="color:green;">  | IntOfFloat of locatie | FloatOfInt of locatie | Z of locatie</span>
<span style="color:green;">  | Bool of bool * locatie</span>
<span style="color:green;">  | Int of int * locatie</span>
<span style="color:green;">  | Float of float * locatie</span>
<span style="color:green;">  | Loc of string * locatie</span>
<span style="color:green;">  | Var of string * locatie</span>
<span style="color:green;">  | DeBruijnVar of int * locatie</span>
<span style="color:green;">  | Op of expr * op * expr * locatie</span>
<span style="color:green;">  | Atrib of string * expr * locatie</span>
<span style="color:green;">  | Secv of expr * expr * locatie</span>
<span style="color:green;">  | If of expr * expr * expr * locatie</span>
<span style="color:green;">  | While of expr * expr * locatie</span>
<span style="color:green;">  | For of expr * expr * expr * expr * locatie | Skip of locatie</span>
<span style="color:green;">  | Fun of string * tip * expr * locatie</span>
<span style="color:green;">  | DeBruijnFun of expr * locatie</span>
<span style="color:green;">  | App of expr * expr * locatie</span>

<span style="color:green;">let exps = function</span>
<span style="color:green;"> | IntOfFloat _ | FloatOfInt _ | Bool _ | Int _ | Float _ </span>
<span style="color:green;"> | Loc _ | Var _ |DeBruijnVar _ | Skip _ | Z _</span>
<span style="color:green;">   -&gt; []</span>
<span style="color:green;"> | Atrib(_,e,_) | Fun(_,_,e,_) | DeBruijnFun (e,_)</span>
<span style="color:green;">   -&gt; [e]</span>
<span style="color:green;"> | Op(e1,_,e2,_) | Secv(e1,e2,_) | While(e1,e2,_) | App(e1,e2,_)</span>
<span style="color:green;">   -&gt; [e1;e2]</span>
<span style="color:green;"> | If(e1,e2,e3,_)</span>
<span style="color:green;">   -&gt; [e1;e2;e3]</span>
<span style="color:green;"> | For(e1,e2,e3,e4,_)</span>
<span style="color:green;">   -&gt; [e1;e2;e3;e4]</span>

<span style="color:green;">let revExps = function</span>
<span style="color:green;">   | (e,[]) -&gt; e</span>
<span style="color:green;">   | (Atrib(l,_,loc),[e]) -&gt; Atrib(l,e,loc)</span>
<span style="color:green;">   | (Fun(x,t,_,loc),[e]) -&gt; Fun(x,t,e,loc) </span>
<span style="color:green;">   | (DeBruijnFun(_,loc),[e]) -&gt; DeBruijnFun(e,loc) </span>
<span style="color:green;">   | (Op(_,op,_,loc),[e1;e2]) -&gt; Op(e1,op,e2,loc) </span>
<span style="color:green;">   | (Secv(_,_,loc),[e1;e2]) -&gt; Secv(e1,e2,loc) </span>
<span style="color:green;">   | (While(_,_,loc),[e1;e2]) -&gt; While(e1,e2,loc) </span>
<span style="color:green;">   | (App(_,_,loc),[e1;e2]) -&gt; App(e1,e2,loc) </span>
<span style="color:green;">   | (If(_,_,_,loc), [e1;e2;e3]) -&gt; If(e1,e2,e3,loc)</span>
<span style="color:green;">   | (For(_,_,_,_,loc), [e1;e2;e3;e4]) -&gt; For(e1,e2,e3,e4,loc)</span>
<span style="color:green;">   | _ -&gt; failwith &quot;this should not happen&quot;</span>
<span style="color:green;"> </span>

<span style="color:green;">type 't preResult = More | Done of 't</span>
<span style="color:green;"> </span>
<span style="color:green;">let rec visit pre post exp = </span>
<span style="color:green;">  match pre exp with</span>
<span style="color:green;">    | More -&gt; post (exp, (List.map (visit pre post) (exps exp)))</span>
<span style="color:green;">    | Done result -&gt; result</span>

<span style="color:green;">let postVisit post = visit (fun e -&gt; More) post</span>

<span style="color:green;">let transform pre post = visit pre (fun p -&gt; post (revExps p))</span>

<span style="color:green;">let rec remove x = function</span>
<span style="color:green;">  | [] -&gt; []</span>
<span style="color:green;">  | h::t when h &lt; x -&gt; h::(remove x t) </span>
<span style="color:green;">  | h::t when h = x -&gt; t</span>
<span style="color:green;">  | l -&gt; l</span>

<span style="color:green;">let union l1 l2 = let rec punion = function</span>
<span style="color:green;">  | ([],l) -&gt; l</span>
<span style="color:green;">  | (l,[]) -&gt; l</span>
<span style="color:green;">  | (h1::t1,h2::t2) when h1=h2 -&gt; h1::punion (t1,t2)</span>
<span style="color:green;">  | (h1::t1,h2::t2) when h1&lt;h2 -&gt; h1::punion (t1,h2::t2)</span>
<span style="color:green;">  | (h1::t1,h2::t2) -&gt; h2::punion (h1::t1,t2)</span>
<span style="color:green;"> in punion (l1,l2)</span>

<span style="color:green;">let var e = </span>
<span style="color:green;">  let var_fold = function</span>
<span style="color:green;">     | (Var (x,_),_) -&gt; [x]</span>
<span style="color:green;">     | (Fun (x,_,_,_),[vs]) -&gt; remove x vs</span>
<span style="color:green;">     | (_,vs_list) -&gt; List.fold_left union [] vs_list</span>
<span style="color:green;">  in postVisit var_fold e</span>

<span style="color:green;">let vars = List.fold_left (fun l1  -&gt; fun (_,(_,l2)) -&gt; union l1 l2) []</span>

<span style="color:green;">let rec free vlist = </span>
<span style="color:green;">  let max = List.fold_left </span>
<span style="color:green;">     (fun m -&gt; fun x -&gt; </span>
<span style="color:green;">       if String.get x 0 &lt;&gt; 'x' </span>
<span style="color:green;">       then m </span>
<span style="color:green;">       else try let m' = int_of_string (String.sub x 1 (String.length x - 1))</span>
<span style="color:green;">            in max m m'</span>
<span style="color:green;">            with Failure _ -&gt; m) 0 vlist </span>
<span style="color:green;">  in &quot;x&quot; ^ (string_of_int (max+1))</span>

<span style="color:green;">let rec invars x = function</span>
<span style="color:green;">  | [] -&gt; false</span>
<span style="color:green;">  | h::t when h &lt; x -&gt; invars x t </span>
<span style="color:green;">  | h::t when h = x -&gt; true</span>
<span style="color:green;">  | _ -&gt; false</span>

<span style="color:green;">let increaseIndexes = List.map (fun (x,n) -&gt; (x,n+1))</span>

<span style="color:green;">let deBruijnify =</span>
<span style="color:green;">  let rec deBruijnify sigma =</span>
<span style="color:green;">    transform </span>
<span style="color:green;">    (function</span>
<span style="color:green;">       | Var (x,l) -&gt; Done (DeBruijnVar (List.assoc x sigma, l))</span>
<span style="color:green;">       | Fun (x,_,e,l) -&gt; Done (DeBruijnFun(deBruijnify ((x,0)::(increaseIndexes sigma)) e, l))</span>
<span style="color:green;">       | _ -&gt; More)</span>
<span style="color:green;">   (fun x -&gt; x)</span>
<span style="color:green;">  in deBruijnify []</span>

<span style="color:green;">let rec deBruijnSubst n e =</span>
<span style="color:green;">  transform </span>
<span style="color:green;">  (function</span>
<span style="color:green;">     | DeBruijnVar (n', l) as v -&gt; Done (if n = n' then e else v)</span>
<span style="color:green;">     | DeBruijnFun(e', l) -&gt; Done (DeBruijnFun(deBruijnSubst (n+1) e e',l))</span>
<span style="color:green;">     | _ -&gt; More)</span>
<span style="color:green;"> (fun x -&gt; x)</span>

<span style="color:green;">let rec substitute sigma = </span>
<span style="color:green;">  transform </span>
<span style="color:green;">  (function </span>
<span style="color:green;">     | Var (x,l) -&gt; (try </span>
<span style="color:green;">                      let (sx,_) = List.assoc x sigma in Done sx </span>
<span style="color:green;">                    with Not_found -&gt; Done (Var (x,l)))</span>
<span style="color:green;">     | Fun (x,t,e,l) </span>
<span style="color:green;">      -&gt; let vs = vars sigma in</span>
<span style="color:green;">           if invars x vs || List.mem_assoc x sigma </span>
<span style="color:green;">           then let x' = free (union vs (var e)) in</span>
<span style="color:green;">                Done (Fun (x',t,(substitute ((x,(Var (x',&quot;new&quot;), [x']))::sigma) e),l))</span>
<span style="color:green;">           else More</span>
<span style="color:green;">     | _ -&gt; More)</span>
<span style="color:green;">  (fun x -&gt; x)</span>


<span style="color:green;">let subst x ex e = substitute [x,(ex, var ex)] e</span>

<span style="color:green;">let string_of_expr e = </span>
<span style="color:green;">  let string_of_expr_fold = function</span>
<span style="color:green;">  | (Z _,_) -&gt; &quot;Z&quot;</span>
<span style="color:green;">  | (IntOfFloat _,_) -&gt; &quot;int_of_float&quot;</span>
<span style="color:green;">  | (FloatOfInt _,_) -&gt; &quot;float_of_int&quot;</span>
<span style="color:green;">  | (Int (i,_),_) -&gt; string_of_int i</span>
<span style="color:green;">  | (Float (f,_),_) -&gt; string_of_float f</span>
<span style="color:green;">  | (Bool (b,_),_) -&gt; string_of_bool b</span>
<span style="color:green;">  | (Loc (s,_),_) -&gt; &quot;!&quot; ^ string_of_l s</span>
<span style="color:green;">  | (Var (s,_),_) -&gt; s</span>
<span style="color:green;">  | (DeBruijnVar (n,_),_) -&gt; &quot;U&quot; ^ string_of_int n</span>
<span style="color:green;">  | (Op (_,b, _,_),[s1;s2]) -&gt; &quot;(&quot; ^ s1 ^ (string_of_op b) ^ s2 ^ &quot;)&quot;</span>
<span style="color:green;">  | (Atrib (s,_,_),[s2]) -&gt; &quot;(&quot; ^ string_of_l s ^ &quot;:=&quot; ^ s2 ^ &quot;)&quot;</span>
<span style="color:green;">  | (If _,[s1;s2;s3]) -&gt;</span>
<span style="color:green;">    &quot;(if &quot; ^ s1 ^ &quot;\nthen &quot; ^ s2 ^ &quot;\nelse &quot; ^ s3 ^ &quot;)&quot;</span>
<span style="color:green;">  | (While _,[s1;s2]) -&gt;</span>
<span style="color:green;">    &quot;while &quot; ^ s1 ^ &quot; do \n&quot; ^ s2 ^ &quot;\ndone&quot;</span>
<span style="color:green;">  | (For _,[s1;s2;s3;s4])</span>
<span style="color:green;">    -&gt; &quot;(for (&quot; ^ s1 ^ &quot;; &quot; ^ s2 ^ &quot;; &quot; ^ s3 ^ &quot;) \n&quot; ^ s4 ^ &quot;\n)&quot;</span>
<span style="color:green;">  | (Secv _,[s1;s2]) -&gt;</span>
<span style="color:green;">    &quot;(&quot; ^ s1 ^ &quot;;\n&quot; ^ s2 ^ &quot;)&quot;</span>
<span style="color:green;">  | (Skip _, _) -&gt; &quot;()&quot;</span>
<span style="color:green;">  | (Fun (x,t,_,_),[s]) -&gt; </span>
<span style="color:green;">    &quot;(fun (&quot; ^ x ^ &quot;:&quot; ^ string_of_tip t ^ &quot;) -&gt; &quot; ^ s ^ &quot;)&quot;</span>
<span style="color:green;">  | (DeBruijnFun (_,_),[s]) -&gt; </span>
<span style="color:green;">    &quot;(fun -&gt; &quot; ^ s ^ &quot;)&quot;</span>
<span style="color:green;">  | (App _, [s1;s2]) -&gt; </span>
<span style="color:green;">    &quot; (&quot; ^ s1 ^ s2 ^ &quot;)&quot;</span>
<span style="color:green;">  | _ -&gt; failwith &quot;This should not happen&quot;</span>
<span style="color:green;">  in postVisit string_of_expr_fold e</span>

<span style="color:green;">let location = function</span>
<span style="color:green;">  | Z l</span>
<span style="color:green;">  | IntOfFloat l</span>
<span style="color:green;">  | FloatOfInt l</span>
<span style="color:green;">  | Int (_,l)</span>
<span style="color:green;">  | Float (_,l)</span>
<span style="color:green;">  | Bool (_,l)</span>
<span style="color:green;">  | Loc (_,l)</span>
<span style="color:green;">  | Var (_,l)</span>
<span style="color:green;">  | DeBruijnVar (_,l)</span>
<span style="color:green;">  | Op (_, _, _,l)</span>
<span style="color:green;">  | Atrib (_,_,l)</span>
<span style="color:green;">  | If (_, _, _,l)</span>
<span style="color:green;">  | While (_, _,l)</span>
<span style="color:green;">  | For (_, _, _, _,l)</span>
<span style="color:green;">  | Secv (_,_,l)</span>
<span style="color:green;">  | Skip l </span>
<span style="color:green;">  | App (_,_,l)</span>
<span style="color:green;">  | Fun (_,_,_,l)</span>
<span style="color:green;">  | DeBruijnFun (_,l)</span>
<span style="color:green;">  -&gt; l</span>

<span style="color:green;">let locations e =</span>
<span style="color:green;">   let locations_fold = function</span>
<span style="color:green;">          | (Loc (l,_),_) -&gt; [l]</span>
<span style="color:green;">          | (Atrib(l,_,_),[locs]) -&gt; union [l] locs</span>
<span style="color:green;">          | (_,locs_list) -&gt; List.fold_left union [] locs_list</span>
<span style="color:green;">    in postVisit locations_fold e</span>

<span style="font-weight:bold;">diff --git a/lexer.cmi b/lexer.cmi</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..dcb0b11</span>
Binary files /dev/null and b/lexer.cmi differ
<span style="font-weight:bold;">diff --git a/lexer.cmo b/lexer.cmo</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..fe0d86f</span>
Binary files /dev/null and b/lexer.cmo differ
<span style="font-weight:bold;">diff --git a/lexer.ml b/lexer.ml</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..288d352</span>
<span style="font-weight:bold;">--- /dev/null</span>
<span style="font-weight:bold;">+++ b/lexer.ml</span>
<span style="color:teal;">@@ -0,0 +1,331 @@</span>
<span style="color:green;"># 2 &quot;lexer.mll&quot;</span>
<span style="color:green;"> </span>
<span style="color:green;">open Parser        (* The type token is defined in parser.mli *)</span>

<span style="color:green;">exception LexerError of string</span>
<span style="color:green;">exception ParseError of string</span>

<span style="color:green;">(*  Code for maintaining line numbers while tokenizing *)</span>

<span style="color:green;">let incr_linenum lexbuf =</span>
<span style="color:green;">      let pos = lexbuf.Lexing.lex_curr_p in</span>
<span style="color:green;">      lexbuf.Lexing.lex_curr_p &lt;- { pos with</span>
<span style="color:green;">        (* incrementing line number *)</span>
<span style="color:green;">        Lexing.pos_lnum = pos.Lexing.pos_lnum + 1;</span>
<span style="color:green;">        (* setting offset for beggining of line *)</span>
<span style="color:green;">        Lexing.pos_bol = pos.Lexing.pos_cnum;</span>
<span style="color:green;">      }</span>

<span style="color:green;">let lex_error lexbuf =</span>
<span style="color:green;">         begin</span>
<span style="color:green;">           let curr = lexbuf.Lexing.lex_curr_p in</span>
<span style="color:green;">           let file = curr.Lexing.pos_fname</span>
<span style="color:green;">           and line = curr.Lexing.pos_lnum</span>
<span style="color:green;">           and cnum = curr.Lexing.pos_cnum - curr.Lexing.pos_bol in</span>
<span style="color:green;">              raise (LexerError (Printf.sprintf &quot;%s:%d.%d&quot; file line cnum))</span>
<span style="color:green;">         end</span>

<span style="color:green;">let keyword_table = Hashtbl.create 20</span>
<span style="color:green;">  let _ =</span>
<span style="color:green;">    List.iter (fun (kwd, tok) -&gt; Hashtbl.add keyword_table kwd tok)</span>
<span style="color:green;">  [</span>
<span style="color:green;">   ( &quot;fun&quot;          , FUN );</span>
<span style="color:green;">   ( &quot;int&quot;          , TINT );</span>
<span style="color:green;">   ( &quot;bool&quot;         , TBOOL );</span>
<span style="color:green;">   ( &quot;float&quot;        , TFLOAT );</span>
<span style="color:green;">   ( &quot;unit&quot;         , TUNIT );</span>
<span style="color:green;">   ( &quot;int_of_float&quot; , INT_CAST );</span>
<span style="color:green;">   ( &quot;float_of_int&quot; , FLOAT_CAST );</span>
<span style="color:green;">   ( &quot;if&quot;           , IF );</span>
<span style="color:green;">   ( &quot;then&quot;         , THEN );</span>
<span style="color:green;">   ( &quot;else&quot;         , ELSE );</span>
<span style="color:green;">   ( &quot;while&quot;        , WHILE );</span>
<span style="color:green;">   ( &quot;do&quot;           , DO );</span>
<span style="color:green;">   ( &quot;done&quot;         , DONE );</span>
<span style="color:green;">   ( &quot;for&quot;          , FOR );</span>
<span style="color:green;">   ( &quot;true&quot;         , TRUE );</span>
<span style="color:green;">   ( &quot;false&quot;        , FALSE );</span>
<span style="color:green;">   ( &quot;Z&quot;            , Z);</span>
<span style="color:green;">]</span>


<span style="color:green;"># 53 &quot;lexer.ml&quot;</span>
<span style="color:green;">let __ocaml_lex_tables = {</span>
<span style="color:green;">  Lexing.lex_base = </span>
<span style="color:green;">   &quot;\000\000\234\255\235\255\075\000\237\255\238\255\000\000\241\255\</span>
<span style="color:green;">    \003\000\001\000\247\255\249\255\152\000\162\000\253\255\016\000\</span>
<span style="color:green;">    \255\255\001\000\254\255\250\255\177\000\244\255\243\255\240\255\</span>
<span style="color:green;">    &quot;;</span>
<span style="color:green;">  Lexing.lex_backtrk = </span>
<span style="color:green;">   &quot;\255\255\255\255\255\255\019\000\255\255\255\255\016\000\255\255\</span>
<span style="color:green;">    \013\000\010\000\255\255\255\255\004\000\007\000\255\255\009\000\</span>
<span style="color:green;">    \255\255\255\255\255\255\255\255\003\000\255\255\255\255\255\255\</span>
<span style="color:green;">    &quot;;</span>
<span style="color:green;">  Lexing.lex_default = </span>
<span style="color:green;">   &quot;\001\000\000\000\000\000\255\255\000\000\000\000\255\255\000\000\</span>
<span style="color:green;">    \255\255\255\255\000\000\000\000\255\255\255\255\000\000\255\255\</span>
<span style="color:green;">    \000\000\017\000\000\000\000\000\255\255\000\000\000\000\000\000\</span>
<span style="color:green;">    &quot;;</span>
<span style="color:green;">  Lexing.lex_trans = </span>
<span style="color:green;">   &quot;\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\014\000\016\000\018\000\000\000\014\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \014\000\004\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \008\000\007\000\010\000\011\000\022\000\013\000\000\000\015\000\</span>
<span style="color:green;">    \012\000\012\000\012\000\012\000\012\000\012\000\012\000\012\000\</span>
<span style="color:green;">    \012\000\012\000\006\000\005\000\009\000\023\000\021\000\017\000\</span>
<span style="color:green;">    \000\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\</span>
<span style="color:green;">    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\</span>
<span style="color:green;">    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\</span>
<span style="color:green;">    \003\000\003\000\003\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\</span>
<span style="color:green;">    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\</span>
<span style="color:green;">    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\</span>
<span style="color:green;">    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\</span>
<span style="color:green;">    \003\000\003\000\003\000\003\000\003\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\003\000\003\000\003\000\003\000\</span>
<span style="color:green;">    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\</span>
<span style="color:green;">    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\</span>
<span style="color:green;">    \003\000\003\000\003\000\003\000\003\000\003\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\003\000\000\000\003\000\003\000\003\000\003\000\</span>
<span style="color:green;">    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\</span>
<span style="color:green;">    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\</span>
<span style="color:green;">    \003\000\003\000\003\000\003\000\003\000\003\000\020\000\000\000\</span>
<span style="color:green;">    \012\000\012\000\012\000\012\000\012\000\012\000\012\000\012\000\</span>
<span style="color:green;">    \012\000\012\000\012\000\012\000\012\000\012\000\012\000\012\000\</span>
<span style="color:green;">    \012\000\012\000\012\000\012\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \019\000\020\000\020\000\020\000\020\000\020\000\020\000\020\000\</span>
<span style="color:green;">    \020\000\020\000\020\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \002\000\018\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000&quot;;</span>
<span style="color:green;">  Lexing.lex_check = </span>
<span style="color:green;">   &quot;\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">    \255\255\000\000\000\000\017\000\255\255\000\000\255\255\255\255\</span>
<span style="color:green;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">    \000\000\000\000\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\008\000\000\000\255\255\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\006\000\009\000\015\000\</span>
<span style="color:green;">    \255\255\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">    \255\255\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\003\000\003\000\003\000\003\000\003\000\</span>
<span style="color:green;">    \003\000\003\000\003\000\003\000\003\000\255\255\255\255\255\255\</span>
<span style="color:green;">    \255\255\255\255\255\255\255\255\003\000\003\000\003\000\003\000\</span>
<span style="color:green;">    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\</span>
<span style="color:green;">    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\</span>
<span style="color:green;">    \003\000\003\000\003\000\003\000\003\000\003\000\255\255\255\255\</span>
<span style="color:green;">    \255\255\255\255\003\000\255\255\003\000\003\000\003\000\003\000\</span>
<span style="color:green;">    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\</span>
<span style="color:green;">    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\</span>
<span style="color:green;">    \003\000\003\000\003\000\003\000\003\000\003\000\012\000\255\255\</span>
<span style="color:green;">    \012\000\012\000\012\000\012\000\012\000\012\000\012\000\012\000\</span>
<span style="color:green;">    \012\000\012\000\013\000\013\000\013\000\013\000\013\000\013\000\</span>
<span style="color:green;">    \013\000\013\000\013\000\013\000\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">    \013\000\020\000\020\000\020\000\020\000\020\000\020\000\020\000\</span>
<span style="color:green;">    \020\000\020\000\020\000\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">    \000\000\017\000\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">    \255\255\255\255&quot;;</span>
<span style="color:green;">  Lexing.lex_base_code = </span>
<span style="color:green;">   &quot;&quot;;</span>
<span style="color:green;">  Lexing.lex_backtrk_code = </span>
<span style="color:green;">   &quot;&quot;;</span>
<span style="color:green;">  Lexing.lex_default_code = </span>
<span style="color:green;">   &quot;&quot;;</span>
<span style="color:green;">  Lexing.lex_trans_code = </span>
<span style="color:green;">   &quot;&quot;;</span>
<span style="color:green;">  Lexing.lex_check_code = </span>
<span style="color:green;">   &quot;&quot;;</span>
<span style="color:green;">  Lexing.lex_code = </span>
<span style="color:green;">   &quot;&quot;;</span>
<span style="color:green;">}</span>

<span style="color:green;">let rec token lexbuf =</span>
<span style="color:green;">    __ocaml_lex_token_rec lexbuf 0</span>
<span style="color:green;">and __ocaml_lex_token_rec lexbuf __ocaml_lex_state =</span>
<span style="color:green;">  match Lexing.engine __ocaml_lex_tables __ocaml_lex_state lexbuf with</span>
<span style="color:green;">      | 0 -&gt;</span>
<span style="color:green;"># 54 &quot;lexer.mll&quot;</span>
<span style="color:green;">             ( incr_linenum lexbuf ; token lexbuf )</span>
<span style="color:green;"># 203 &quot;lexer.ml&quot;</span>

<span style="color:green;">  | 1 -&gt;</span>
<span style="color:green;"># 55 &quot;lexer.mll&quot;</span>
<span style="color:green;">                                   ( incr_linenum lexbuf ; token lexbuf )</span>
<span style="color:green;"># 208 &quot;lexer.ml&quot;</span>

<span style="color:green;">  | 2 -&gt;</span>
<span style="color:green;"># 57 &quot;lexer.mll&quot;</span>
<span style="color:green;">                         ( token lexbuf )</span>
<span style="color:green;"># 213 &quot;lexer.ml&quot;</span>

<span style="color:green;">  | 3 -&gt;</span>
<span style="color:green;">let</span>
<span style="color:green;"># 58 &quot;lexer.mll&quot;</span>
<span style="color:green;">                                       lxm</span>
<span style="color:green;"># 219 &quot;lexer.ml&quot;</span>
<span style="color:green;">= Lexing.sub_lexeme lexbuf lexbuf.Lexing.lex_start_pos lexbuf.Lexing.lex_curr_pos in</span>
<span style="color:green;"># 58 &quot;lexer.mll&quot;</span>
<span style="color:green;">                                           ( FLOAT(float_of_string lxm) )</span>
<span style="color:green;"># 223 &quot;lexer.ml&quot;</span>

<span style="color:green;">  | 4 -&gt;</span>
<span style="color:green;">let</span>
<span style="color:green;"># 59 &quot;lexer.mll&quot;</span>
<span style="color:green;">                        lxm</span>
<span style="color:green;"># 229 &quot;lexer.ml&quot;</span>
<span style="color:green;">= Lexing.sub_lexeme lexbuf lexbuf.Lexing.lex_start_pos lexbuf.Lexing.lex_curr_pos in</span>
<span style="color:green;"># 59 &quot;lexer.mll&quot;</span>
<span style="color:green;">                            ( INT(int_of_string lxm) )</span>
<span style="color:green;"># 233 &quot;lexer.ml&quot;</span>

<span style="color:green;">  | 5 -&gt;</span>
<span style="color:green;"># 60 &quot;lexer.mll&quot;</span>
<span style="color:green;">                   ( ARROW )</span>
<span style="color:green;"># 238 &quot;lexer.ml&quot;</span>

<span style="color:green;">  | 6 -&gt;</span>
<span style="color:green;"># 61 &quot;lexer.mll&quot;</span>
<span style="color:green;">                   ( PLUS )</span>
<span style="color:green;"># 243 &quot;lexer.ml&quot;</span>

<span style="color:green;">  | 7 -&gt;</span>
<span style="color:green;"># 62 &quot;lexer.mll&quot;</span>
<span style="color:green;">                   ( MINUS )</span>
<span style="color:green;"># 248 &quot;lexer.ml&quot;</span>

<span style="color:green;">  | 8 -&gt;</span>
<span style="color:green;"># 63 &quot;lexer.mll&quot;</span>
<span style="color:green;">                   ( MUL )</span>
<span style="color:green;"># 253 &quot;lexer.ml&quot;</span>

<span style="color:green;">  | 9 -&gt;</span>
<span style="color:green;"># 64 &quot;lexer.mll&quot;</span>
<span style="color:green;">                   ( DIV )</span>
<span style="color:green;"># 258 &quot;lexer.ml&quot;</span>

<span style="color:green;">  | 10 -&gt;</span>
<span style="color:green;"># 65 &quot;lexer.mll&quot;</span>
<span style="color:green;">                   ( LT )</span>
<span style="color:green;"># 263 &quot;lexer.ml&quot;</span>

<span style="color:green;">  | 11 -&gt;</span>
<span style="color:green;"># 66 &quot;lexer.mll&quot;</span>
<span style="color:green;">                   ( LTE )</span>
<span style="color:green;"># 268 &quot;lexer.ml&quot;</span>

<span style="color:green;">  | 12 -&gt;</span>
<span style="color:green;"># 67 &quot;lexer.mll&quot;</span>
<span style="color:green;">                   ( SKIP )</span>
<span style="color:green;"># 273 &quot;lexer.ml&quot;</span>

<span style="color:green;">  | 13 -&gt;</span>
<span style="color:green;"># 68 &quot;lexer.mll&quot;</span>
<span style="color:green;">                   ( LPAREN )</span>
<span style="color:green;"># 278 &quot;lexer.ml&quot;</span>

<span style="color:green;">  | 14 -&gt;</span>
<span style="color:green;"># 69 &quot;lexer.mll&quot;</span>
<span style="color:green;">                   ( RPAREN )</span>
<span style="color:green;"># 283 &quot;lexer.ml&quot;</span>

<span style="color:green;">  | 15 -&gt;</span>
<span style="color:green;"># 70 &quot;lexer.mll&quot;</span>
<span style="color:green;">                   ( ASGNOP )</span>
<span style="color:green;"># 288 &quot;lexer.ml&quot;</span>

<span style="color:green;">  | 16 -&gt;</span>
<span style="color:green;"># 71 &quot;lexer.mll&quot;</span>
<span style="color:green;">                   ( COLON )</span>
<span style="color:green;"># 293 &quot;lexer.ml&quot;</span>

<span style="color:green;">  | 17 -&gt;</span>
<span style="color:green;"># 72 &quot;lexer.mll&quot;</span>
<span style="color:green;">                   ( SEQ )</span>
<span style="color:green;"># 298 &quot;lexer.ml&quot;</span>

<span style="color:green;">  | 18 -&gt;</span>
<span style="color:green;"># 73 &quot;lexer.mll&quot;</span>
<span style="color:green;">                  ( DEREF )</span>
<span style="color:green;"># 303 &quot;lexer.ml&quot;</span>

<span style="color:green;">  | 19 -&gt;</span>
<span style="color:green;">let</span>
<span style="color:green;"># 74 &quot;lexer.mll&quot;</span>
<span style="color:green;">                                                         id</span>
<span style="color:green;"># 309 &quot;lexer.ml&quot;</span>
<span style="color:green;">= Lexing.sub_lexeme lexbuf lexbuf.Lexing.lex_start_pos lexbuf.Lexing.lex_curr_pos in</span>
<span style="color:green;"># 75 &quot;lexer.mll&quot;</span>
<span style="color:green;">                   ( try Hashtbl.find keyword_table id </span>
<span style="color:green;">                     with Not_found -&gt; </span>
<span style="color:green;">                       if String.get id 0 = 'l' </span>
<span style="color:green;">                       then LOC(id) </span>
<span style="color:green;">                       else VAR(id) )</span>
<span style="color:green;"># 317 &quot;lexer.ml&quot;</span>

<span style="color:green;">  | 20 -&gt;</span>
<span style="color:green;"># 80 &quot;lexer.mll&quot;</span>
<span style="color:green;">                   ( EOF )</span>
<span style="color:green;"># 322 &quot;lexer.ml&quot;</span>

<span style="color:green;">  | 21 -&gt;</span>
<span style="color:green;"># 81 &quot;lexer.mll&quot;</span>
<span style="color:green;">                   ( lex_error lexbuf )</span>
<span style="color:green;"># 327 &quot;lexer.ml&quot;</span>

<span style="color:green;">  | __ocaml_lex_state -&gt; lexbuf.Lexing.refill_buff lexbuf; __ocaml_lex_token_rec lexbuf __ocaml_lex_state</span>

<span style="color:green;">;;</span>

<span style="font-weight:bold;">diff --git a/lexer.mll b/lexer.mll</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..22e69a0</span>
<span style="font-weight:bold;">--- /dev/null</span>
<span style="font-weight:bold;">+++ b/lexer.mll</span>
<span style="color:teal;">@@ -0,0 +1,81 @@</span>
<span style="color:green;">(* File lexer.mll *)</span>
<span style="color:green;">{</span>
<span style="color:green;">open Parser        (* The type token is defined in parser.mli *)</span>

<span style="color:green;">exception LexerError of string</span>
<span style="color:green;">exception ParseError of string</span>

<span style="color:green;">(*  Code for maintaining line numbers while tokenizing *)</span>

<span style="color:green;">let incr_linenum lexbuf =</span>
<span style="color:green;">      let pos = lexbuf.Lexing.lex_curr_p in</span>
<span style="color:green;">      lexbuf.Lexing.lex_curr_p &lt;- { pos with</span>
<span style="color:green;">        (* incrementing line number *)</span>
<span style="color:green;">        Lexing.pos_lnum = pos.Lexing.pos_lnum + 1;</span>
<span style="color:green;">        (* setting offset for beggining of line *)</span>
<span style="color:green;">        Lexing.pos_bol = pos.Lexing.pos_cnum;</span>
<span style="color:green;">      }</span>

<span style="color:green;">let lex_error lexbuf =</span>
<span style="color:green;">         begin</span>
<span style="color:green;">           let curr = lexbuf.Lexing.lex_curr_p in</span>
<span style="color:green;">           let file = curr.Lexing.pos_fname</span>
<span style="color:green;">           and line = curr.Lexing.pos_lnum</span>
<span style="color:green;">           and cnum = curr.Lexing.pos_cnum - curr.Lexing.pos_bol in</span>
<span style="color:green;">              raise (LexerError (Printf.sprintf &quot;%s:%d.%d&quot; file line cnum))</span>
<span style="color:green;">         end</span>

<span style="color:green;">let keyword_table = Hashtbl.create 20</span>
<span style="color:green;">  let _ =</span>
<span style="color:green;">    List.iter (fun (kwd, tok) -&gt; Hashtbl.add keyword_table kwd tok)</span>
<span style="color:green;">  [</span>
<span style="color:green;">   ( &quot;fun&quot;          , FUN );</span>
<span style="color:green;">   ( &quot;int&quot;          , TINT );</span>
<span style="color:green;">   ( &quot;bool&quot;         , TBOOL );</span>
<span style="color:green;">   ( &quot;float&quot;        , TFLOAT );</span>
<span style="color:green;">   ( &quot;unit&quot;         , TUNIT );</span>
<span style="color:green;">   ( &quot;int_of_float&quot; , INT_CAST );</span>
<span style="color:green;">   ( &quot;float_of_int&quot; , FLOAT_CAST );</span>
<span style="color:green;">   ( &quot;if&quot;           , IF );</span>
<span style="color:green;">   ( &quot;then&quot;         , THEN );</span>
<span style="color:green;">   ( &quot;else&quot;         , ELSE );</span>
<span style="color:green;">   ( &quot;while&quot;        , WHILE );</span>
<span style="color:green;">   ( &quot;do&quot;           , DO );</span>
<span style="color:green;">   ( &quot;done&quot;         , DONE );</span>
<span style="color:green;">   ( &quot;for&quot;          , FOR );</span>
<span style="color:green;">   ( &quot;true&quot;         , TRUE );</span>
<span style="color:green;">   ( &quot;false&quot;        , FALSE );</span>
<span style="color:green;">   ( &quot;Z&quot;            , Z);</span>
<span style="color:green;">]</span>

<span style="color:green;">}</span>

<span style="color:green;">rule token = parse</span>
<span style="color:green;">    [ '\n' ] { incr_linenum lexbuf ; token lexbuf } (* count lines *)</span>
<span style="color:green;">  | ['/']['/'][^'\n']*(['\n']|eof) { incr_linenum lexbuf ; token lexbuf }</span>
<span style="color:green;">                                    (* skip line comments but count lines *)</span>
<span style="color:green;">  | [' ' '\t' '\r' ]     { token lexbuf }     (* skip blanks *)</span>
<span style="color:green;">  | ['-']?['0'-'9']+['.']['0'-'9']* as lxm { FLOAT(float_of_string lxm) }</span>
<span style="color:green;">  | ['-']?['0'-'9']+ as lxm { INT(int_of_string lxm) }</span>
<span style="color:green;">  | &quot;-&gt;&quot;           { ARROW }</span>
<span style="color:green;">  | '+'            { PLUS }</span>
<span style="color:green;">  | '-'            { MINUS }</span>
<span style="color:green;">  | '*'            { MUL }</span>
<span style="color:green;">  | '/'            { DIV }</span>
<span style="color:green;">  | '&lt;'            { LT }</span>
<span style="color:green;">  | &quot;&lt;=&quot;           { LTE }</span>
<span style="color:green;">  | &quot;()&quot;           { SKIP }  </span>
<span style="color:green;">  | '('            { LPAREN }</span>
<span style="color:green;">  | ')'            { RPAREN }</span>
<span style="color:green;">  | &quot;:=&quot;           { ASGNOP }</span>
<span style="color:green;">  | &quot;:&quot;            { COLON }</span>
<span style="color:green;">  | ';'            { SEQ }</span>
<span style="color:green;"> | '!'            { DEREF }</span>
<span style="color:green;">  | ['A'-'Z' 'a'-'z'] ['A'-'Z' 'a'-'z' '0'-'9' '_'] * as id</span>
<span style="color:green;">                   { try Hashtbl.find keyword_table id </span>
<span style="color:green;">                     with Not_found -&gt; </span>
<span style="color:green;">                       if String.get id 0 = 'l' </span>
<span style="color:green;">                       then LOC(id) </span>
<span style="color:green;">                       else VAR(id) }</span>
<span style="color:green;">  | eof            { EOF }</span>
<span style="color:green;">  | _              { lex_error lexbuf }</span>
<span style="font-weight:bold;">diff --git a/mem.cmi b/mem.cmi</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..57de7ae</span>
Binary files /dev/null and b/mem.cmi differ
<span style="font-weight:bold;">diff --git a/mem.cmo b/mem.cmo</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..da71a72</span>
Binary files /dev/null and b/mem.cmo differ
<span style="font-weight:bold;">diff --git a/mem.ml b/mem.ml</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..1363834</span>
<span style="font-weight:bold;">--- /dev/null</span>
<span style="font-weight:bold;">+++ b/mem.ml</span>
<span style="color:teal;">@@ -0,0 +1,15 @@</span>
<span style="color:green;">let lookup = List.assoc</span>

<span style="color:green;">let rec update (x,n) = function</span>
<span style="color:green;">  | [] -&gt; raise Not_found</span>
<span style="color:green;">  | (y,v)::s  when x=y -&gt; ((x,n)::s)</span>
<span style="color:green;">  | h::t -&gt; h::(update (x,n) t)</span>

<span style="color:green;">let update_or_add (x,v) m = (x,v)::List.remove_assoc x m</span>

<span style="color:green;">let string_of_mem = </span>
<span style="color:green;">  let string_of_pair (x,v) = x ^ &quot; |-&gt; &quot; ^ ImpAST.string_of_expr v in</span>
<span style="color:green;">  let rec string_of_mem str = function</span>
<span style="color:green;">  | [] -&gt; str</span>
<span style="color:green;">  | p::t -&gt; string_of_mem (str ^ &quot;; &quot; ^ string_of_pair p) t</span>
<span style="color:green;">  in function [] -&gt; &quot;&quot; | p::t -&gt; string_of_mem (string_of_pair p) t</span>
<span style="font-weight:bold;">diff --git a/parser.cmi b/parser.cmi</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..bd1ce53</span>
Binary files /dev/null and b/parser.cmi differ
<span style="font-weight:bold;">diff --git a/parser.cmo b/parser.cmo</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..2309a2e</span>
Binary files /dev/null and b/parser.cmo differ
<span style="font-weight:bold;">diff --git a/parser.ml b/parser.ml</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..d2bc143</span>
<span style="font-weight:bold;">--- /dev/null</span>
<span style="font-weight:bold;">+++ b/parser.ml</span>
<span style="color:teal;">@@ -0,0 +1,637 @@</span>
<span style="color:green;">type token =</span>
<span style="color:green;">  | Z</span>
<span style="color:green;">  | INT_CAST</span>
<span style="color:green;">  | FLOAT_CAST</span>
<span style="color:green;">  | INT of (int)</span>
<span style="color:green;">  | FLOAT of (float)</span>
<span style="color:green;">  | LOC of (string)</span>
<span style="color:green;">  | VAR of (string)</span>
<span style="color:green;">  | TRUE</span>
<span style="color:green;">  | FALSE</span>
<span style="color:green;">  | SEQ</span>
<span style="color:green;">  | SKIP</span>
<span style="color:green;">  | IF</span>
<span style="color:green;">  | THEN</span>
<span style="color:green;">  | ELSE</span>
<span style="color:green;">  | WHILE</span>
<span style="color:green;">  | DO</span>
<span style="color:green;">  | DONE</span>
<span style="color:green;">  | FOR</span>
<span style="color:green;">  | LT</span>
<span style="color:green;">  | LTE</span>
<span style="color:green;">  | EQ</span>
<span style="color:green;">  | ASGNOP</span>
<span style="color:green;">  | DEREF</span>
<span style="color:green;">  | PLUS</span>
<span style="color:green;">  | MINUS</span>
<span style="color:green;">  | MUL</span>
<span style="color:green;">  | DIV</span>
<span style="color:green;">  | LPAREN</span>
<span style="color:green;">  | RPAREN</span>
<span style="color:green;">  | FUN</span>
<span style="color:green;">  | COLON</span>
<span style="color:green;">  | TINT</span>
<span style="color:green;">  | TBOOL</span>
<span style="color:green;">  | TUNIT</span>
<span style="color:green;">  | TFLOAT</span>
<span style="color:green;">  | ARROW</span>
<span style="color:green;">  | FUNX</span>
<span style="color:green;">  | EOF</span>

<span style="color:green;">open Parsing;;</span>
<span style="color:green;">let _ = parse_error;;</span>
<span style="color:green;"># 3 &quot;parser.mly&quot;</span>
<span style="color:green;">open ImpAST</span>
<span style="color:green;">open Lexing</span>

<span style="color:green;">let location () =  let start_pos = Parsing.symbol_start_pos () in</span>
<span style="color:green;">    let end_pos = Parsing.symbol_end_pos () in</span>
<span style="color:green;">    Printf.sprintf &quot;%s:%d.%d-%d.%d&quot;</span>
<span style="color:green;">      start_pos.pos_fname</span>
<span style="color:green;">      start_pos.pos_lnum (start_pos.pos_cnum - start_pos.pos_bol)</span>
<span style="color:green;">      end_pos.pos_lnum (end_pos.pos_cnum - end_pos.pos_bol)</span>

<span style="color:green;">let parseError loc = raise (Lexer.ParseError loc)</span>

<span style="color:green;"># 57 &quot;parser.ml&quot;</span>
<span style="color:green;">let yytransl_const = [|</span>
<span style="color:green;">  257 (* Z *);</span>
<span style="color:green;">  258 (* INT_CAST *);</span>
<span style="color:green;">  259 (* FLOAT_CAST *);</span>
<span style="color:green;">  264 (* TRUE *);</span>
<span style="color:green;">  265 (* FALSE *);</span>
<span style="color:green;">  266 (* SEQ *);</span>
<span style="color:green;">  267 (* SKIP *);</span>
<span style="color:green;">  268 (* IF *);</span>
<span style="color:green;">  269 (* THEN *);</span>
<span style="color:green;">  270 (* ELSE *);</span>
<span style="color:green;">  271 (* WHILE *);</span>
<span style="color:green;">  272 (* DO *);</span>
<span style="color:green;">  273 (* DONE *);</span>
<span style="color:green;">  274 (* FOR *);</span>
<span style="color:green;">  275 (* LT *);</span>
<span style="color:green;">  276 (* LTE *);</span>
<span style="color:green;">  277 (* EQ *);</span>
<span style="color:green;">  278 (* ASGNOP *);</span>
<span style="color:green;">  279 (* DEREF *);</span>
<span style="color:green;">  280 (* PLUS *);</span>
<span style="color:green;">  281 (* MINUS *);</span>
<span style="color:green;">  282 (* MUL *);</span>
<span style="color:green;">  283 (* DIV *);</span>
<span style="color:green;">  284 (* LPAREN *);</span>
<span style="color:green;">  285 (* RPAREN *);</span>
<span style="color:green;">  286 (* FUN *);</span>
<span style="color:green;">  287 (* COLON *);</span>
<span style="color:green;">  288 (* TINT *);</span>
<span style="color:green;">  289 (* TBOOL *);</span>
<span style="color:green;">  290 (* TUNIT *);</span>
<span style="color:green;">  291 (* TFLOAT *);</span>
<span style="color:green;">  292 (* ARROW *);</span>
<span style="color:green;">  293 (* FUNX *);</span>
<span style="color:green;">    0 (* EOF *);</span>
<span style="color:green;">    0|]</span>

<span style="color:green;">let yytransl_block = [|</span>
<span style="color:green;">  260 (* INT *);</span>
<span style="color:green;">  261 (* FLOAT *);</span>
<span style="color:green;">  262 (* LOC *);</span>
<span style="color:green;">  263 (* VAR *);</span>
<span style="color:green;">    0|]</span>

<span style="color:green;">let yylhs = &quot;\255\255\</span>
<span style="color:green;">\001\000\003\000\003\000\003\000\003\000\003\000\003\000\002\000\</span>
<span style="color:green;">\002\000\002\000\002\000\002\000\002\000\002\000\002\000\002\000\</span>
<span style="color:green;">\002\000\002\000\002\000\002\000\002\000\002\000\004\000\004\000\</span>
<span style="color:green;">\004\000\004\000\004\000\004\000\004\000\004\000\004\000\004\000\</span>
<span style="color:green;">\004\000\000\000&quot;</span>

<span style="color:green;">let yylen = &quot;\002\000\</span>
<span style="color:green;">\002\000\001\000\001\000\001\000\001\000\003\000\003\000\003\000\</span>
<span style="color:green;">\003\000\003\000\003\000\003\000\003\000\003\000\003\000\006\000\</span>
<span style="color:green;">\005\000\009\000\008\000\002\000\001\000\001\000\001\000\001\000\</span>
<span style="color:green;">\001\000\001\000\001\000\001\000\001\000\001\000\001\000\003\000\</span>
<span style="color:green;">\002\000\002\000&quot;</span>

<span style="color:green;">let yydefred = &quot;\000\000\</span>
<span style="color:green;">\000\000\000\000\022\000\031\000\029\000\030\000\023\000\024\000\</span>
<span style="color:green;">\000\000\028\000\025\000\026\000\027\000\000\000\000\000\000\000\</span>
<span style="color:green;">\000\000\000\000\000\000\034\000\000\000\021\000\000\000\000\000\</span>
<span style="color:green;">\000\000\000\000\033\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">\000\000\000\000\000\000\000\000\001\000\020\000\000\000\000\000\</span>
<span style="color:green;">\000\000\000\000\032\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">\017\000\000\000\000\000\002\000\003\000\004\000\005\000\000\000\</span>
<span style="color:green;">\000\000\000\000\000\000\000\000\000\000\000\000\007\000\000\000\</span>
<span style="color:green;">\000\000\000\000\000\000\000\000&quot;</span>

<span style="color:green;">let yydgoto = &quot;\002\000\</span>
<span style="color:green;">\020\000\021\000\064\000\022\000&quot;</span>

<span style="color:green;">let yysindex = &quot;\002\000\</span>
<span style="color:green;">\152\255\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">\240\254\000\000\000\000\000\000\000\000\152\255\152\255\239\254\</span>
<span style="color:green;">\006\255\152\255\243\254\000\000\141\000\000\000\152\255\169\000\</span>
<span style="color:green;">\197\000\152\255\000\000\182\255\010\255\152\255\152\255\152\255\</span>
<span style="color:green;">\152\255\152\255\152\255\152\255\000\000\000\000\137\001\152\255\</span>
<span style="color:green;">\152\255\025\001\000\000\252\254\053\001\137\001\137\001\252\255\</span>
<span style="color:green;">\252\255\241\255\241\255\225\000\253\000\152\255\000\255\152\255\</span>
<span style="color:green;">\000\000\081\001\000\255\000\000\000\000\000\000\000\000\229\254\</span>
<span style="color:green;">\109\001\152\255\234\254\238\254\000\255\211\255\000\000\152\255\</span>
<span style="color:green;">\249\254\152\255\053\001\109\001&quot;</span>

<span style="color:green;">let yyrindex = &quot;\000\000\</span>
<span style="color:green;">\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">\000\000\000\000\000\000\000\000\000\000\000\000\071\000\000\000\</span>
<span style="color:green;">\000\000\000\000\000\000\000\000\107\000\079\000\088\000\037\000\</span>
<span style="color:green;">\054\000\001\000\019\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">\093\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">\007\255\000\000\112\000\102\000&quot;</span>

<span style="color:green;">let yygindex = &quot;\000\000\</span>
<span style="color:green;">\000\000\246\255\197\255\075\000&quot;</span>

<span style="color:green;">let yytablesize = 677</span>
<span style="color:green;">let yytable = &quot;\067\000\</span>
<span style="color:green;">\010\000\068\000\001\000\024\000\025\000\023\000\071\000\028\000\</span>
<span style="color:green;">\069\000\073\000\026\000\027\000\039\000\069\000\029\000\042\000\</span>
<span style="color:green;">\044\000\072\000\011\000\045\000\046\000\047\000\048\000\049\000\</span>
<span style="color:green;">\050\000\051\000\055\000\059\000\069\000\052\000\053\000\060\000\</span>
<span style="color:green;">\061\000\062\000\063\000\006\000\008\000\000\000\000\000\000\000\</span>
<span style="color:green;">\000\000\000\000\000\000\058\000\000\000\065\000\000\000\000\000\</span>
<span style="color:green;">\000\000\000\000\000\000\000\000\000\000\009\000\000\000\070\000\</span>
<span style="color:green;">\000\000\000\000\000\000\000\000\000\000\075\000\000\000\076\000\</span>
<span style="color:green;">\000\000\000\000\000\000\000\000\000\000\000\000\012\000\000\000\</span>
<span style="color:green;">\000\000\000\000\000\000\000\000\000\000\000\000\014\000\000\000\</span>
<span style="color:green;">\000\000\000\000\000\000\000\000\000\000\000\000\000\000\013\000\</span>
<span style="color:green;">\000\000\000\000\000\000\000\000\016\000\000\000\000\000\038\000\</span>
<span style="color:green;">\000\000\000\000\038\000\038\000\000\000\018\000\038\000\000\000\</span>
<span style="color:green;">\000\000\000\000\015\000\000\000\000\000\000\000\000\000\019\000\</span>
<span style="color:green;">\000\000\038\000\000\000\000\000\038\000\000\000\000\000\038\000\</span>
<span style="color:green;">\038\000\038\000\038\000\038\000\038\000\038\000\038\000\038\000\</span>
<span style="color:green;">\000\000\000\000\000\000\000\000\038\000\000\000\000\000\000\000\</span>
<span style="color:green;">\000\000\000\000\000\000\038\000\037\000\000\000\000\000\000\000\</span>
<span style="color:green;">\038\000\000\000\000\000\000\000\000\000\038\000\038\000\003\000\</span>
<span style="color:green;">\004\000\005\000\006\000\007\000\008\000\009\000\010\000\011\000\</span>
<span style="color:green;">\012\000\000\000\013\000\014\000\000\000\000\000\015\000\000\000\</span>
<span style="color:green;">\000\000\016\000\000\000\000\000\000\000\000\000\017\000\000\000\</span>
<span style="color:green;">\000\000\000\000\000\000\018\000\000\000\019\000\004\000\005\000\</span>
<span style="color:green;">\006\000\007\000\008\000\000\000\010\000\011\000\012\000\030\000\</span>
<span style="color:green;">\013\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">\031\000\032\000\000\000\000\000\017\000\033\000\034\000\035\000\</span>
<span style="color:green;">\036\000\018\000\043\000\004\000\005\000\006\000\007\000\008\000\</span>
<span style="color:green;">\000\000\010\000\011\000\012\000\030\000\013\000\000\000\000\000\</span>
<span style="color:green;">\000\000\000\000\000\000\000\000\000\000\031\000\032\000\000\000\</span>
<span style="color:green;">\000\000\017\000\033\000\034\000\035\000\036\000\018\000\074\000\</span>
<span style="color:green;">\000\000\004\000\005\000\006\000\007\000\008\000\000\000\010\000\</span>
<span style="color:green;">\011\000\012\000\000\000\013\000\004\000\005\000\006\000\007\000\</span>
<span style="color:green;">\008\000\000\000\010\000\011\000\012\000\000\000\013\000\017\000\</span>
<span style="color:green;">\000\000\000\000\010\000\000\000\018\000\010\000\010\000\000\000\</span>
<span style="color:green;">\010\000\010\000\017\000\010\000\010\000\035\000\036\000\018\000\</span>
<span style="color:green;">\010\000\010\000\010\000\010\000\011\000\010\000\000\000\011\000\</span>
<span style="color:green;">\011\000\000\000\011\000\011\000\000\000\011\000\011\000\000\000\</span>
<span style="color:green;">\000\000\000\000\011\000\011\000\011\000\011\000\008\000\011\000\</span>
<span style="color:green;">\000\000\008\000\008\000\000\000\008\000\008\000\000\000\008\000\</span>
<span style="color:green;">\008\000\000\000\000\000\000\000\008\000\008\000\000\000\009\000\</span>
<span style="color:green;">\000\000\008\000\009\000\009\000\000\000\009\000\009\000\000\000\</span>
<span style="color:green;">\009\000\009\000\000\000\000\000\000\000\009\000\009\000\000\000\</span>
<span style="color:green;">\012\000\000\000\009\000\012\000\012\000\000\000\012\000\012\000\</span>
<span style="color:green;">\014\000\012\000\012\000\014\000\014\000\000\000\014\000\014\000\</span>
<span style="color:green;">\000\000\013\000\000\000\012\000\013\000\013\000\016\000\013\000\</span>
<span style="color:green;">\013\000\016\000\016\000\014\000\016\000\016\000\000\000\018\000\</span>
<span style="color:green;">\000\000\000\000\018\000\018\000\013\000\018\000\018\000\015\000\</span>
<span style="color:green;">\015\000\016\000\015\000\015\000\019\000\019\000\000\000\019\000\</span>
<span style="color:green;">\019\000\000\000\018\000\000\000\000\000\000\000\000\000\015\000\</span>
<span style="color:green;">\000\000\000\000\000\000\000\000\019\000\004\000\005\000\006\000\</span>
<span style="color:green;">\007\000\008\000\000\000\010\000\011\000\012\000\030\000\013\000\</span>
<span style="color:green;">\000\000\000\000\000\000\000\000\000\000\000\000\000\000\031\000\</span>
<span style="color:green;">\032\000\000\000\000\000\017\000\033\000\034\000\035\000\036\000\</span>
<span style="color:green;">\018\000\004\000\005\000\006\000\007\000\008\000\000\000\010\000\</span>
<span style="color:green;">\011\000\012\000\030\000\013\000\000\000\040\000\000\000\000\000\</span>
<span style="color:green;">\000\000\000\000\000\000\031\000\032\000\000\000\000\000\017\000\</span>
<span style="color:green;">\033\000\034\000\035\000\036\000\018\000\004\000\005\000\006\000\</span>
<span style="color:green;">\007\000\008\000\000\000\010\000\011\000\012\000\030\000\013\000\</span>
<span style="color:green;">\000\000\000\000\000\000\000\000\041\000\000\000\000\000\031\000\</span>
<span style="color:green;">\032\000\000\000\000\000\017\000\033\000\034\000\035\000\036\000\</span>
<span style="color:green;">\018\000\004\000\005\000\006\000\007\000\008\000\000\000\010\000\</span>
<span style="color:green;">\011\000\012\000\030\000\013\000\000\000\000\000\056\000\000\000\</span>
<span style="color:green;">\000\000\000\000\000\000\031\000\032\000\000\000\000\000\017\000\</span>
<span style="color:green;">\033\000\034\000\035\000\036\000\018\000\004\000\005\000\006\000\</span>
<span style="color:green;">\007\000\008\000\000\000\010\000\011\000\012\000\030\000\013\000\</span>
<span style="color:green;">\000\000\000\000\000\000\000\000\000\000\057\000\000\000\031\000\</span>
<span style="color:green;">\032\000\000\000\000\000\017\000\033\000\034\000\035\000\036\000\</span>
<span style="color:green;">\018\000\004\000\005\000\006\000\007\000\008\000\000\000\010\000\</span>
<span style="color:green;">\011\000\012\000\054\000\013\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">\000\000\000\000\000\000\031\000\032\000\000\000\000\000\017\000\</span>
<span style="color:green;">\033\000\034\000\035\000\036\000\018\000\004\000\005\000\006\000\</span>
<span style="color:green;">\007\000\008\000\000\000\010\000\011\000\012\000\030\000\013\000\</span>
<span style="color:green;">\000\000\000\000\000\000\000\000\000\000\000\000\000\000\031\000\</span>
<span style="color:green;">\032\000\000\000\000\000\017\000\033\000\034\000\035\000\036\000\</span>
<span style="color:green;">\018\000\004\000\005\000\006\000\007\000\008\000\000\000\010\000\</span>
<span style="color:green;">\011\000\012\000\066\000\013\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">\000\000\000\000\000\000\031\000\032\000\000\000\000\000\017\000\</span>
<span style="color:green;">\033\000\034\000\035\000\036\000\018\000\004\000\005\000\006\000\</span>
<span style="color:green;">\007\000\008\000\000\000\010\000\011\000\012\000\000\000\013\000\</span>
<span style="color:green;">\000\000\000\000\000\000\000\000\000\000\000\000\000\000\031\000\</span>
<span style="color:green;">\032\000\000\000\000\000\017\000\033\000\034\000\035\000\036\000\</span>
<span style="color:green;">\018\000\004\000\005\000\006\000\007\000\008\000\000\000\010\000\</span>
<span style="color:green;">\011\000\012\000\000\000\013\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">\000\000\000\000\000\000\000\000\000\000\000\000\000\000\017\000\</span>
<span style="color:green;">\033\000\034\000\035\000\036\000\018\000&quot;</span>

<span style="color:green;">let yycheck = &quot;\059\000\</span>
<span style="color:green;">\000\000\029\001\001\000\014\000\015\000\022\001\029\001\018\000\</span>
<span style="color:green;">\036\001\069\000\028\001\006\001\023\000\036\001\028\001\026\000\</span>
<span style="color:green;">\007\001\036\001\000\000\030\000\031\000\032\000\033\000\034\000\</span>
<span style="color:green;">\035\000\036\000\031\001\028\001\036\001\040\000\041\000\032\001\</span>
<span style="color:green;">\033\001\034\001\035\001\029\001\000\000\255\255\255\255\255\255\</span>
<span style="color:green;">\255\255\255\255\255\255\054\000\255\255\056\000\255\255\255\255\</span>
<span style="color:green;">\255\255\255\255\255\255\255\255\255\255\000\000\255\255\066\000\</span>
<span style="color:green;">\255\255\255\255\255\255\255\255\255\255\072\000\255\255\074\000\</span>
<span style="color:green;">\255\255\255\255\255\255\255\255\255\255\255\255\000\000\255\255\</span>
<span style="color:green;">\255\255\255\255\255\255\255\255\255\255\255\255\000\000\255\255\</span>
<span style="color:green;">\255\255\255\255\255\255\255\255\255\255\255\255\255\255\000\000\</span>
<span style="color:green;">\255\255\255\255\255\255\255\255\000\000\255\255\255\255\021\000\</span>
<span style="color:green;">\255\255\255\255\024\000\025\000\255\255\000\000\028\000\255\255\</span>
<span style="color:green;">\255\255\255\255\000\000\255\255\255\255\255\255\255\255\000\000\</span>
<span style="color:green;">\255\255\039\000\255\255\255\255\042\000\255\255\255\255\045\000\</span>
<span style="color:green;">\046\000\047\000\048\000\049\000\050\000\051\000\052\000\053\000\</span>
<span style="color:green;">\255\255\255\255\255\255\255\255\058\000\255\255\255\255\255\255\</span>
<span style="color:green;">\255\255\255\255\255\255\065\000\000\000\255\255\255\255\255\255\</span>
<span style="color:green;">\070\000\255\255\255\255\255\255\255\255\075\000\076\000\000\001\</span>
<span style="color:green;">\001\001\002\001\003\001\004\001\005\001\006\001\007\001\008\001\</span>
<span style="color:green;">\009\001\255\255\011\001\012\001\255\255\255\255\015\001\255\255\</span>
<span style="color:green;">\255\255\018\001\255\255\255\255\255\255\255\255\023\001\255\255\</span>
<span style="color:green;">\255\255\255\255\255\255\028\001\255\255\030\001\001\001\002\001\</span>
<span style="color:green;">\003\001\004\001\005\001\255\255\007\001\008\001\009\001\010\001\</span>
<span style="color:green;">\011\001\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">\019\001\020\001\255\255\255\255\023\001\024\001\025\001\026\001\</span>
<span style="color:green;">\027\001\028\001\029\001\001\001\002\001\003\001\004\001\005\001\</span>
<span style="color:green;">\255\255\007\001\008\001\009\001\010\001\011\001\255\255\255\255\</span>
<span style="color:green;">\255\255\255\255\255\255\255\255\255\255\019\001\020\001\255\255\</span>
<span style="color:green;">\255\255\023\001\024\001\025\001\026\001\027\001\028\001\029\001\</span>
<span style="color:green;">\255\255\001\001\002\001\003\001\004\001\005\001\255\255\007\001\</span>
<span style="color:green;">\008\001\009\001\255\255\011\001\001\001\002\001\003\001\004\001\</span>
<span style="color:green;">\005\001\255\255\007\001\008\001\009\001\255\255\011\001\023\001\</span>
<span style="color:green;">\255\255\255\255\010\001\255\255\028\001\013\001\014\001\255\255\</span>
<span style="color:green;">\016\001\017\001\023\001\019\001\020\001\026\001\027\001\028\001\</span>
<span style="color:green;">\024\001\025\001\026\001\027\001\010\001\029\001\255\255\013\001\</span>
<span style="color:green;">\014\001\255\255\016\001\017\001\255\255\019\001\020\001\255\255\</span>
<span style="color:green;">\255\255\255\255\024\001\025\001\026\001\027\001\010\001\029\001\</span>
<span style="color:green;">\255\255\013\001\014\001\255\255\016\001\017\001\255\255\019\001\</span>
<span style="color:green;">\020\001\255\255\255\255\255\255\024\001\025\001\255\255\010\001\</span>
<span style="color:green;">\255\255\029\001\013\001\014\001\255\255\016\001\017\001\255\255\</span>
<span style="color:green;">\019\001\020\001\255\255\255\255\255\255\024\001\025\001\255\255\</span>
<span style="color:green;">\010\001\255\255\029\001\013\001\014\001\255\255\016\001\017\001\</span>
<span style="color:green;">\010\001\019\001\020\001\013\001\014\001\255\255\016\001\017\001\</span>
<span style="color:green;">\255\255\010\001\255\255\029\001\013\001\014\001\010\001\016\001\</span>
<span style="color:green;">\017\001\013\001\014\001\029\001\016\001\017\001\255\255\010\001\</span>
<span style="color:green;">\255\255\255\255\013\001\014\001\029\001\016\001\017\001\013\001\</span>
<span style="color:green;">\014\001\029\001\016\001\017\001\013\001\014\001\255\255\016\001\</span>
<span style="color:green;">\017\001\255\255\029\001\255\255\255\255\255\255\255\255\029\001\</span>
<span style="color:green;">\255\255\255\255\255\255\255\255\029\001\001\001\002\001\003\001\</span>
<span style="color:green;">\004\001\005\001\255\255\007\001\008\001\009\001\010\001\011\001\</span>
<span style="color:green;">\255\255\255\255\255\255\255\255\255\255\255\255\255\255\019\001\</span>
<span style="color:green;">\020\001\255\255\255\255\023\001\024\001\025\001\026\001\027\001\</span>
<span style="color:green;">\028\001\001\001\002\001\003\001\004\001\005\001\255\255\007\001\</span>
<span style="color:green;">\008\001\009\001\010\001\011\001\255\255\013\001\255\255\255\255\</span>
<span style="color:green;">\255\255\255\255\255\255\019\001\020\001\255\255\255\255\023\001\</span>
<span style="color:green;">\024\001\025\001\026\001\027\001\028\001\001\001\002\001\003\001\</span>
<span style="color:green;">\004\001\005\001\255\255\007\001\008\001\009\001\010\001\011\001\</span>
<span style="color:green;">\255\255\255\255\255\255\255\255\016\001\255\255\255\255\019\001\</span>
<span style="color:green;">\020\001\255\255\255\255\023\001\024\001\025\001\026\001\027\001\</span>
<span style="color:green;">\028\001\001\001\002\001\003\001\004\001\005\001\255\255\007\001\</span>
<span style="color:green;">\008\001\009\001\010\001\011\001\255\255\255\255\014\001\255\255\</span>
<span style="color:green;">\255\255\255\255\255\255\019\001\020\001\255\255\255\255\023\001\</span>
<span style="color:green;">\024\001\025\001\026\001\027\001\028\001\001\001\002\001\003\001\</span>
<span style="color:green;">\004\001\005\001\255\255\007\001\008\001\009\001\010\001\011\001\</span>
<span style="color:green;">\255\255\255\255\255\255\255\255\255\255\017\001\255\255\019\001\</span>
<span style="color:green;">\020\001\255\255\255\255\023\001\024\001\025\001\026\001\027\001\</span>
<span style="color:green;">\028\001\001\001\002\001\003\001\004\001\005\001\255\255\007\001\</span>
<span style="color:green;">\008\001\009\001\010\001\011\001\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">\255\255\255\255\255\255\019\001\020\001\255\255\255\255\023\001\</span>
<span style="color:green;">\024\001\025\001\026\001\027\001\028\001\001\001\002\001\003\001\</span>
<span style="color:green;">\004\001\005\001\255\255\007\001\008\001\009\001\010\001\011\001\</span>
<span style="color:green;">\255\255\255\255\255\255\255\255\255\255\255\255\255\255\019\001\</span>
<span style="color:green;">\020\001\255\255\255\255\023\001\024\001\025\001\026\001\027\001\</span>
<span style="color:green;">\028\001\001\001\002\001\003\001\004\001\005\001\255\255\007\001\</span>
<span style="color:green;">\008\001\009\001\010\001\011\001\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">\255\255\255\255\255\255\019\001\020\001\255\255\255\255\023\001\</span>
<span style="color:green;">\024\001\025\001\026\001\027\001\028\001\001\001\002\001\003\001\</span>
<span style="color:green;">\004\001\005\001\255\255\007\001\008\001\009\001\255\255\011\001\</span>
<span style="color:green;">\255\255\255\255\255\255\255\255\255\255\255\255\255\255\019\001\</span>
<span style="color:green;">\020\001\255\255\255\255\023\001\024\001\025\001\026\001\027\001\</span>
<span style="color:green;">\028\001\001\001\002\001\003\001\004\001\005\001\255\255\007\001\</span>
<span style="color:green;">\008\001\009\001\255\255\011\001\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">\255\255\255\255\255\255\255\255\255\255\255\255\255\255\023\001\</span>
<span style="color:green;">\024\001\025\001\026\001\027\001\028\001&quot;</span>

<span style="color:green;">let yynames_const = &quot;\</span>
<span style="color:green;">  Z\000\</span>
<span style="color:green;">  INT_CAST\000\</span>
<span style="color:green;">  FLOAT_CAST\000\</span>
<span style="color:green;">  TRUE\000\</span>
<span style="color:green;">  FALSE\000\</span>
<span style="color:green;">  SEQ\000\</span>
<span style="color:green;">  SKIP\000\</span>
<span style="color:green;">  IF\000\</span>
<span style="color:green;">  THEN\000\</span>
<span style="color:green;">  ELSE\000\</span>
<span style="color:green;">  WHILE\000\</span>
<span style="color:green;">  DO\000\</span>
<span style="color:green;">  DONE\000\</span>
<span style="color:green;">  FOR\000\</span>
<span style="color:green;">  LT\000\</span>
<span style="color:green;">  LTE\000\</span>
<span style="color:green;">  EQ\000\</span>
<span style="color:green;">  ASGNOP\000\</span>
<span style="color:green;">  DEREF\000\</span>
<span style="color:green;">  PLUS\000\</span>
<span style="color:green;">  MINUS\000\</span>
<span style="color:green;">  MUL\000\</span>
<span style="color:green;">  DIV\000\</span>
<span style="color:green;">  LPAREN\000\</span>
<span style="color:green;">  RPAREN\000\</span>
<span style="color:green;">  FUN\000\</span>
<span style="color:green;">  COLON\000\</span>
<span style="color:green;">  TINT\000\</span>
<span style="color:green;">  TBOOL\000\</span>
<span style="color:green;">  TUNIT\000\</span>
<span style="color:green;">  TFLOAT\000\</span>
<span style="color:green;">  ARROW\000\</span>
<span style="color:green;">  FUNX\000\</span>
<span style="color:green;">  EOF\000\</span>
<span style="color:green;">  &quot;</span>

<span style="color:green;">let yynames_block = &quot;\</span>
<span style="color:green;">  INT\000\</span>
<span style="color:green;">  FLOAT\000\</span>
<span style="color:green;">  LOC\000\</span>
<span style="color:green;">  VAR\000\</span>
<span style="color:green;">  &quot;</span>

<span style="color:green;">let yyact = [|</span>
<span style="color:green;">  (fun _ -&gt; failwith &quot;parser&quot;)</span>
<span style="color:green;">; (fun __caml_parser_env -&gt;</span>
<span style="color:green;">    let _1 = (Parsing.peek_val __caml_parser_env 1 : 'expr) in</span>
<span style="color:green;">    Obj.repr(</span>
<span style="color:green;"># 51 &quot;parser.mly&quot;</span>
<span style="color:green;">                            ( _1 )</span>
<span style="color:green;"># 384 &quot;parser.ml&quot;</span>
<span style="color:green;">               : ImpAST.expr))</span>
<span style="color:green;">; (fun __caml_parser_env -&gt;</span>
<span style="color:green;">    Obj.repr(</span>
<span style="color:green;"># 55 &quot;parser.mly&quot;</span>
<span style="color:green;">                               (TInt)</span>
<span style="color:green;"># 390 &quot;parser.ml&quot;</span>
<span style="color:green;">               : 'tip))</span>
<span style="color:green;">; (fun __caml_parser_env -&gt;</span>
<span style="color:green;">    Obj.repr(</span>
<span style="color:green;"># 56 &quot;parser.mly&quot;</span>
<span style="color:green;">                               (TBool)</span>
<span style="color:green;"># 396 &quot;parser.ml&quot;</span>
<span style="color:green;">               : 'tip))</span>
<span style="color:green;">; (fun __caml_parser_env -&gt;</span>
<span style="color:green;">    Obj.repr(</span>
<span style="color:green;"># 57 &quot;parser.mly&quot;</span>
<span style="color:green;">                               (TUnit)</span>
<span style="color:green;"># 402 &quot;parser.ml&quot;</span>
<span style="color:green;">               : 'tip))</span>
<span style="color:green;">; (fun __caml_parser_env -&gt;</span>
<span style="color:green;">    Obj.repr(</span>
<span style="color:green;"># 58 &quot;parser.mly&quot;</span>
<span style="color:green;">                               (TFloat)</span>
<span style="color:green;"># 408 &quot;parser.ml&quot;</span>
<span style="color:green;">               : 'tip))</span>
<span style="color:green;">; (fun __caml_parser_env -&gt;</span>
<span style="color:green;">    let _1 = (Parsing.peek_val __caml_parser_env 2 : 'tip) in</span>
<span style="color:green;">    let _3 = (Parsing.peek_val __caml_parser_env 0 : 'tip) in</span>
<span style="color:green;">    Obj.repr(</span>
<span style="color:green;"># 59 &quot;parser.mly&quot;</span>
<span style="color:green;">                               ( TArrow (_1, _3) )</span>
<span style="color:green;"># 416 &quot;parser.ml&quot;</span>
<span style="color:green;">               : 'tip))</span>
<span style="color:green;">; (fun __caml_parser_env -&gt;</span>
<span style="color:green;">    let _2 = (Parsing.peek_val __caml_parser_env 1 : 'tip) in</span>
<span style="color:green;">    Obj.repr(</span>
<span style="color:green;"># 60 &quot;parser.mly&quot;</span>
<span style="color:green;">                               ( _2 )</span>
<span style="color:green;"># 423 &quot;parser.ml&quot;</span>
<span style="color:green;">               : 'tip))</span>
<span style="color:green;">; (fun __caml_parser_env -&gt;</span>
<span style="color:green;">    let _1 = (Parsing.peek_val __caml_parser_env 2 : 'expr) in</span>
<span style="color:green;">    let _3 = (Parsing.peek_val __caml_parser_env 0 : 'expr) in</span>
<span style="color:green;">    Obj.repr(</span>
<span style="color:green;"># 63 &quot;parser.mly&quot;</span>
<span style="color:green;">                               ( Op (_1,Plus,_3, location()) )</span>
<span style="color:green;"># 431 &quot;parser.ml&quot;</span>
<span style="color:green;">               : 'expr))</span>
<span style="color:green;">; (fun __caml_parser_env -&gt;</span>
<span style="color:green;">    let _1 = (Parsing.peek_val __caml_parser_env 2 : 'expr) in</span>
<span style="color:green;">    let _3 = (Parsing.peek_val __caml_parser_env 0 : 'expr) in</span>
<span style="color:green;">    Obj.repr(</span>
<span style="color:green;"># 64 &quot;parser.mly&quot;</span>
<span style="color:green;">                                ( Op (_1,Minus,_3, location()) )</span>
<span style="color:green;"># 439 &quot;parser.ml&quot;</span>
<span style="color:green;">               : 'expr))</span>
<span style="color:green;">; (fun __caml_parser_env -&gt;</span>
<span style="color:green;">    let _1 = (Parsing.peek_val __caml_parser_env 2 : 'expr) in</span>
<span style="color:green;">    let _3 = (Parsing.peek_val __caml_parser_env 0 : 'expr) in</span>
<span style="color:green;">    Obj.repr(</span>
<span style="color:green;"># 65 &quot;parser.mly&quot;</span>
<span style="color:green;">                              ( Op (_1,Mul,_3, location()) )</span>
<span style="color:green;"># 447 &quot;parser.ml&quot;</span>
<span style="color:green;">               : 'expr))</span>
<span style="color:green;">; (fun __caml_parser_env -&gt;</span>
<span style="color:green;">    let _1 = (Parsing.peek_val __caml_parser_env 2 : 'expr) in</span>
<span style="color:green;">    let _3 = (Parsing.peek_val __caml_parser_env 0 : 'expr) in</span>
<span style="color:green;">    Obj.repr(</span>
<span style="color:green;"># 66 &quot;parser.mly&quot;</span>
<span style="color:green;">                              ( Op (_1,Div,_3, location()) )</span>
<span style="color:green;"># 455 &quot;parser.ml&quot;</span>
<span style="color:green;">               : 'expr))</span>
<span style="color:green;">; (fun __caml_parser_env -&gt;</span>
<span style="color:green;">    let _1 = (Parsing.peek_val __caml_parser_env 2 : string) in</span>
<span style="color:green;">    let _3 = (Parsing.peek_val __caml_parser_env 0 : 'expr) in</span>
<span style="color:green;">    Obj.repr(</span>
<span style="color:green;"># 67 &quot;parser.mly&quot;</span>
<span style="color:green;">                               ( Atrib (_1,_3, location()) )</span>
<span style="color:green;"># 463 &quot;parser.ml&quot;</span>
<span style="color:green;">               : 'expr))</span>
<span style="color:green;">; (fun __caml_parser_env -&gt;</span>
<span style="color:green;">    let _1 = (Parsing.peek_val __caml_parser_env 2 : 'expr) in</span>
<span style="color:green;">    let _3 = (Parsing.peek_val __caml_parser_env 0 : 'expr) in</span>
<span style="color:green;">    Obj.repr(</span>
<span style="color:green;"># 68 &quot;parser.mly&quot;</span>
<span style="color:green;">                               ( Op (_1, Mic, _3, location()) )</span>
<span style="color:green;"># 471 &quot;parser.ml&quot;</span>
<span style="color:green;">               : 'expr))</span>
<span style="color:green;">; (fun __caml_parser_env -&gt;</span>
<span style="color:green;">    let _1 = (Parsing.peek_val __caml_parser_env 2 : 'expr) in</span>
<span style="color:green;">    let _3 = (Parsing.peek_val __caml_parser_env 0 : 'expr) in</span>
<span style="color:green;">    Obj.repr(</span>
<span style="color:green;"># 69 &quot;parser.mly&quot;</span>
<span style="color:green;">                              ( Op (_1, MicS, _3, location()) )</span>
<span style="color:green;"># 479 &quot;parser.ml&quot;</span>
<span style="color:green;">               : 'expr))</span>
<span style="color:green;">; (fun __caml_parser_env -&gt;</span>
<span style="color:green;">    let _1 = (Parsing.peek_val __caml_parser_env 2 : 'expr) in</span>
<span style="color:green;">    let _3 = (Parsing.peek_val __caml_parser_env 0 : 'expr) in</span>
<span style="color:green;">    Obj.repr(</span>
<span style="color:green;"># 70 &quot;parser.mly&quot;</span>
<span style="color:green;">                               ( Secv (_1,_3, location()) )</span>
<span style="color:green;"># 487 &quot;parser.ml&quot;</span>
<span style="color:green;">               : 'expr))</span>
<span style="color:green;">; (fun __caml_parser_env -&gt;</span>
<span style="color:green;">    let _2 = (Parsing.peek_val __caml_parser_env 4 : 'expr) in</span>
<span style="color:green;">    let _4 = (Parsing.peek_val __caml_parser_env 2 : 'expr) in</span>
<span style="color:green;">    let _6 = (Parsing.peek_val __caml_parser_env 0 : 'expr) in</span>
<span style="color:green;">    Obj.repr(</span>
<span style="color:green;"># 72 &quot;parser.mly&quot;</span>
<span style="color:green;">                               ( If (_2, _4, _6, location()) )</span>
<span style="color:green;"># 496 &quot;parser.ml&quot;</span>
<span style="color:green;">               : 'expr))</span>
<span style="color:green;">; (fun __caml_parser_env -&gt;</span>
<span style="color:green;">    let _2 = (Parsing.peek_val __caml_parser_env 3 : 'expr) in</span>
<span style="color:green;">    let _4 = (Parsing.peek_val __caml_parser_env 1 : 'expr) in</span>
<span style="color:green;">    Obj.repr(</span>
<span style="color:green;"># 73 &quot;parser.mly&quot;</span>
<span style="color:green;">                               ( While (_2, _4, location()) )</span>
<span style="color:green;"># 504 &quot;parser.ml&quot;</span>
<span style="color:green;">               : 'expr))</span>
<span style="color:green;">; (fun __caml_parser_env -&gt;</span>
<span style="color:green;">    let _3 = (Parsing.peek_val __caml_parser_env 6 : 'expr) in</span>
<span style="color:green;">    let _5 = (Parsing.peek_val __caml_parser_env 4 : 'expr) in</span>
<span style="color:green;">    let _7 = (Parsing.peek_val __caml_parser_env 2 : 'expr) in</span>
<span style="color:green;">    let _9 = (Parsing.peek_val __caml_parser_env 0 : 'expr) in</span>
<span style="color:green;">    Obj.repr(</span>
<span style="color:green;"># 75 &quot;parser.mly&quot;</span>
<span style="color:green;">                               ( For (_3, _5, _7, _9, location()) )</span>
<span style="color:green;"># 514 &quot;parser.ml&quot;</span>
<span style="color:green;">               : 'expr))</span>
<span style="color:green;">; (fun __caml_parser_env -&gt;</span>
<span style="color:green;">    let _3 = (Parsing.peek_val __caml_parser_env 5 : string) in</span>
<span style="color:green;">    let _5 = (Parsing.peek_val __caml_parser_env 3 : 'tip) in</span>
<span style="color:green;">    let _8 = (Parsing.peek_val __caml_parser_env 0 : 'expr) in</span>
<span style="color:green;">    Obj.repr(</span>
<span style="color:green;"># 77 &quot;parser.mly&quot;</span>
<span style="color:green;">                               ( Fun (_3, _5, _8, location()) )</span>
<span style="color:green;"># 523 &quot;parser.ml&quot;</span>
<span style="color:green;">               : 'expr))</span>
<span style="color:green;">; (fun __caml_parser_env -&gt;</span>
<span style="color:green;">    let _1 = (Parsing.peek_val __caml_parser_env 1 : 'expr) in</span>
<span style="color:green;">    let _2 = (Parsing.peek_val __caml_parser_env 0 : 'funexpr) in</span>
<span style="color:green;">    Obj.repr(</span>
<span style="color:green;"># 78 &quot;parser.mly&quot;</span>
<span style="color:green;">                               ( App (_1, _2, location()) )</span>
<span style="color:green;"># 531 &quot;parser.ml&quot;</span>
<span style="color:green;">               : 'expr))</span>
<span style="color:green;">; (fun __caml_parser_env -&gt;</span>
<span style="color:green;">    let _1 = (Parsing.peek_val __caml_parser_env 0 : 'funexpr) in</span>
<span style="color:green;">    Obj.repr(</span>
<span style="color:green;"># 79 &quot;parser.mly&quot;</span>
<span style="color:green;">                               ( _1 )</span>
<span style="color:green;"># 538 &quot;parser.ml&quot;</span>
<span style="color:green;">               : 'expr))</span>
<span style="color:green;">; (fun __caml_parser_env -&gt;</span>
<span style="color:green;">    Obj.repr(</span>
<span style="color:green;"># 80 &quot;parser.mly&quot;</span>
<span style="color:green;">                               ( parseError (location ()) )</span>
<span style="color:green;"># 544 &quot;parser.ml&quot;</span>
<span style="color:green;">               : 'expr))</span>
<span style="color:green;">; (fun __caml_parser_env -&gt;</span>
<span style="color:green;">    let _1 = (Parsing.peek_val __caml_parser_env 0 : int) in</span>
<span style="color:green;">    Obj.repr(</span>
<span style="color:green;"># 84 &quot;parser.mly&quot;</span>
<span style="color:green;">                               ( Int (_1,location()) )</span>
<span style="color:green;"># 551 &quot;parser.ml&quot;</span>
<span style="color:green;">               : 'funexpr))</span>
<span style="color:green;">; (fun __caml_parser_env -&gt;</span>
<span style="color:green;">    let _1 = (Parsing.peek_val __caml_parser_env 0 : float) in</span>
<span style="color:green;">    Obj.repr(</span>
<span style="color:green;"># 85 &quot;parser.mly&quot;</span>
<span style="color:green;">                               ( Float (_1,location()) )</span>
<span style="color:green;"># 558 &quot;parser.ml&quot;</span>
<span style="color:green;">               : 'funexpr))</span>
<span style="color:green;">; (fun __caml_parser_env -&gt;</span>
<span style="color:green;">    Obj.repr(</span>
<span style="color:green;"># 86 &quot;parser.mly&quot;</span>
<span style="color:green;">                               ( Bool (true, location()) )</span>
<span style="color:green;"># 564 &quot;parser.ml&quot;</span>
<span style="color:green;">               : 'funexpr))</span>
<span style="color:green;">; (fun __caml_parser_env -&gt;</span>
<span style="color:green;">    Obj.repr(</span>
<span style="color:green;"># 87 &quot;parser.mly&quot;</span>
<span style="color:green;">                               ( Bool (false, location()) )</span>
<span style="color:green;"># 570 &quot;parser.ml&quot;</span>
<span style="color:green;">               : 'funexpr))</span>
<span style="color:green;">; (fun __caml_parser_env -&gt;</span>
<span style="color:green;">    Obj.repr(</span>
<span style="color:green;"># 88 &quot;parser.mly&quot;</span>
<span style="color:green;">                               ( Skip (location()) )</span>
<span style="color:green;"># 576 &quot;parser.ml&quot;</span>
<span style="color:green;">               : 'funexpr))</span>
<span style="color:green;">; (fun __caml_parser_env -&gt;</span>
<span style="color:green;">    let _1 = (Parsing.peek_val __caml_parser_env 0 : string) in</span>
<span style="color:green;">    Obj.repr(</span>
<span style="color:green;"># 89 &quot;parser.mly&quot;</span>
<span style="color:green;">                               ( Var (_1,location()) )</span>
<span style="color:green;"># 583 &quot;parser.ml&quot;</span>
<span style="color:green;">               : 'funexpr))</span>
<span style="color:green;">; (fun __caml_parser_env -&gt;</span>
<span style="color:green;">    Obj.repr(</span>
<span style="color:green;"># 90 &quot;parser.mly&quot;</span>
<span style="color:green;">                               ( IntOfFloat (location()) )</span>
<span style="color:green;"># 589 &quot;parser.ml&quot;</span>
<span style="color:green;">               : 'funexpr))</span>
<span style="color:green;">; (fun __caml_parser_env -&gt;</span>
<span style="color:green;">    Obj.repr(</span>
<span style="color:green;"># 91 &quot;parser.mly&quot;</span>
<span style="color:green;">                               ( FloatOfInt (location()) )</span>
<span style="color:green;"># 595 &quot;parser.ml&quot;</span>
<span style="color:green;">               : 'funexpr))</span>
<span style="color:green;">; (fun __caml_parser_env -&gt;</span>
<span style="color:green;">    Obj.repr(</span>
<span style="color:green;"># 92 &quot;parser.mly&quot;</span>
<span style="color:green;">                               ( Z (location()) )</span>
<span style="color:green;"># 601 &quot;parser.ml&quot;</span>
<span style="color:green;">               : 'funexpr))</span>
<span style="color:green;">; (fun __caml_parser_env -&gt;</span>
<span style="color:green;">    let _2 = (Parsing.peek_val __caml_parser_env 1 : 'expr) in</span>
<span style="color:green;">    Obj.repr(</span>
<span style="color:green;"># 93 &quot;parser.mly&quot;</span>
<span style="color:green;">                               ( _2 )</span>
<span style="color:green;"># 608 &quot;parser.ml&quot;</span>
<span style="color:green;">               : 'funexpr))</span>
<span style="color:green;">; (fun __caml_parser_env -&gt;</span>
<span style="color:green;">    let _2 = (Parsing.peek_val __caml_parser_env 0 : string) in</span>
<span style="color:green;">    Obj.repr(</span>
<span style="color:green;"># 94 &quot;parser.mly&quot;</span>
<span style="color:green;">                               ( Loc (_2, location()) )</span>
<span style="color:green;"># 615 &quot;parser.ml&quot;</span>
<span style="color:green;">               : 'funexpr))</span>
<span style="color:green;">(* Entry main *)</span>
<span style="color:green;">; (fun __caml_parser_env -&gt; raise (Parsing.YYexit (Parsing.peek_val __caml_parser_env 0)))</span>
<span style="color:green;">|]</span>
<span style="color:green;">let yytables =</span>
<span style="color:green;">  { Parsing.actions=yyact;</span>
<span style="color:green;">    Parsing.transl_const=yytransl_const;</span>
<span style="color:green;">    Parsing.transl_block=yytransl_block;</span>
<span style="color:green;">    Parsing.lhs=yylhs;</span>
<span style="color:green;">    Parsing.len=yylen;</span>
<span style="color:green;">    Parsing.defred=yydefred;</span>
<span style="color:green;">    Parsing.dgoto=yydgoto;</span>
<span style="color:green;">    Parsing.sindex=yysindex;</span>
<span style="color:green;">    Parsing.rindex=yyrindex;</span>
<span style="color:green;">    Parsing.gindex=yygindex;</span>
<span style="color:green;">    Parsing.tablesize=yytablesize;</span>
<span style="color:green;">    Parsing.table=yytable;</span>
<span style="color:green;">    Parsing.check=yycheck;</span>
<span style="color:green;">    Parsing.error_function=parse_error;</span>
<span style="color:green;">    Parsing.names_const=yynames_const;</span>
<span style="color:green;">    Parsing.names_block=yynames_block }</span>
<span style="color:green;">let main (lexfun : Lexing.lexbuf -&gt; token) (lexbuf : Lexing.lexbuf) =</span>
<span style="color:green;">   (Parsing.yyparse yytables 1 lexfun lexbuf : ImpAST.expr)</span>
<span style="font-weight:bold;">diff --git a/parser.mli b/parser.mli</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..dc1ce7e</span>
<span style="font-weight:bold;">--- /dev/null</span>
<span style="font-weight:bold;">+++ b/parser.mli</span>
<span style="color:teal;">@@ -0,0 +1,42 @@</span>
<span style="color:green;">type token =</span>
<span style="color:green;">  | Z</span>
<span style="color:green;">  | INT_CAST</span>
<span style="color:green;">  | FLOAT_CAST</span>
<span style="color:green;">  | INT of (int)</span>
<span style="color:green;">  | FLOAT of (float)</span>
<span style="color:green;">  | LOC of (string)</span>
<span style="color:green;">  | VAR of (string)</span>
<span style="color:green;">  | TRUE</span>
<span style="color:green;">  | FALSE</span>
<span style="color:green;">  | SEQ</span>
<span style="color:green;">  | SKIP</span>
<span style="color:green;">  | IF</span>
<span style="color:green;">  | THEN</span>
<span style="color:green;">  | ELSE</span>
<span style="color:green;">  | WHILE</span>
<span style="color:green;">  | DO</span>
<span style="color:green;">  | DONE</span>
<span style="color:green;">  | FOR</span>
<span style="color:green;">  | LT</span>
<span style="color:green;">  | LTE</span>
<span style="color:green;">  | EQ</span>
<span style="color:green;">  | ASGNOP</span>
<span style="color:green;">  | DEREF</span>
<span style="color:green;">  | PLUS</span>
<span style="color:green;">  | MINUS</span>
<span style="color:green;">  | MUL</span>
<span style="color:green;">  | DIV</span>
<span style="color:green;">  | LPAREN</span>
<span style="color:green;">  | RPAREN</span>
<span style="color:green;">  | FUN</span>
<span style="color:green;">  | COLON</span>
<span style="color:green;">  | TINT</span>
<span style="color:green;">  | TBOOL</span>
<span style="color:green;">  | TUNIT</span>
<span style="color:green;">  | TFLOAT</span>
<span style="color:green;">  | ARROW</span>
<span style="color:green;">  | FUNX</span>
<span style="color:green;">  | EOF</span>

<span style="color:green;">val main :</span>
<span style="color:green;">  (Lexing.lexbuf  -&gt; token) -&gt; Lexing.lexbuf -&gt; ImpAST.expr</span>
<span style="font-weight:bold;">diff --git a/parser.mly b/parser.mly</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..84fabe2</span>
<span style="font-weight:bold;">--- /dev/null</span>
<span style="font-weight:bold;">+++ b/parser.mly</span>
<span style="color:teal;">@@ -0,0 +1,95 @@</span>
<span style="color:green;">/* File parser.mly */</span>
<span style="color:green;">%{</span>
<span style="color:green;">open ImpAST</span>
<span style="color:green;">open Lexing</span>

<span style="color:green;">let location () =  let start_pos = Parsing.symbol_start_pos () in</span>
<span style="color:green;">    let end_pos = Parsing.symbol_end_pos () in</span>
<span style="color:green;">    Printf.sprintf &quot;%s:%d.%d-%d.%d&quot;</span>
<span style="color:green;">      start_pos.pos_fname</span>
<span style="color:green;">      start_pos.pos_lnum (start_pos.pos_cnum - start_pos.pos_bol)</span>
<span style="color:green;">      end_pos.pos_lnum (end_pos.pos_cnum - end_pos.pos_bol)</span>

<span style="color:green;">let parseError loc = raise (Lexer.ParseError loc)</span>

<span style="color:green;">%}</span>
<span style="color:green;">%token Z</span>
<span style="color:green;">%token INT_CAST FLOAT_CAST</span>
<span style="color:green;">%token &lt;int&gt; INT</span>
<span style="color:green;">%token &lt;float&gt; FLOAT</span>
<span style="color:green;">%token &lt;string&gt; LOC</span>
<span style="color:green;">%token &lt;string&gt; VAR</span>
<span style="color:green;">%token TRUE FALSE</span>
<span style="color:green;">%token SEQ SKIP</span>
<span style="color:green;">%token IF THEN ELSE</span>
<span style="color:green;">%token WHILE DO DONE</span>
<span style="color:green;">%token FOR</span>
<span style="color:green;">%token LT LTE EQ</span>
<span style="color:green;">%token ASGNOP DEREF</span>
<span style="color:green;">%token PLUS MINUS MUL DIV</span>
<span style="color:green;">%token LPAREN RPAREN</span>
<span style="color:green;">%token FUN COLON</span>
<span style="color:green;">%token TINT TBOOL TUNIT TFLOAT</span>
<span style="color:green;">%token ARROW FUNX</span>
<span style="color:green;">%token EOF</span>
<span style="color:green;">%nonassoc FUNX /* lowest precedence */</span>
<span style="color:green;">%right ARROW</span>
<span style="color:green;">%right SEQ</span>
<span style="color:green;">%nonassoc FORX</span>
<span style="color:green;">%nonassoc IFX</span>
<span style="color:green;">%nonassoc LT LTE EQ</span>
<span style="color:green;">%right ASGNOP</span>
<span style="color:green;">%left PLUS MINUS</span>
<span style="color:green;">%left MUL DIV</span>
<span style="color:green;">%nonassoc INT_CAST FLOAT_CAST</span>
<span style="color:green;">%left APPX</span>
<span style="color:green;">%nonassoc DEREF       /* highest precedence */</span>
<span style="color:green;">%start main             /* the entry point */</span>
<span style="color:green;">%type &lt;ImpAST.expr&gt; main</span>
<span style="color:green;">%%</span>
<span style="color:green;">main:</span>
<span style="color:green;">    expr EOF                { $1 }</span>
<span style="color:green;">;</span>

<span style="color:green;">tip:</span>
<span style="color:green;">  | TINT                       {TInt}</span>
<span style="color:green;">  | TBOOL                      {TBool}</span>
<span style="color:green;">  | TUNIT                      {TUnit}</span>
<span style="color:green;">  | TFLOAT                     {TFloat}</span>
<span style="color:green;">  | tip ARROW tip              { TArrow ($1, $3) }</span>
<span style="color:green;">  | LPAREN tip RPAREN          { $2 }</span>

<span style="color:green;">expr:</span>
<span style="color:green;">  | expr PLUS expr             { Op ($1,Plus,$3, location()) }</span>
<span style="color:green;">  | expr MINUS expr             { Op ($1,Minus,$3, location()) }</span>
<span style="color:green;">  | expr MUL expr             { Op ($1,Mul,$3, location()) }</span>
<span style="color:green;">  | expr DIV expr             { Op ($1,Div,$3, location()) }</span>
<span style="color:green;">  | LOC ASGNOP expr            { Atrib ($1,$3, location()) }</span>
<span style="color:green;">  | expr LTE expr              { Op ($1, Mic, $3, location()) }</span>
<span style="color:green;">  | expr LT expr              { Op ($1, MicS, $3, location()) }</span>
<span style="color:green;">  | expr SEQ expr              { Secv ($1,$3, location()) }</span>
<span style="color:green;">  | IF expr THEN expr ELSE expr %prec IFX</span>
<span style="color:green;">                               { If ($2, $4, $6, location()) }</span>
<span style="color:green;">  | WHILE expr DO expr DONE    { While ($2, $4, location()) }</span>
<span style="color:green;">  | FOR LPAREN expr SEQ expr SEQ expr RPAREN expr %prec FORX</span>
<span style="color:green;">                               { For ($3, $5, $7, $9, location()) }</span>
<span style="color:green;">  | FUN LPAREN VAR COLON tip RPAREN ARROW expr %prec FUNX</span>
<span style="color:green;">                               { Fun ($3, $5, $8, location()) }</span>
<span style="color:green;">  | expr funexpr               { App ($1, $2, location()) }</span>
<span style="color:green;">  | funexpr                    { $1 }</span>
<span style="color:green;">  | error                      { parseError (location ()) }</span>
<span style="color:green;">;</span>

<span style="color:green;">funexpr:</span>
<span style="color:green;">  | INT                        { Int ($1,location()) }</span>
<span style="color:green;">  | FLOAT                      { Float ($1,location()) }</span>
<span style="color:green;">  | TRUE                       { Bool (true, location()) }</span>
<span style="color:green;">  | FALSE                      { Bool (false, location()) }</span>
<span style="color:green;">  | SKIP                       { Skip (location()) }</span>
<span style="color:green;">  | VAR                        { Var ($1,location()) }</span>
<span style="color:green;">  | INT_CAST                   { IntOfFloat (location()) }</span>
<span style="color:green;">  | FLOAT_CAST                 { FloatOfInt (location()) }</span>
<span style="color:green;">  | Z                          { Z (location()) }</span>
<span style="color:green;">  | LPAREN expr RPAREN         { $2 }</span>
<span style="color:green;">  | DEREF LOC                  { Loc ($2, location()) }</span>
<span style="color:green;">;</span>
<span style="font-weight:bold;">diff --git a/programs/test1.imp b/programs/test1.imp</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..6c8b0dd</span>
<span style="font-weight:bold;">--- /dev/null</span>
<span style="font-weight:bold;">+++ b/programs/test1.imp</span>
<span style="color:teal;">@@ -0,0 +1 @@</span>
<span style="color:green;">3 + 4</span>
<span style="font-weight:bold;">diff --git a/programs/test2.imp b/programs/test2.imp</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..eb67aef</span>
<span style="font-weight:bold;">--- /dev/null</span>
<span style="font-weight:bold;">+++ b/programs/test2.imp</span>
<span style="color:teal;">@@ -0,0 +1,4 @@</span>
<span style="color:green;">lx := 3;</span>
<span style="color:green;">ly := 7;</span>
<span style="color:green;">lz := (!lx + !ly)</span> 

<span style="font-weight:bold;">diff --git a/programs/test2TODO.imp b/programs/test2TODO.imp</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..92fdda4</span>
<span style="font-weight:bold;">--- /dev/null</span>
<span style="font-weight:bold;">+++ b/programs/test2TODO.imp</span>
<span style="color:teal;">@@ -0,0 +1,4 @@</span>
<span style="color:green;">let x : int = 3 in</span>
<span style="color:green;">let y : int = 7 in</span>
<span style="color:green;">let z : int = (x + y) </span>
<span style="color:green;">in z</span>
<span style="font-weight:bold;">diff --git a/programs/test3.imp b/programs/test3.imp</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..fc4969a</span>
<span style="font-weight:bold;">--- /dev/null</span>
<span style="font-weight:bold;">+++ b/programs/test3.imp</span>
<span style="color:teal;">@@ -0,0 +1 @@</span>
<span style="color:green;">3 + 4 * 5 - 6 / 2 / 4</span>
<span style="font-weight:bold;">diff --git a/programs/test4.imp b/programs/test4.imp</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..541f4bd</span>
<span style="font-weight:bold;">--- /dev/null</span>
<span style="font-weight:bold;">+++ b/programs/test4.imp</span>
<span style="color:teal;">@@ -0,0 +1,7 @@</span>
<span style="color:green;">ln := 10 ;</span>
<span style="color:green;">ls := 0 ;</span>
<span style="color:green;">while 1 &lt;= !ln do</span>
<span style="color:green;">  ls := !ls + !ln ;</span>
<span style="color:green;">  ln := !ln - 1</span>
<span style="color:green;">done</span>

<span style="font-weight:bold;">diff --git a/programs/test4TODO.imp b/programs/test4TODO.imp</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..07ded3c</span>
<span style="font-weight:bold;">--- /dev/null</span>
<span style="font-weight:bold;">+++ b/programs/test4TODO.imp</span>
<span style="color:teal;">@@ -0,0 +1,8 @@</span>
<span style="color:green;">let n : int ref = ref 10 in</span>
<span style="color:green;">let s : int ref = ref 0 in</span>
<span style="color:green;">while 1 &lt;= !n do</span>
<span style="color:green;">  s := !s + !n ;</span>
<span style="color:green;">  n := !n - 1</span>
<span style="color:green;">done ;</span>
<span style="color:green;">! s</span>

<span style="font-weight:bold;">diff --git a/programs/test5.imp b/programs/test5.imp</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..10b51f2</span>
<span style="font-weight:bold;">--- /dev/null</span>
<span style="font-weight:bold;">+++ b/programs/test5.imp</span>
<span style="color:teal;">@@ -0,0 +1,4 @@</span>
<span style="color:green;">ln := 100;</span>
<span style="color:green;">if (!ln &lt;= 100) then skip else</span>
<span style="color:green;">  ly := !ly + !lx ;</span>
<span style="color:green;">ln := !ln + -1</span>
<span style="font-weight:bold;">diff --git a/programs/test5TODO.imp b/programs/test5TODO.imp</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..906489f</span>
<span style="font-weight:bold;">--- /dev/null</span>
<span style="font-weight:bold;">+++ b/programs/test5TODO.imp</span>
<span style="color:teal;">@@ -0,0 +1,7 @@</span>
<span style="color:green;">let x : int = 10 in</span>
<span style="color:green;">let y : int ref = ref 20 in</span>
<span style="color:green;">let n : int ref = ref 100 in</span>
<span style="color:green;">if (!n &lt;= 100) then () else</span>
<span style="color:green;">  y := !y + x ;</span>
<span style="color:green;">n := !n + -1 ;</span>
<span style="color:green;">!n</span>
<span style="font-weight:bold;">diff --git a/programs/test6.imp b/programs/test6.imp</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..54faaa1</span>
<span style="font-weight:bold;">--- /dev/null</span>
<span style="font-weight:bold;">+++ b/programs/test6.imp</span>
<span style="color:teal;">@@ -0,0 +1,5 @@</span>
<span style="color:green;">ln := 1000;</span>
<span style="color:green;">for (lx := 1; !lx &lt;= !ln; lx := !lx + 1)</span>
<span style="color:green;">  ly := !ly + !lx ;</span>
<span style="color:green;">ln := !ln - 1</span>

<span style="font-weight:bold;">diff --git a/programs/test6TODO.imp b/programs/test6TODO.imp</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..976558e</span>
<span style="font-weight:bold;">--- /dev/null</span>
<span style="font-weight:bold;">+++ b/programs/test6TODO.imp</span>
<span style="color:teal;">@@ -0,0 +1,8 @@</span>
<span style="color:green;">let n : int ref = ref 1000 in</span>
<span style="color:green;">let x : int ref = ref 0 in</span>
<span style="color:green;">let y : int ref = ref 0 in</span>
<span style="color:green;">for (x := 1; !x &lt;= !n; x := !x + 1)</span>
<span style="color:green;">  y := !y + !x ;</span>
<span style="color:green;">n := !n - 1 ;</span>
<span style="color:green;">!y</span>

<span style="font-weight:bold;">diff --git a/programs/testApp1.imp b/programs/testApp1.imp</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..cebea20</span>
<span style="font-weight:bold;">--- /dev/null</span>
<span style="font-weight:bold;">+++ b/programs/testApp1.imp</span>
<span style="color:teal;">@@ -0,0 +1 @@</span>
<span style="color:green;">fun (a:int-&gt;int-&gt;(int-&gt;int)-&gt;(int-&gt;int)-&gt;int-&gt;int) -&gt; fun (b:int) -&gt; fun (c:int-&gt;int) -&gt; fun (d:int) -&gt; fun (e:int-&gt;int) -&gt; fun (f:int-&gt;int-&gt;int) -&gt; fun (g:int) -&gt; a b (c d) e (f g)</span>
<span style="font-weight:bold;">diff --git a/programs/testFloat1.imp b/programs/testFloat1.imp</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..04ef08c</span>
<span style="font-weight:bold;">--- /dev/null</span>
<span style="font-weight:bold;">+++ b/programs/testFloat1.imp</span>
<span style="color:teal;">@@ -0,0 +1 @@</span>
<span style="color:green;">3.5 + 6.5</span>
<span style="font-weight:bold;">diff --git a/programs/testFloat2.imp b/programs/testFloat2.imp</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..2acbf2b</span>
<span style="font-weight:bold;">--- /dev/null</span>
<span style="font-weight:bold;">+++ b/programs/testFloat2.imp</span>
<span style="color:teal;">@@ -0,0 +1 @@</span>
<span style="color:green;">if 3.5 &lt;= 1.7 then 4.3 else 2.1</span>
<span style="font-weight:bold;">diff --git a/programs/testFloat3.imp b/programs/testFloat3.imp</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..ed2177b</span>
<span style="font-weight:bold;">--- /dev/null</span>
<span style="font-weight:bold;">+++ b/programs/testFloat3.imp</span>
<span style="color:teal;">@@ -0,0 +1 @@</span>
<span style="color:green;">3 + int_of_float 2.5 &lt;= 7</span>
<span style="font-weight:bold;">diff --git a/programs/testFloat4.imp b/programs/testFloat4.imp</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..02efc40</span>
<span style="font-weight:bold;">--- /dev/null</span>
<span style="font-weight:bold;">+++ b/programs/testFloat4.imp</span>
<span style="color:teal;">@@ -0,0 +1,2 @@</span>
<span style="color:green;">lx := 7;</span>
<span style="color:green;">lfy := 4.5</span>
<span style="font-weight:bold;">diff --git a/programs/testFloat4TODO.imp b/programs/testFloat4TODO.imp</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..e76a96c</span>
<span style="font-weight:bold;">--- /dev/null</span>
<span style="font-weight:bold;">+++ b/programs/testFloat4TODO.imp</span>
<span style="color:teal;">@@ -0,0 +1,3 @@</span>
<span style="color:green;">let x : int ref = ref 7 in</span>
<span style="color:green;">let y : float ref = ref 4.5 in</span>
<span style="color:green;">()</span>
<span style="font-weight:bold;">diff --git a/programs/testFloat5.imp b/programs/testFloat5.imp</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..0ffa0c5</span>
<span style="font-weight:bold;">--- /dev/null</span>
<span style="font-weight:bold;">+++ b/programs/testFloat5.imp</span>
<span style="color:teal;">@@ -0,0 +1,13 @@</span>
<span style="color:green;">lfe := 0.0001;</span>
<span style="color:green;">lfcr := -3./4.;</span>
<span style="color:green;">lfci := !lfe;</span>
<span style="color:green;">lfzr := !lfcr;</span>
<span style="color:green;">lfzi := !lfci;</span>
<span style="color:green;">ln := 0;</span>
<span style="color:green;">while !lfzr*!lfzr - !lfzi*!lfzi &lt; 4. do</span>
<span style="color:green;">  lfzr_old := !lfzr;</span>
<span style="color:green;">  lfzr := !lfzr*!lfzr - !lfzi*!lfzi + !lfcr;</span>
<span style="color:green;">  lfzi := 2.*!lfzr_old*!lfzi + !lfci;</span>
<span style="color:green;">  ln := !ln + 1</span>
<span style="color:green;">done ;</span>
<span style="color:green;">lfp := float_of_int !ln * !lfe</span>
<span style="font-weight:bold;">diff --git a/programs/testFloat5TODO.imp b/programs/testFloat5TODO.imp</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..4c5a74b</span>
<span style="font-weight:bold;">--- /dev/null</span>
<span style="font-weight:bold;">+++ b/programs/testFloat5TODO.imp</span>
<span style="color:teal;">@@ -0,0 +1,13 @@</span>
<span style="color:green;">let e : float = 0.0001 in</span>
<span style="color:green;">let cr : float = -3./4. in</span>
<span style="color:green;">let ci : float = e in</span>
<span style="color:green;">let zr : float ref = ref cr in</span>
<span style="color:green;">let zi : float ref = ref ci in</span>
<span style="color:green;">let n : int ref = ref 0 in</span>
<span style="color:green;">while !zr*!zr - !zi*!zi &lt; 4. do</span>
<span style="color:green;">  let zr_old : float = !zr in</span>
<span style="color:green;">    zr := !zr*!zr - !zi*!zi + cr;</span>
<span style="color:green;">    zi := 2.*zr_old*!zi + ci;</span>
<span style="color:green;">    n := !n + 1</span>
<span style="color:green;">done ;</span>
<span style="color:green;">float_of_int !n * e</span>
<span style="font-weight:bold;">diff --git a/programs/testFun1.imp b/programs/testFun1.imp</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..bb9b570</span>
<span style="font-weight:bold;">--- /dev/null</span>
<span style="font-weight:bold;">+++ b/programs/testFun1.imp</span>
<span style="color:teal;">@@ -0,0 +1 @@</span>
<span style="color:green;">(fun (f : int -&gt; int) -&gt; fun (x : int) -&gt; f x) (fun (x : int) -&gt; x + 1) 3</span>
<span style="font-weight:bold;">diff --git a/programs/testFun2.imp b/programs/testFun2.imp</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..e4e67e6</span>
<span style="font-weight:bold;">--- /dev/null</span>
<span style="font-weight:bold;">+++ b/programs/testFun2.imp</span>
<span style="color:teal;">@@ -0,0 +1,2 @@</span>
<span style="color:green;">(fun (x : unit) -&gt; l1 := 5 ; x ; x) (l1 := !l1 + 1)</span>

<span style="font-weight:bold;">diff --git a/programs/testFun2TODO.imp b/programs/testFun2TODO.imp</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..2e4a969</span>
<span style="font-weight:bold;">--- /dev/null</span>
<span style="font-weight:bold;">+++ b/programs/testFun2TODO.imp</span>
<span style="color:teal;">@@ -0,0 +1,3 @@</span>
<span style="color:green;">let l1 : int ref = ref 0 in</span>
<span style="color:green;">(fun (x : unit) -&gt; l1 := 5 ; x ; x) (l1 := !l1 + 1) ;</span>
<span style="color:green;">!l1</span>
<span style="font-weight:bold;">diff --git a/programs/testFun3.imp b/programs/testFun3.imp</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..9a3ad18</span>
<span style="font-weight:bold;">--- /dev/null</span>
<span style="font-weight:bold;">+++ b/programs/testFun3.imp</span>
<span style="color:teal;">@@ -0,0 +1,5 @@</span>
<span style="color:green;">(fun (m : (int-&gt;int)-&gt;int-&gt;int) -&gt; fun (n:(int-&gt;int)-&gt;int-&gt;int) -&gt; fun (f:int-&gt;int) -&gt; fun (x:int) -&gt; m f (n f x)) //plus</span>
<span style="color:green;">(fun (f:int-&gt;int) -&gt; fun (x:int) -&gt; f ( f ( f (f x)))) //4</span>
<span style="color:green;">(fun (f:int-&gt;int) -&gt; fun (x:int) -&gt; f ( f ( f x))) //3</span>
<span style="color:green;">(fun (x:int) -&gt; x + 1)  </span>
<span style="color:green;"> 0</span>
<span style="font-weight:bold;">diff --git a/programs/testFun4.imp b/programs/testFun4.imp</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..331503a</span>
<span style="font-weight:bold;">--- /dev/null</span>
<span style="font-weight:bold;">+++ b/programs/testFun4.imp</span>
<span style="color:teal;">@@ -0,0 +1 @@</span>
<span style="color:green;">(fun (x : unit -&gt; unit) -&gt; l1 := 5 ; x() ; x()) (fun (x:unit) -&gt; l1 := !l1 + 1)</span>
<span style="font-weight:bold;">diff --git a/programs/testFun4TODO.imp b/programs/testFun4TODO.imp</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..c4480c7</span>
<span style="font-weight:bold;">--- /dev/null</span>
<span style="font-weight:bold;">+++ b/programs/testFun4TODO.imp</span>
<span style="color:teal;">@@ -0,0 +1,3 @@</span>
<span style="color:green;">let l1 : int ref = ref 0 in</span>
<span style="color:green;">(fun (x : unit -&gt; unit) -&gt; l1 := 5 ; x() ; x()) (fun (x:unit) -&gt; l1 := !l1 + 1) ;</span>
<span style="color:green;">!l1</span>
<span style="font-weight:bold;">diff --git a/programs/testZ.imp b/programs/testZ.imp</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..92ff2bc</span>
<span style="font-weight:bold;">--- /dev/null</span>
<span style="font-weight:bold;">+++ b/programs/testZ.imp</span>
<span style="color:teal;">@@ -0,0 +1 @@</span>
<span style="color:green;">Z (fun (g:int-&gt;int) -&gt; fun (x:int) -&gt; if x &lt;= 0 then 1 else x * g (x - 1)) 10</span>
<span style="font-weight:bold;">diff --git a/semantics.cmi b/semantics.cmi</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..5b2a743</span>
Binary files /dev/null and b/semantics.cmi differ
<span style="font-weight:bold;">diff --git a/semantics.cmo b/semantics.cmo</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..561cb84</span>
Binary files /dev/null and b/semantics.cmo differ
<span style="font-weight:bold;">diff --git a/semantics.ml b/semantics.ml</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..4d501bf</span>
<span style="font-weight:bold;">--- /dev/null</span>
<span style="font-weight:bold;">+++ b/semantics.ml</span>
<span style="color:teal;">@@ -0,0 +1,98 @@</span>
<span style="color:green;">open Mem</span>
<span style="color:green;">open ImpAST</span>

<span style="color:green;">let is_fun = function</span>
<span style="color:green;">  | Fun _ | IntOfFloat _ | FloatOfInt _ -&gt; true</span>
<span style="color:green;">  | _ -&gt; false</span>

<span style="color:green;">let is_val = function</span>
<span style="color:green;">  | Bool _ | Int _ | Float _ | Skip _ -&gt; true</span>
<span style="color:green;">  | e -&gt; is_fun e</span>

<span style="color:green;">let rec reduce = function</span>
<span style="color:green;">  | (Op(Int (n1,_),Plus,Int (n2,_),loc),s) -&gt; Some (Int (n1+n2,loc),s)             (*Op+*)</span>
<span style="color:green;">  | (Op(Float (f1,_),Plus,Float (f2,_),loc),s) -&gt; Some (Float (f1+.f2,loc),s)</span>
<span style="color:green;">  | (Op(Int (n1,_),Minus,Int (n2,_),loc),s) -&gt; Some (Int (n1-n2,loc),s)             (*Op+*)</span>
<span style="color:green;">  | (Op(Float (f1,_),Minus,Float (f2,_),loc),s) -&gt; Some (Float (f1-.f2,loc),s)</span>
<span style="color:green;">  | (Op(Int (n1,_),Mul,Int (n2,_),loc),s) -&gt; Some (Int (n1*n2,loc),s)             (*Op+*)</span>
<span style="color:green;">  | (Op(Float (f1,_),Mul,Float (f2,_),loc),s) -&gt; Some (Float (f1*.f2,loc),s)</span>
<span style="color:green;">  | (Op(Int (n1,_),Div,Int (n2,_),loc),s) when n2 &lt;&gt; 0 -&gt; Some (Int (n1/n2,loc),s)             (*Op+*)</span>
<span style="color:green;">  | (Op(Float (f1,_),Div,Float (f2,_),loc),s) -&gt; Some (Float (f1/.f2,loc),s)</span>

<span style="color:green;">  | (Op(Int (n1,_),Mic,Int (n2,_),loc),s) -&gt; Some (Bool (n1&lt;=n2,loc),s)            (*Op&lt;=*)</span>
<span style="color:green;">  | (Op(Float (f1,_),Mic,Float (f2,_),loc),s) -&gt; Some (Bool (f1&lt;=f2,loc),s)            (*Op&lt;=*)</span>
<span style="color:green;">  | (Op(Int (n1,_),MicS,Int (n2,_),loc),s) -&gt; Some (Bool (n1&lt;n2,loc),s)</span>
<span style="color:green;">  | (Op(Float (f1,_),MicS,Float (f2,_),loc),s) -&gt; Some (Bool (f1&lt;f2,loc),s)</span>
<span style="color:green;">  | (Op(Int (n1,loc1),op,e2,loc),s) -&gt;                                        (*OpD*)</span>
<span style="color:green;">    (match reduce (e2,s) with </span>
<span style="color:green;">      | Some (e2',s') -&gt; Some (Op(Int (n1,loc1),op,e2',loc),s')</span>
<span style="color:green;">      | None -&gt; None</span>
<span style="color:green;">    )</span>
<span style="color:green;">  | (Op(Float (f1,loc1),op,e2,loc),s) -&gt;                                        (*OpD*)</span>
<span style="color:green;">    (match reduce (e2,s) with </span>
<span style="color:green;">      | Some (e2',s') -&gt; Some (Op(Float (f1,loc1),op,e2',loc),s')</span>
<span style="color:green;">      | None -&gt; None</span>
<span style="color:green;">    )</span>
<span style="color:green;">  | (Op(e1,op,e2,loc),s) -&gt;                                            (*OpS*)</span>
<span style="color:green;">    (match reduce (e1,s) with Some (e1',s') -&gt; Some (Op(e1',op,e2,loc),s')</span>
<span style="color:green;">      | None -&gt; None)</span>
<span style="color:green;">  | (Loc (l,loc), s) -&gt; Some (lookup l s, s)                    (*Loc*)</span>
<span style="color:green;">  | (Atrib(l, Float (f,loc),loc'),s) -&gt;                                         (*Atrib*)</span>
<span style="color:green;">      Some (Skip loc', update (l, Float (f, loc)) s)</span>
<span style="color:green;">  | (Atrib(l, Int (n,loc),loc'),s) -&gt;                                         (*Atrib*)</span>
<span style="color:green;">      Some (Skip loc', update (l, Int (n, loc)) s)</span>
<span style="color:green;">  | (Atrib(l,e,loc),s) -&gt;                                          (*AtribD*)</span>
<span style="color:green;">    (match reduce (e,s) with Some (e',s') -&gt; Some (Atrib(l,e',loc),s')</span>
<span style="color:green;">      | None -&gt; None)</span>
<span style="color:green;">  | (Secv(Skip _,e,_),s) -&gt; Some (e,s)                                 (*Secv*)</span>
<span style="color:green;">  | (Secv(e1,e2,loc),s) -&gt;                                             (*SecvS*)</span>
<span style="color:green;">    (match reduce (e1,s) with Some (e1',s') -&gt; Some (Secv(e1',e2,loc),s')</span>
<span style="color:green;">      | None -&gt; None)</span>
<span style="color:green;">  | (If(Bool (true,_),e1,e2,_),s) -&gt; Some (e1,s)                         (*IfTrue*)</span>
<span style="color:green;">  | (If(Bool (false,_),e1,e2,_),s) -&gt; Some (e2,s)                        (*IfFalse*)</span>
<span style="color:green;">  | (If(e,e1,e2,loc),s) -&gt;                                             (*IfS*)</span>
<span style="color:green;">    (match reduce (e,s) with Some (e',s') -&gt; Some (If(e',e1,e2,loc),s')</span>
<span style="color:green;">      | None -&gt; None)</span>
<span style="color:green;">  | (While(e1,e2,loc),s) -&gt; Some (If(e1,Secv(e2,While(e1,e2,loc),loc),Skip loc,loc),s) (*While*)</span>
<span style="color:green;">  | (For(init,cond,incr,body,l), s) </span>
<span style="color:green;">    -&gt; Some (Secv(init,While(cond,Secv(body,incr,l),l),l), s)    (*For*)</span>
<span style="color:green;">  | (App (IntOfFloat _, Float (f,_), loc), s)</span>
<span style="color:green;">    -&gt; Some (Int (int_of_float f, loc), s)</span>
<span style="color:green;">  | (App (FloatOfInt _, Int (n,_), loc), s)</span>
<span style="color:green;">    -&gt; Some (Float (float_of_int n, loc), s)</span>
<span style="color:green;">  | (App (App(Z loc, g, loc1), v, loc2), s)</span>
<span style="color:green;">    -&gt; Some (App (App (g, App(Z loc, g, loc),loc1), v, loc2), s)</span>
<span style="color:green;">  | (App (Fun(x,_,e1,_),e2,_),s) when is_val e2 -&gt; Some (subst x e2 e1, s)</span>
<span style="color:green;">  | (App (e1, e2, loc), s) when is_fun e1</span>
<span style="color:green;">     -&gt; (match reduce (e2,s) with Some (e2',s') -&gt; Some (App(e1,e2',loc),s')</span>
<span style="color:green;">      | None -&gt; None)</span>
<span style="color:green;">  | (App (e1, e2, loc), s) </span>
<span style="color:green;">     -&gt; (match reduce (e1,s) with Some (e1',s') -&gt; Some (App(e1',e2,loc),s')</span>
<span style="color:green;">      | None -&gt; None)</span>

<span style="color:green;">(*  Normal Order</span>
<span style="color:green;">  | (App (Fun(x,_,e1,_),e2,_),s) -&gt; Some (subst x e2 e1, s)</span>
<span style="color:green;">  | (App (App(Z loc, g, loc1), v, loc2), s)</span>
<span style="color:green;">    -&gt; Some (App (App (g, App(Z loc, g, loc),loc1), v, loc2), s)</span>
<span style="color:green;">  | (App (e1, e2, loc), s) -&gt;</span>
<span style="color:green;">    (match reduce (e1,s) with Some (e1',s') -&gt; Some (App(e1',e2,loc),s')</span>
<span style="color:green;">      | None -&gt; (match reduce (e2,s) with Some (e2',s') -&gt; Some (App(e1,e2',loc),s')</span>
<span style="color:green;">      | None -&gt; None))</span>
<span style="color:green;">   | (Fun (x,t,e,loc),s) -&gt;</span>
<span style="color:green;">    (match reduce (e,s) with Some (e',s') -&gt; Some (Fun (x,t,e',loc),s') </span>
<span style="color:green;">      | None -&gt; None)</span>
<span style="color:green;">*)</span>
<span style="color:green;">  | _ -&gt; None                                                    (*default*)</span>


<span style="color:green;">let string_of_config (p,m) = &quot;&lt;&quot; ^ string_of_expr p ^ &quot;, {&quot; ^ string_of_mem m ^ &quot;} &gt;&quot;</span>

<span style="color:green;">(* evaluate basically computes the transitive closure -&gt;* of the</span>
<span style="color:green;">   one step reduction relation. *)</span>
<span style="color:green;">let rec evaluate debug c = match (reduce c) with</span>
<span style="color:green;">  | Some c' -&gt; if debug </span>
<span style="color:green;">               then Printf.printf &quot;%s\n&quot; (string_of_config c) </span>
<span style="color:green;">               else () ; </span>
<span style="color:green;">               evaluate debug c'</span>
<span style="color:green;">  | None -&gt; c</span>

<span style="font-weight:bold;">diff --git a/types.cmi b/types.cmi</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..5315ac4</span>
Binary files /dev/null and b/types.cmi differ
<span style="font-weight:bold;">diff --git a/types.cmo b/types.cmo</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..bae5118</span>
Binary files /dev/null and b/types.cmo differ
<span style="font-weight:bold;">diff --git a/types.ml b/types.ml</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..e4a72c0</span>
<span style="font-weight:bold;">--- /dev/null</span>
<span style="font-weight:bold;">+++ b/types.ml</span>
<span style="color:teal;">@@ -0,0 +1,83 @@</span>
<span style="color:green;">open Mem</span>
<span style="color:green;">open ImpAST</span>

<span style="color:green;">(* types of locations *)</span>
<span style="color:green;">type tipL = TIntRef | TFloatRef | Type of tip</span>

<span style="color:green;">exception TypeError of expr*tip*tip</span>
<span style="color:green;">exception LocError of string*locatie</span>

<span style="color:green;">(* Type inference function *)</span>
<span style="color:green;">let rec infertype m = function</span>
<span style="color:green;">  | Int (n,_) -&gt; TInt</span>
<span style="color:green;">  | Bool (b,_) -&gt; TBool</span>
<span style="color:green;">  | Float (f,_) -&gt; TFloat</span>
<span style="color:green;">  | Op(e1,Plus,e2,_) </span>
<span style="color:green;">  | Op(e1,Minus,e2,_) </span>
<span style="color:green;">  | Op(e1,Mul,e2,_) </span>
<span style="color:green;">  | Op(e1,Div,e2,_) </span>
<span style="color:green;">    -&gt; (match (infertype m e1, infertype m e2) with</span>
<span style="color:green;">     | (TInt, TInt) -&gt; TInt</span>
<span style="color:green;">     | (TFloat, TFloat) -&gt; TFloat</span>
<span style="color:green;">     | (TInt, t) -&gt; raise (TypeError (e2, TInt, t))</span>
<span style="color:green;">     | (TFloat, t) -&gt; raise (TypeError (e2, TFloat, t))</span>
<span style="color:green;">     | (t,_) -&gt; raise (TypeError (e1, TInt, t)))</span>
<span style="color:green;">  | Op(e1,Mic,e2,_) </span>
<span style="color:green;">  | Op(e1,MicS,e2,_) </span>
<span style="color:green;">    -&gt; (match (infertype m e1, infertype m e2) with</span>
<span style="color:green;">     | (TInt, TInt) | (TFloat, TFloat)  -&gt; TBool</span>
<span style="color:green;">     | (TInt, t)  -&gt; raise (TypeError (e2, TInt, t))</span>
<span style="color:green;">     | (TFloat, t) -&gt; raise (TypeError (e2, TFloat, t))</span>
<span style="color:green;">     | (t,_) -&gt; raise (TypeError (e1, TInt, t)))</span>
<span style="color:green;">  | If(e1,e2,e3,_) -&gt; (match (infertype m e1, infertype m e2, infertype m e3) with</span>
<span style="color:green;">     | (TBool, t, t') when t=t' -&gt; t</span>
<span style="color:green;">     | (TBool, t, t') -&gt; raise (TypeError (e3, t, t'))</span>
<span style="color:green;">     | (t,_,_) -&gt; raise (TypeError (e1, TBool, t)))</span>
<span style="color:green;">  | Loc (l,loc) -&gt; (try </span>
<span style="color:green;">           (match lookup l m with </span>
<span style="color:green;">              | TIntRef -&gt; TInt</span>
<span style="color:green;">              | TFloatRef -&gt; TFloat</span>
<span style="color:green;">           ) </span>
<span style="color:green;">     with Not_found -&gt; raise (LocError (l, loc)))</span>
<span style="color:green;">   | Var (v,loc) -&gt; (try </span>
<span style="color:green;">           (match lookup v m with </span>
<span style="color:green;">              | Type t -&gt; t</span>
<span style="color:green;">           ) </span>
<span style="color:green;">     with Not_found -&gt; raise (LocError (v, loc)))</span>
<span style="color:green;">  | Atrib(l,e,loc) -&gt; (try (match (lookup l m, infertype m e) with</span>
<span style="color:green;">       | (TIntRef, TInt) | (TFloatRef, TFloat) -&gt; TUnit</span>
<span style="color:green;">       | (TIntRef, t) -&gt; raise (TypeError (e, TInt, t))</span>
<span style="color:green;">       | (TFloatRef, t) -&gt; raise (TypeError (e, TFloat, t))</span>
<span style="color:green;">     ) with Not_found -&gt; raise (LocError (l, loc)))</span>
<span style="color:green;">  | Skip _ -&gt; TUnit</span>
<span style="color:green;">  | Secv (e1,e2,_) -&gt; (match (infertype m e1, infertype m e2) with</span>
<span style="color:green;">     | (TUnit,t) -&gt; t</span>
<span style="color:green;">     | (t1,_) -&gt; raise (TypeError (e1, TUnit, t1)))</span>
<span style="color:green;">  | While (cond,body,_) -&gt; (match (infertype m cond, infertype m body) with</span>
<span style="color:green;">     | (TBool, TUnit) -&gt; TUnit</span>
<span style="color:green;">     | (TBool, t) -&gt; raise (TypeError (body, TUnit, t))</span>
<span style="color:green;">     | (t,_) -&gt; raise (TypeError (cond, TBool, t)))</span>
<span style="color:green;">  | For (init,cond,incr,body,_) </span>
<span style="color:green;">    -&gt; (match (infertype m init, infertype m cond, infertype m incr, infertype m body) with</span>
<span style="color:green;">     | (TUnit, TBool, TUnit, TUnit) -&gt; TUnit</span>
<span style="color:green;">     | (TUnit, TBool, TUnit, t) -&gt; raise (TypeError (body, TUnit, t))</span>
<span style="color:green;">     | (TUnit, TBool, t, _) -&gt; raise (TypeError (incr, TUnit, t))</span>
<span style="color:green;">     | (TUnit, t, _, _) -&gt; raise (TypeError (cond, TBool, t))</span>
<span style="color:green;">     | (t, _, _, _) -&gt; raise (TypeError (init, TUnit, t)))</span>
<span style="color:green;">  | App (e1, e2, _) -&gt; (match (infertype m e1, infertype m e2) with</span>
<span style="color:green;">     | (TArrow(t1, t1'), t2) when t1 = t2 -&gt; t1'</span>
<span style="color:green;">     | (TArrow(t1, t1'), t2) -&gt; raise (TypeError (e2,t1,t2))</span>
<span style="color:green;">     | (t1,t2) -&gt; raise (TypeError (e1,TArrow(t2,t2),t1)))</span>
<span style="color:green;">  | IntOfFloat _ -&gt; TArrow(TFloat, TInt)</span>
<span style="color:green;">  | FloatOfInt _ -&gt; TArrow(TInt, TFloat)</span>
<span style="color:green;">  | Z _ -&gt; TArrow(TArrow(TArrow(TInt,TInt),TArrow(TInt,TInt)),TArrow(TInt,TInt))</span>
<span style="color:green;">  | Fun (x,t,e,_) -&gt; TArrow(t, infertype (update_or_add (x,Type t) m) e)</span>


<span style="color:green;">let type_check m e = try</span>
<span style="color:green;">     let _ = infertype m e in true</span>
<span style="color:green;">  with </span>
<span style="color:green;">    | TypeError (e,t1,t2) -&gt; Printf.eprintf &quot;%s\nError: Error: This expression has type %s but an expression was expected of type %s\n&quot;  (location e) (string_of_tip t2) (string_of_tip t1) ; false</span>
<span style="color:green;">    | LocError (l,loc) -&gt; Printf.eprintf &quot;Error: Location %s undefined at %s.\n&quot; l loc ; false</span>


</pre>
</body>
</html>
